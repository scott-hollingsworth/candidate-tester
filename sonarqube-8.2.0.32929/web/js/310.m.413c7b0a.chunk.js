(window.webpackJsonp=window.webpackJsonp||[]).push([[310],{1372:function(e,t,n){var a=n(1373);"string"==typeof a&&(a=[[e.i,a,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};n(312)(a,s);a.locals&&(e.exports=a.locals)},1373:function(e,t,n){(e.exports=n(311)(!1)).push([e.i,".bt-search-form{display:flex;align-items:flex-end}.bt-search-form>li+li{margin-left:16px}.bt-search-form-label{margin-bottom:4px}.bt-search-form-field{padding:4px 0}.bt-search-form-large{flex:1}.bt-workers-warning-icon{margin-top:5px}.emphasised-measure{font-size:24px;font-weight:300}",""])},1757:function(e,t,n){"use strict";n.r(t);var a=n(425),s=n.n(a),r=n(361),o=n.n(r),l=n(2),c=n(327),i=n(316),u=n(29),d=n(5),m=n(431),p=n(547),h=n(330),g=n(423),b=(n(1372),n(501));function k(e,t){return e.map(e=>e.id===t.id?t:e)}const E=1e3,f=60*E,C=60*f;function y(e,t){return"".concat(e).concat(t)}const O=1e3;function N(e){return e.tasks.length<O?null:l.createElement("footer",{className:"spacer-top note text-center"},Object(d.translateWithParameters)("max_results_reached",O))}var S=n(28),v=n(310),_=n(321),j=n.n(_),x=n(314),D=n.n(x),w=n(686),P=n.n(w);function A(){return l.createElement(l.Fragment,null,l.createElement("p",{className:"spacer-bottom"},l.createElement("strong",null,Object(d.translate)("background_tasks.add_more_workers"))),l.createElement("p",{className:"big-spacer-bottom markdown"},Object(d.translate)("background_tasks.add_more_workers.text")),l.createElement("p",null,l.createElement("a",{href:"https://redirect.sonarsource.com/editions/enterprise.html",rel:"noopener noreferrer",target:"_blank"},Object(d.translate)("learn_more"))))}var T=n(326),L=n.n(T),I=n(338),F=n.n(I),R=n(323);const M=10;class q extends l.PureComponent{constructor(e){super(e),this.mounted=!1,this.handleClose=()=>{this.props.onClose()},this.handleWorkerCountChange=e=>this.setState({newWorkerCount:e.value}),this.handleSubmit=e=>{e.preventDefault(),this.setState({submitting:!0});const t=this.state.newWorkerCount;Object(p.j)(t).then(()=>{this.mounted&&this.props.onClose(t)},()=>{this.mounted&&this.setState({submitting:!1})})},this.state={newWorkerCount:e.workerCount,submitting:!1}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const e=[];for(let t=1;t<=M;t++)e.push({label:String(t),value:t});return l.createElement(L.a,{contentLabel:Object(d.translate)("background_tasks.change_number_of_workers"),onRequestClose:this.handleClose},l.createElement("header",{className:"modal-head"},l.createElement("h2",null,Object(d.translate)("background_tasks.change_number_of_workers"))),l.createElement("form",{onSubmit:this.handleSubmit},l.createElement("div",{className:"modal-body"},l.createElement(F.a,{className:"input-tiny spacer-top",clearable:!1,onChange:this.handleWorkerCountChange,options:e,searchable:!1,value:this.state.newWorkerCount}),l.createElement(R.Alert,{className:"big-spacer-top",variant:"info"},Object(d.translate)("background_tasks.change_number_of_workers.hint"))),l.createElement("footer",{className:"modal-foot"},l.createElement("div",null,this.state.submitting&&l.createElement("i",{className:"spinner spacer-right"}),l.createElement(v.SubmitButton,{disabled:this.state.submitting},Object(d.translate)("save")),l.createElement(v.ResetButtonLink,{onClick:this.handleClose},Object(d.translate)("cancel"))))))}}class U extends l.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={canSetWorkerCount:!1,formOpen:!1,loading:!0,noSupportPopup:!1,workerCount:1},this.loadWorkers=()=>{this.setState({loading:!0}),Object(p.i)().then(e=>{let t=e.canSetWorkerCount,n=e.value;this.mounted&&this.setState({canSetWorkerCount:t,loading:!1,workerCount:n})},()=>{this.mounted&&this.setState({loading:!1})})},this.closeForm=e=>e?this.setState({formOpen:!1,workerCount:e}):this.setState({formOpen:!1}),this.handleChangeClick=()=>{this.setState({formOpen:!0})},this.handleHelpClick=e=>{e.preventDefault(),e.stopPropagation(),this.toggleNoSupportPopup()},this.toggleNoSupportPopup=e=>{void 0!==e?this.setState({noSupportPopup:e}):this.setState(e=>({noSupportPopup:!e.noSupportPopup}))}}componentDidMount(){this.mounted=!0,this.loadWorkers()}componentWillUnmount(){this.mounted=!1}render(){const e=this.state,t=e.canSetWorkerCount,n=e.formOpen,a=e.loading,s=e.workerCount;return l.createElement("div",{className:"display-flex-center"},!a&&s>1&&l.createElement(D.a,{overlay:Object(d.translate)("background_tasks.number_of_workers.warning")},l.createElement("span",{className:"display-inline-flex-center little-spacer-right"},l.createElement(P.a,{fill:"#d3d3d3"}))),l.createElement("span",{className:"text-middle"},Object(d.translate)("background_tasks.number_of_workers"),a?l.createElement("i",{className:"spinner little-spacer-left"}):l.createElement("strong",{className:"little-spacer-left"},s)),!a&&t&&l.createElement(D.a,{overlay:Object(d.translate)("background_tasks.change_number_of_workers")},l.createElement(v.EditButton,{className:"js-edit button-small spacer-left",onClick:this.handleChangeClick})),!a&&!t&&l.createElement(j.a,{className:"spacer-left",overlay:l.createElement(A,null)}),n&&l.createElement(q,{onClose:this.closeForm,workerCount:this.state.workerCount}))}}function W(e){return l.createElement("header",{className:"page-header"},l.createElement("h1",{className:"page-title"},Object(d.translate)("background_tasks.page")),!e.component&&l.createElement("div",{className:"page-actions"},l.createElement(U,null)),l.createElement("p",{className:"page-description"},Object(d.translate)("background_tasks.page.description"),l.createElement(S.Link,{className:"spacer-left",target:"_blank",to:{pathname:"/documentation/analysis/background-tasks/"}},Object(d.translate)("learn_more"))))}var z=n(350),B=n.n(z),G=n(340),Y=n.n(G);class J extends l.PureComponent{constructor(){super(...arguments),this.handleChange=e=>{const t=e?b.b.ONLY_CURRENTS:b.b.ALL;this.props.onChange(t)}}render(){const e=this.props.value===b.b.ONLY_CURRENTS;return l.createElement("div",{className:"bt-search-form-field"},l.createElement(Y.a,{checked:e,onCheck:this.handleChange},l.createElement("span",{className:"little-spacer-left"},Object(d.translate)("yes"))))}}var K=n(614);class X extends l.PureComponent{constructor(){super(...arguments),this.handleDateRangeChange=e=>{let t=e.from,n=e.to;this.props.onChange({minSubmittedAt:t,maxExecutedAt:n})}}render(){const e={from:this.props.minSubmittedAt,to:this.props.maxExecutedAt};return l.createElement("div",{className:"nowrap"},l.createElement(K.a,{onChange:this.handleDateRangeChange,value:e}))}}class H extends l.PureComponent{constructor(){super(...arguments),this.handleChange=e=>{let t=e.value;this.props.onChange(t)}}render(){const e=[{value:b.e.ALL,label:Object(d.translate)("background_task.status.ALL")},{value:b.e.ALL_EXCEPT_PENDING,label:Object(d.translate)("background_task.status.ALL_EXCEPT_PENDING")},{value:b.e.PENDING,label:Object(d.translate)("background_task.status.PENDING")},{value:b.e.IN_PROGRESS,label:Object(d.translate)("background_task.status.IN_PROGRESS")},{value:b.e.SUCCESS,label:Object(d.translate)("background_task.status.SUCCESS")},{value:b.e.FAILED,label:Object(d.translate)("background_task.status.FAILED")},{value:b.e.CANCELED,label:Object(d.translate)("background_task.status.CANCELED")}];return l.createElement(F.a,{className:"input-medium",clearable:!1,onChange:this.handleChange,options:e,searchable:!1,value:this.props.value})}}class Q extends l.PureComponent{constructor(){super(...arguments),this.handleChange=e=>{let t=e.value;this.props.onChange(t)}}render(){const e=this.props,t=e.value,n=e.types.map(e=>({value:e,label:Object(d.translate)("background_task.type",e)})),a=[{value:b.a,label:Object(d.translate)("background_task.type.ALL")},...n];return l.createElement(F.a,{className:"input-medium",clearable:!1,onChange:this.handleChange,options:a,searchable:!1,value:t})}}class V extends l.PureComponent{constructor(){super(...arguments),this.handleStatusChange=e=>{this.props.onFilterUpdate({status:e})},this.handleTypeChange=e=>{this.props.onFilterUpdate({taskType:e})},this.handleCurrentsChange=e=>{this.props.onFilterUpdate({currents:e})},this.handleDateChange=e=>{this.props.onFilterUpdate(e)},this.handleQueryChange=e=>{this.props.onFilterUpdate({query:e})},this.handleReset=()=>{this.props.onFilterUpdate(b.d)}}renderSearchBox(){const e=this.props,t=e.component,n=e.query;return t?null:l.createElement("li",{className:"bt-search-form-large"},l.createElement(B.a,{onChange:this.handleQueryChange,placeholder:Object(d.translate)("background_tasks.search_by_task_or_component"),value:n}))}render(){const e=this.props,t=e.loading,n=e.component,a=e.types,s=e.status,r=e.taskType,o=e.currents,c=e.minSubmittedAt,i=e.maxExecutedAt;return l.createElement("section",{className:"big-spacer-top big-spacer-bottom"},l.createElement("ul",{className:"bt-search-form"},l.createElement("li",null,l.createElement("h6",{className:"bt-search-form-label"},Object(d.translate)("status")),l.createElement(H,{onChange:this.handleStatusChange,value:s})),a.length>1&&l.createElement("li",null,l.createElement("h6",{className:"bt-search-form-label"},Object(d.translate)("type")),l.createElement(Q,{onChange:this.handleTypeChange,types:a,value:r})),!n&&l.createElement("li",null,l.createElement("h6",{className:"bt-search-form-label"},Object(d.translate)("background_tasks.currents_filter.ONLY_CURRENTS")),l.createElement(J,{onChange:this.handleCurrentsChange,value:o})),l.createElement("li",null,l.createElement("h6",{className:"bt-search-form-label"},Object(d.translate)("date")),l.createElement(X,{maxExecutedAt:i,minSubmittedAt:c,onChange:this.handleDateChange})),this.renderSearchBox(),l.createElement("li",{className:"nowrap"},l.createElement(v.Button,{className:"js-reload",disabled:t,onClick:this.props.onReload},Object(d.translate)("reload"))," ",l.createElement(v.Button,{disabled:t,onClick:this.handleReset},Object(d.translate)("reset_verb")))))}}var Z=n(371),$=n.n(Z),ee=n(331),te=n(318);var ne=Object(i.connect)(e=>({isSystemAdmin:Object(te.getAppState)(e).canAdmin}))(function(e){let t=e.isSystemAdmin,n=e.onCancelAllPending,a=e.pendingCount;return void 0===a?null:l.createElement("span",null,l.createElement("span",{className:"emphasised-measure"},a),l.createElement("span",{className:"little-spacer-left display-inline-flex-center"},Object(d.translate)("background_tasks.pending"),t&&a>0&&l.createElement($.a,{cancelButtonText:Object(d.translate)("close"),confirmButtonText:Object(d.translate)("background_tasks.cancel_all_tasks.submit"),isDestructive:!0,modalBody:Object(d.translate)("background_tasks.cancel_all_tasks.text"),modalHeader:Object(d.translate)("background_tasks.cancel_all_tasks"),onConfirm:n},e=>{let t=e.onClick;return l.createElement(D.a,{overlay:Object(d.translate)("background_tasks.cancel_all_tasks")},l.createElement(v.ClearButton,{className:"little-spacer-left",color:ee.colors.red,onClick:t}))})))}),ae=n(317);const se=1e3;function re(e){let t=e.className,n=e.pendingCount,a=e.pendingTime;return!a||!n||a<se?null:l.createElement("span",{className:t},l.createElement("span",{className:"emphasised-measure"},Object(ae.formatMeasure)(a,"MILLISEC")),l.createElement("span",{className:"little-spacer-left"},Object(d.translate)("background_tasks.pending_time")),l.createElement(j.a,{className:"little-spacer-left",overlay:Object(d.translate)("background_tasks.pending_time.description")}))}function oe(e){let t=e.className,n=e.failingCount,a=e.onShowFailing;return void 0===n?null:l.createElement("span",{className:t},n>0?l.createElement(v.ButtonLink,{className:"emphasised-measure text-baseline",onClick:a},n):l.createElement("span",{className:"emphasised-measure"},n),l.createElement("span",{className:"little-spacer-left"},Object(d.translate)("background_tasks.failures")),l.createElement(j.a,{className:"little-spacer-left",overlay:Object(d.translate)("background_tasks.failing_count")}))}function le(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n,a,s={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}function ce(e){let t=e.component,n=e.pendingCount,a=e.pendingTime,s=le(e,["component","pendingCount","pendingTime"]);return l.createElement("section",{className:"big-spacer-top big-spacer-bottom"},l.createElement(ne,{onCancelAllPending:s.onCancelAllPending,pendingCount:n}),!t&&l.createElement(re,{className:"huge-spacer-left",pendingCount:n,pendingTime:a}),!t&&l.createElement(oe,{className:"huge-spacer-left",failingCount:s.failingCount,onShowFailing:s.onShowFailing}))}var ie=n(309),ue=n(377),de=n.n(ue),me=n(341),pe=n.n(me),he=n(325);class ge extends l.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={},this.handleCloseClick=e=>{e.preventDefault(),this.props.onClose()}}componentDidMount(){this.mounted=!0,this.loadScannerContext()}componentWillUnmount(){this.mounted=!1}loadScannerContext(){Object(p.f)(this.props.task.id,["scannerContext"]).then(e=>{this.mounted&&this.setState({scannerContext:e.scannerContext})})}render(){const e=this.props.task,t=this.state.scannerContext;return l.createElement(L.a,{contentLabel:"scanner context",onRequestClose:this.props.onClose,size:"large"},l.createElement("div",{className:"modal-head"},l.createElement("h2",null,Object(d.translate)("background_tasks.scanner_context"),": ",e.componentName," [",Object(d.translate)("background_task.type",e.type),"]")),l.createElement("div",{className:"modal-body modal-container"},null!=t?l.createElement("pre",{className:"js-task-scanner-context"},t):l.createElement("i",{className:"spinner"})),l.createElement("div",{className:"modal-foot"},l.createElement("a",{className:"js-modal-close",href:"#",onClick:this.handleCloseClick},Object(d.translate)("close"))))}}class be extends l.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={loading:!0},this.handleCloseClick=e=>{e.preventDefault(),this.props.onClose()}}componentDidMount(){this.mounted=!0,this.loadStacktrace()}componentWillUnmount(){this.mounted=!1}loadStacktrace(){Object(p.f)(this.props.task.id,["stacktrace"]).then(e=>{this.mounted&&this.setState({loading:!1,stacktrace:e.errorStacktrace})},()=>{this.mounted&&this.setState({loading:!1})})}render(){const e=this.props.task,t=this.state,n=t.loading,a=t.stacktrace;return l.createElement(L.a,{contentLabel:"stacktrace",onRequestClose:this.props.onClose,size:"large"},l.createElement("div",{className:"modal-head"},l.createElement("h2",null,Object(d.translate)("background_tasks.error_stacktrace"),": ",e.componentName," [",Object(d.translate)("background_task.type",e.type),"]")),l.createElement("div",{className:"modal-body modal-container"},n?l.createElement("i",{className:"spinner"}):a?l.createElement("div",null,l.createElement("h4",{className:"spacer-bottom"},Object(d.translate)("background_tasks.error_stacktrace")),l.createElement("pre",{className:"js-task-stacktrace"},a)):l.createElement("div",null,l.createElement("h4",{className:"spacer-bottom"},Object(d.translate)("background_tasks.error_message")),l.createElement("pre",{className:"js-task-error-message"},e.errorMessage))),l.createElement("div",{className:"modal-foot"},l.createElement("a",{className:"js-modal-close",href:"#",onClick:this.handleCloseClick},Object(d.translate)("close"))))}}const ke=Object(he.lazyLoad)(()=>n.e(359).then(n.bind(null,1714)),"AnalysisWarningsModal");class Ee extends l.PureComponent{constructor(){super(...arguments),this.state={cancelTaskOpen:!1,scannerContextOpen:!1,stacktraceOpen:!1,warningsOpen:!1},this.handleFilterClick=()=>{this.props.onFilterTask(this.props.task)},this.handleCancelTask=()=>this.props.onCancelTask(this.props.task),this.handleCancelClick=()=>{this.setState({cancelTaskOpen:!0})},this.handleShowScannerContextClick=()=>{this.setState({scannerContextOpen:!0})},this.closeCancelTask=()=>{this.setState({cancelTaskOpen:!1})},this.closeScannerContext=()=>{this.setState({scannerContextOpen:!1})},this.handleShowStacktraceClick=()=>{this.setState({stacktraceOpen:!0})},this.closeStacktrace=()=>{this.setState({stacktraceOpen:!1})},this.handleShowWarningsClick=()=>{this.setState({warningsOpen:!0})},this.closeWarnings=()=>{this.setState({warningsOpen:!1})}}render(){const e=this.props,t=e.component,n=e.task,a=void 0===t,s=n.status===b.e.PENDING,r=void 0!==n.errorMessage,o=void 0!==n.warningCount&&n.warningCount>0;return a||s||n.hasScannerContext||r||o?l.createElement("td",{className:"thin nowrap"},l.createElement(de.a,{className:"js-task-action"},a&&n.componentName&&l.createElement(ue.ActionsDropdownItem,{className:"js-task-filter",onClick:this.handleFilterClick},Object(d.translateWithParameters)("background_tasks.filter_by_component_x",n.componentName)),s&&l.createElement(ue.ActionsDropdownItem,{className:"js-task-cancel",destructive:!0,onClick:this.handleCancelClick},Object(d.translate)("background_tasks.cancel_task")),n.hasScannerContext&&l.createElement(ue.ActionsDropdownItem,{className:"js-task-show-scanner-context",onClick:this.handleShowScannerContextClick},Object(d.translate)("background_tasks.show_scanner_context")),r&&l.createElement(ue.ActionsDropdownItem,{className:"js-task-show-stacktrace",onClick:this.handleShowStacktraceClick},Object(d.translate)("background_tasks.show_stacktrace")),o&&l.createElement(ue.ActionsDropdownItem,{className:"js-task-show-warnings",onClick:this.handleShowWarningsClick},Object(d.translate)("background_tasks.show_warnings"))),this.state.cancelTaskOpen&&l.createElement(pe.a,{cancelButtonText:Object(d.translate)("close"),confirmButtonText:Object(d.translate)("background_tasks.cancel_task"),header:Object(d.translate)("background_tasks.cancel_task"),isDestructive:!0,onClose:this.closeCancelTask,onConfirm:this.handleCancelTask},Object(d.translate)("background_tasks.cancel_task.text")),this.state.scannerContextOpen&&l.createElement(ge,{onClose:this.closeScannerContext,task:n}),this.state.stacktraceOpen&&l.createElement(be,{onClose:this.closeStacktrace,task:n}),this.state.warningsOpen&&l.createElement(ke,{onClose:this.closeWarnings,taskId:n.id})):l.createElement("td",null," ")}}var fe=n(399),Ce=n.n(fe),ye=n(512),Oe=n.n(ye),Ne=n(347),Se=n.n(Ne),ve=n(808),_e=n(319);function je(e){let t=e.type;return l.createElement("span",{className:"display-inline-block note"},"[",Object(d.translate)("background_task.type",t),"]")}function xe(e){let t=e.task;return t.componentKey?l.createElement("td",null,void 0!==t.branch&&l.createElement(Ce.a,{className:"little-spacer-right"}),void 0!==t.pullRequest&&l.createElement(Oe.a,{className:"little-spacer-right"}),!t.branch&&!t.pullRequest&&t.componentQualifier&&l.createElement("span",{className:"little-spacer-right"},l.createElement(Se.a,{qualifier:t.componentQualifier})),t.organization&&l.createElement(ve.a,{organizationKey:t.organization}),t.componentName&&l.createElement(S.Link,{className:"spacer-right",to:De(t.componentKey,t)},t.componentName,t.branch&&l.createElement("span",{className:"text-limited text-text-top",title:t.branch},l.createElement("span",{style:{marginLeft:5,marginRight:5}},"/"),t.branch),t.pullRequest&&l.createElement("span",{className:"text-limited text-text-top",title:t.pullRequestTitle},l.createElement("span",{style:{marginLeft:5,marginRight:5}},"/"),t.pullRequest)),l.createElement(je,{type:t.type})):l.createElement("td",null,l.createElement("span",{className:"note"},t.id),l.createElement(je,{type:t.type}))}function De(e,t){return t.branch?Object(_e.c)(e,t.branch):t.pullRequest?Object(_e.u)(e,t.pullRequest):Object(_e.t)(e)}var we=n(602),Pe=n(558);function Ae(e){let t=e.date,n=e.baseDate;const a=t&&Object(u.parseDate)(t),s=n&&Object(u.parseDate)(n),r=a&&s&&Object(u.isValidDate)(a)&&Object(u.isValidDate)(s)?we(a,s):0;return l.createElement("td",{className:"thin nowrap text-right"},r>0&&l.createElement("span",{className:"text-warning little-spacer-right"},"(+".concat(r,"d)")),a&&Object(u.isValidDate)(a)?l.createElement(Pe.a,{date:a,long:!0}):"")}var Te=n(615),Le=n(343);function Ie(e){let t=e.submittedAt,n=e.prevSubmittedAt;const a=!n||!Te(Object(u.parseDate)(t),Object(u.parseDate)(n));return l.createElement("td",{className:"thin nowrap text-right small"},a?l.createElement(Le.a,{date:t,long:!0}):"")}function Fe(e){let t=e.ms;return l.createElement("td",{className:"thin nowrap text-right"},t&&function(e){if(!e)return"";if(e<E)return y(e,"ms");if(e<10*E){const t=Math.floor(e/E);return t+"."+y(e-t*E,"s")}if(e<f)return y(Math.floor(e/E),"s");if(e<10*f){const t=Math.floor(e/f),n=Math.floor((e-t*f)/E);return y(t,"min")+" "+y(n,"s")}const t=Math.floor(e/C),n=Math.floor((e-t*C)/f);return y(t,"h")+" "+y(n,"min")}(t))}function Re(e){let t=e.id;return l.createElement("td",{className:"thin nowrap"},l.createElement("div",{className:"note"},t))}var Me=n(1374),qe=n.n(Me);function Ue(e){let t;switch(e.status){case b.e.PENDING:t=l.createElement(qe.a,null);break;case b.e.IN_PROGRESS:t=l.createElement("i",{className:"spinner"});break;case b.e.SUCCESS:t=l.createElement("span",{className:"badge badge-success"},Object(d.translate)("background_task.status.SUCCESS"));break;case b.e.FAILED:t=l.createElement("span",{className:"badge badge-error"},Object(d.translate)("background_task.status.FAILED"));break;case b.e.CANCELED:t=l.createElement("span",{className:"badge"},Object(d.translate)("background_task.status.CANCELED"));break;default:t=""}return l.createElement("td",{className:"thin spacer-right"},t)}function We(e){let t=e.submitter;return l.createElement("td",{className:"thin note"},l.createElement("span",{className:"text-limited-small text-bottom"},t||Object(d.translate)("anonymous")))}function ze(e){const t=e.task,n=e.component,a=e.onCancelTask,s=e.onFilterTask,r=e.previousTask;return l.createElement("tr",null,l.createElement(Ue,{status:t.status}),l.createElement(xe,{task:t}),l.createElement(Re,{id:t.id}),l.createElement(We,{submitter:t.submitterLogin}),l.createElement(Ie,{prevSubmittedAt:r&&r.submittedAt,submittedAt:t.submittedAt}),l.createElement(Ae,{date:t.submittedAt}),l.createElement(Ae,{baseDate:t.submittedAt,date:t.startedAt}),l.createElement(Ae,{baseDate:t.submittedAt,date:t.executedAt}),l.createElement(Fe,{ms:t.executionTimeMs}),l.createElement(Ee,{component:n,onCancelTask:a,onFilterTask:s,task:t}))}function Be(e){let t=e.tasks,n=e.component,a=e.loading,s=e.onCancelTask,r=e.onFilterTask;const o=ie("data zebra zebra-hover background-tasks",{"new-loading":a});return l.createElement("div",{className:"boxed-group boxed-group-inner"},l.createElement("table",{className:o},l.createElement("thead",null,l.createElement("tr",null,l.createElement("th",null,Object(d.translate)("background_tasks.table.status")),l.createElement("th",null,Object(d.translate)("background_tasks.table.task")),l.createElement("th",null,Object(d.translate)("background_tasks.table.id")),l.createElement("th",null,Object(d.translate)("background_tasks.table.submitter")),l.createElement("th",null," "),l.createElement("th",{className:"text-right"},Object(d.translate)("background_tasks.table.submitted")),l.createElement("th",{className:"text-right"},Object(d.translate)("background_tasks.table.started")),l.createElement("th",{className:"text-right"},Object(d.translate)("background_tasks.table.finished")),l.createElement("th",{className:"text-right"},Object(d.translate)("background_tasks.table.duration")),l.createElement("th",null," "))),l.createElement("tbody",null,t.map((e,t,a)=>l.createElement(ze,{component:n,key:e.id,onCancelTask:s,onFilterTask:r,previousTask:t>0?a[t-1]:void 0,task:e})))))}function Ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){Ye(e,t,n[t])})}return e}function Ye(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Je(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,s=!1,r=void 0;try{for(var o,l=e[Symbol.iterator]();!(a=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw r}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}n.d(t,"BackgroundTasksApp",function(){return Ke});class Ke extends l.PureComponent{constructor(e){super(e),this.mounted=!1,this.stopLoading=()=>{this.mounted&&this.setState({loading:!1})},this.loadTasks=()=>{this.setState({loading:!0});const e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={};return e.status===b.e.ALL?t.status=[b.e.PENDING,b.e.IN_PROGRESS,b.e.SUCCESS,b.e.FAILED,b.e.CANCELED].join():e.status===b.e.ALL_EXCEPT_PENDING?t.status=[b.e.IN_PROGRESS,b.e.SUCCESS,b.e.FAILED,b.e.CANCELED].join():t.status=e.status,e.taskType!==b.a&&(t.type=e.taskType),e.currents!==b.b.ALL&&(t.onlyCurrents=!0),e.minSubmittedAt&&(t.minSubmittedAt=Object(u.toShortNotSoISOString)(e.minSubmittedAt)),e.maxExecutedAt&&(t.maxExecutedAt=Object(u.toShortNotSoISOString)(e.maxExecutedAt)),e.query&&(t.q=e.query),t}({status:this.props.location.query.status||b.d.status,taskType:this.props.location.query.taskType||b.d.taskType,currents:this.props.location.query.currents||b.d.currents,minSubmittedAt:this.props.location.query.minSubmittedAt||b.d.minSubmittedAt,maxExecutedAt:this.props.location.query.maxExecutedAt||b.d.maxExecutedAt,query:this.props.location.query.query||b.d.query});this.props.component&&(e.componentId=this.props.component.id),Promise.all([Object(p.c)(e),Object(p.e)(e.componentId)]).then(e=>{let t=Je(e,2),n=t[0].tasks,a=t[1];if(this.mounted){const e=s()(n.map(e=>e.organization).filter(e=>e));this.props.fetchOrganizations(e),this.setState({failingCount:a.failing,loading:!1,pendingCount:a.pending,pendingTime:a.pendingTime,tasks:n})}},this.stopLoading)},this.handleFilterUpdate=e=>{const t=Ge({},this.props.location.query,e);Object.keys(b.d).forEach(e=>{t[e]===b.d[e]&&delete t[e]}),t.minSubmittedAt&&(t.minSubmittedAt=Object(u.toShortNotSoISOString)(t.minSubmittedAt)),t.maxExecutedAt&&(t.maxExecutedAt=Object(u.toShortNotSoISOString)(t.maxExecutedAt)),this.props.router.push({pathname:this.props.location.pathname,query:t})},this.handleCancelTask=e=>(this.setState({loading:!0}),Object(p.b)(e.id).then(e=>{this.mounted&&this.setState(t=>({tasks:k(t.tasks,e),loading:!1}))},this.stopLoading)),this.handleFilterTask=e=>{this.handleFilterUpdate({query:e.componentKey})},this.handleShowFailing=()=>{this.handleFilterUpdate(Ge({},b.d,{status:b.e.FAILED,currents:b.b.ONLY_CURRENTS}))},this.handleCancelAllPending=()=>{this.setState({loading:!0}),Object(p.a)().then(()=>{this.mounted&&this.loadTasks()},this.stopLoading)},this.state={failingCount:0,loading:!0,pendingCount:0,tasks:[]},this.loadTasksDebounced=o()(this.loadTasks,b.c)}componentDidMount(){this.mounted=!0,Object(p.h)().then(e=>{this.setState({types:e}),this.loadTasks()},()=>{})}componentDidUpdate(e){e.component===this.props.component&&e.location===this.props.location||this.loadTasksDebounced()}componentWillUnmount(){this.mounted=!1}render(){const e=this.props.component,t=this.state,n=t.loading,a=t.types,s=t.tasks;if(!a)return l.createElement("div",{className:"page page-limited"},l.createElement("i",{className:"spinner"}));const r=this.props.location.query.status||b.d.status,o=this.props.location.query.taskType||b.d.taskType,i=this.props.location.query.currents||b.d.currents,u=Object(m.parseAsDate)(this.props.location.query.minSubmittedAt),p=Object(m.parseAsDate)(this.props.location.query.maxExecutedAt),g=this.props.location.query.query||"";return l.createElement("div",{className:"page page-limited"},l.createElement(h.a,{suggestions:"background_tasks"}),l.createElement(c.a,{defer:!1,title:Object(d.translate)("background_tasks.page")}),l.createElement(W,{component:e}),l.createElement(ce,{component:e,failingCount:this.state.failingCount,onCancelAllPending:this.handleCancelAllPending,onShowFailing:this.handleShowFailing,pendingCount:this.state.pendingCount,pendingTime:this.state.pendingTime}),l.createElement(V,{component:e,currents:i,loading:n,maxExecutedAt:p,minSubmittedAt:u,onFilterUpdate:this.handleFilterUpdate,onReload:this.loadTasksDebounced,query:g,status:r,taskType:o,types:a}),l.createElement(Be,{component:e,loading:n,onCancelTask:this.handleCancelTask,onFilterTask:this.handleFilterTask,tasks:s}),l.createElement(N,{tasks:s}))}}const Xe={fetchOrganizations:g.g};t.default=Object(i.connect)(null,Xe)(Ke)},330:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(2),s=n(355);function r(e){let t=e.suggestions;return a.createElement(s.a.Consumer,null,e=>{let n=e.addSuggestions,s=e.removeSuggestions;return a.createElement(o,{addSuggestions:n,removeSuggestions:s,suggestions:t})})}class o extends a.PureComponent{componentDidMount(){this.props.addSuggestions(this.props.suggestions)}componentDidUpdate(e){e.suggestions!==this.props.suggestions&&(this.props.removeSuggestions(this.props.suggestions),this.props.addSuggestions(e.suggestions))}componentWillUnmount(){this.props.removeSuggestions(this.props.suggestions)}render(){return null}}},343:function(e,t,n){"use strict";n.d(t,"b",function(){return l}),n.d(t,"a",function(){return c});var a=n(2),s=n(304),r=n(29);const o={year:"numeric",month:"short",day:"2-digit"},l={year:"numeric",month:"long",day:"numeric"};function c(e){let t=e.children,n=e.date,c=e.long;return a.createElement(s.FormattedDate,Object.assign({value:Object(r.parseDate)(n)},c?l:o),t)}},501:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"a",function(){return s}),n.d(t,"b",function(){return r}),n.d(t,"d",function(){return o}),n.d(t,"c",function(){return l});const a={ALL:"__ALL__",ALL_EXCEPT_PENDING:"__ALL_EXCEPT_PENDING__",PENDING:"PENDING",IN_PROGRESS:"IN_PROGRESS",SUCCESS:"SUCCESS",FAILED:"FAILED",CANCELED:"CANCELED"},s="ALL_TYPES",r={ALL:"__ALL__",ONLY_CURRENTS:"CURRENTS"},o={status:a.ALL_EXCEPT_PENDING,taskType:s,currents:r.ALL,minSubmittedAt:void 0,maxExecutedAt:void 0,query:""},l=250},519:function(e,t,n){"use strict";n.d(t,"a",function(){return j});var a=n(483),s=n.n(a),r=n(309),o=n(382),l=n(436),c=n(466),i=n(467),u=n(2),d=n(304),m=n(310),p=n(536),h=n.n(p),g=n(338),b=n.n(g),k=n(520),E=n.n(k),f=n(490),C=n.n(f),y=n(417),O=n.n(y),N=n(325),S=n(5);n(521),n(523);function v(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n,a,s={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}const _=Object(N.lazyLoad)(()=>n.e(313).then(n.t.bind(null,682,7)));class j extends u.PureComponent{constructor(e){super(e),this.focus=()=>{this.input&&this.input.focus(),this.openCalendar()},this.handleResetClick=()=>{this.closeCalendar(),this.props.onChange(void 0)},this.openCalendar=()=>{this.setState({currentMonth:this.props.value||this.props.currentMonth||new Date,lastHovered:void 0,open:!0})},this.closeCalendar=()=>{this.setState({open:!1})},this.handleDayClick=(e,t)=>{t.disabled||(this.closeCalendar(),this.props.onChange(e))},this.handleDayMouseEnter=(e,t)=>{this.setState({lastHovered:t.disabled?void 0:e})},this.handleCurrentMonthChange=e=>{let t=e.value;this.setState(e=>({currentMonth:l(e.currentMonth,t)}))},this.handleCurrentYearChange=e=>{let t=e.value;this.setState(e=>({currentMonth:c(e.currentMonth,t)}))},this.handlePreviousMonthClick=()=>{this.setState(e=>({currentMonth:i(e.currentMonth,1)}))},this.handleNextMonthClick=()=>{this.setState(e=>({currentMonth:o(e.currentMonth,1)}))},this.state={currentMonth:e.value||e.currentMonth||new Date,open:!1}}render(){const e=this.props,t=e.highlightFrom,n=e.highlightTo,a=e.minDate,o=e.value,l=this.state.lastHovered,c=this.props.maxDate||new Date,i=s()(12),d=s()((new Date).getFullYear()-10,(new Date).getFullYear()+1),p=o?[o]:[];let g;const k=l||o;t&&k&&(g={highlighted:{from:t,to:k}},p.push(t)),n&&k&&(g={highlighted:{from:k,to:n}},p.push(n));const f=s()(7).map(S.getWeekDayName),y=s()(7).map(S.getShortWeekDayName);return u.createElement(h.a,{onClickOutside:this.closeCalendar},u.createElement("span",{className:r("date-input-control",this.props.className)},u.createElement(D,{className:r("date-input-control-input",this.props.inputClassName,{"is-filled":void 0!==this.props.value}),innerRef:e=>this.input=e,name:this.props.name,onFocus:this.openCalendar,placeholder:this.props.placeholder,readOnly:!0,type:"text",value:o}),u.createElement(E.a,{className:"date-input-control-icon",fill:""}),void 0!==this.props.value&&u.createElement(m.ClearButton,{className:"button-tiny date-input-control-reset",iconProps:{size:12},onClick:this.handleResetClick}),this.state.open&&u.createElement("div",{className:"date-input-calendar"},u.createElement("nav",{className:"date-input-calendar-nav"},u.createElement(m.ButtonIcon,{className:"button-small",onClick:this.handlePreviousMonthClick},u.createElement(C.a,null)),u.createElement("div",{className:"date-input-calender-month"},u.createElement(b.a,{className:"date-input-calender-month-select",onChange:this.handleCurrentMonthChange,options:i.map(e=>({label:Object(S.getShortMonthName)(e),value:e})),value:this.state.currentMonth.getMonth()}),u.createElement(b.a,{className:"date-input-calender-month-select spacer-left",onChange:this.handleCurrentYearChange,options:d.map(e=>({label:String(e),value:e})),value:this.state.currentMonth.getFullYear()})),u.createElement(m.ButtonIcon,{className:"button-small",onClick:this.handleNextMonthClick},u.createElement(O.a,null))),u.createElement(_,{captionElement:u.createElement(x,null),disabledDays:{after:c,before:a},firstDayOfWeek:1,modifiers:g,month:this.state.currentMonth,navbarElement:u.createElement(x,null),onDayClick:this.handleDayClick,onDayMouseEnter:this.handleDayMouseEnter,selectedDays:p,weekdaysLong:f,weekdaysShort:y}))))}}function x(){return null}const D=Object(d.injectIntl)(e=>{let t=e.innerRef,n=e.intl,a=e.value,s=v(e,["innerRef","intl","value"]);const r=a&&n.formatDate(a,{year:"numeric",month:"short",day:"numeric"});return u.createElement("input",Object.assign({},s,{ref:t,value:r||""}))})},521:function(e,t,n){var a=n(522);"string"==typeof a&&(a=[[e.i,a,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};n(312)(a,s);a.locals&&(e.exports=a.locals)},522:function(e,t,n){(e.exports=n(311)(!1)).push([e.i,".DayPicker{display:inline-block}.DayPicker-wrapper{position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding-bottom:8px;flex-direction:row}.DayPicker-Months{display:flex;flex-wrap:wrap;justify-content:center}.DayPicker-Month{display:table;border-collapse:collapse;border-spacing:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:8px 8px 0}.DayPicker-Weekdays{display:table-header-group}.DayPicker-WeekdaysRow{display:table-row}.DayPicker-Weekday{display:table-cell;padding:8px;font-size:12px;text-align:center;color:#999}.DayPicker-Weekday abbr[title]{border-bottom:none;text-decoration:none}.DayPicker-Body{display:table-row-group}.DayPicker-Week{display:table-row}.DayPicker-Day{display:table-cell;line-height:15px;padding:8px;text-align:center;cursor:pointer;vertical-align:top;outline:none}.DayPicker--interactionDisabled .DayPicker-Day{cursor:default}.DayPicker-Footer{padding-top:8px}.DayPicker-Day--today{font-weight:700}.DayPicker-Day--outside{cursor:default;color:#8b9898}.DayPicker-Day--disabled{color:#cdcdcd;cursor:not-allowed}.DayPicker-Day--sunday{background-color:#f7f8f8}.DayPicker-Day--sunday:not(.DayPicker-Day--today){color:#dce0e0}.DayPicker-Day--selected:not(.DayPicker-Day--disabled):not(.DayPicker-Day--outside){background-color:#4b9fd5;color:#fff}.DayPicker:not(.DayPicker--interactionDisabled) .DayPicker-Day:not(.DayPicker-Day--disabled):not(.DayPicker-Day--selected):not(.DayPicker-Day--highlighted):not(.DayPicker-Day--outside):hover{background-color:#f3f3f3}.DayPicker-Day--highlighted:not(.DayPicker-Day--disabled):not(.DayPicker-Day--selected):not(.DayPicker-Day--outside){background-color:#cae3f2}",""])},523:function(e,t,n){var a=n(524);"string"==typeof a&&(a=[[e.i,a,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};n(312)(a,s);a.locals&&(e.exports=a.locals)},524:function(e,t,n){(e.exports=n(311)(!1)).push([e.i,".date-input-control{position:relative;display:inline-block;cursor:pointer}.date-input-control-input{width:130px;padding-left:24px!important;cursor:pointer}.date-input-control-input.is-filled{padding-right:16px!important}.date-input-control-icon{position:absolute;top:4px;left:4px}.date-input-control-icon path{fill:#cdcdcd;transition:fill .3s ease}.date-input-control-input:focus+.date-input-control-icon path{fill:#4b9fd5}.date-input-control-reset{position:absolute;top:4px;right:4px;border:none}.date-input-calendar{position:absolute;z-index:7500;top:100%;left:0;border:1px solid #e6e6e6;background-color:#fff;box-shadow:0 6px 12px rgba(0,0,0,.175)}.date-input-calendar-nav{display:flex;justify-content:space-between;align-items:center;padding-top:8px;padding-left:8px;padding-right:8px}.date-input-calender-month-select{width:70px}",""])},547:function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"e",function(){return l}),n.d(t,"f",function(){return c}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return u}),n.d(t,"g",function(){return d}),n.d(t,"h",function(){return m}),n.d(t,"i",function(){return p}),n.d(t,"j",function(){return h});var a=n(8),s=n(320);function r(e){return Object(a.getJSON)("/api/ce/analysis_status",e).catch(s.a)}function o(e){return Object(a.getJSON)("/api/ce/activity",e)}function l(e){const t={};return e&&Object.assign(t,{componentId:e}),Object(a.getJSON)("/api/ce/activity_status",t)}function c(e,t){return Object(a.getJSON)("/api/ce/task",{id:e,additionalFields:t}).then(e=>e.task)}function i(e){return Object(a.post)("/api/ce/cancel",{id:e}).then(()=>c(e),()=>c(e))}function u(){return Object(a.post)("/api/ce/cancel_all")}function d(e){return Object(a.getJSON)("/api/ce/component",{component:e}).catch(s.a)}function m(){return Object(a.getJSON)("/api/ce/task_types").then(e=>e.taskTypes)}function p(){return Object(a.getJSON)("/api/ce/worker_count").catch(s.a)}function h(e){return Object(a.post)("/api/ce/set_worker_count",{count:e}).catch(s.a)}},558:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(2),s=n(304),r=n(29);const o={hour:"numeric",minute:"numeric"},l={hour:"numeric",minute:"numeric",second:"numeric"};function c(e){let t=e.children,n=e.date,c=e.long;return a.createElement(s.FormattedTime,Object.assign({value:Object(r.parseDate)(n)},c?l:o),t)}},614:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var a=n(309),s=n(2),r=n(5),o=n(519);class l extends s.PureComponent{constructor(){super(...arguments),this.handleFromChange=e=>{this.props.onChange({from:e,to:this.to}),setTimeout(()=>{e&&!this.to&&this.toDateInput&&this.toDateInput.focus()},0)},this.handleToChange=e=>{this.setState({to:e}),this.props.onChange({from:this.from,to:e})}}get from(){return this.props.value&&this.props.value.from}get to(){return this.props.value&&this.props.value.to}render(){return s.createElement("div",{className:a("display-inline-flex-center",this.props.className)},s.createElement(o.a,{currentMonth:this.to,"data-test":"from",highlightTo:this.to,maxDate:this.to,onChange:this.handleFromChange,placeholder:Object(r.translate)("start_date"),value:this.from}),s.createElement("span",{className:"note little-spacer-left little-spacer-right"},Object(r.translate)("to_")),s.createElement(o.a,{currentMonth:this.from,"data-test":"to",highlightFrom:this.from,minDate:this.from,onChange:this.handleToChange,placeholder:Object(r.translate)("end_date"),ref:e=>this.toDateInput=e,value:this.to}))}}},808:function(e,t,n){"use strict";var a=n(2),s=n(316),r=n(318),o=n(693);function l(e){const t=e.link,n=void 0===t||t,s=e.organization;return e.shouldBeDisplayed&&s?a.createElement("span",null,n?a.createElement(o.a,{className:e.linkClassName,organization:s},s.name):s.name,a.createElement("span",{className:"slash-separator"})):null}t.a=Object(s.connect)((e,t)=>({organization:Object(r.getOrganizationByKey)(e,t.organizationKey),shouldBeDisplayed:Object(r.areThereCustomOrganizations)(e)}))(l)}}]);
//# sourceMappingURL=310.m.413c7b0a.chunk.js.map
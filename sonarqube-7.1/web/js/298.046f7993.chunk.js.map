{"version":3,"sources":["webpack:///./src/main/js/apps/permissions/project/components/AllHoldersList.js","webpack:///./src/main/js/apps/permissions/project/components/PageHeader.tsx","webpack:///./src/main/js/apps/permissions/project/components/PublicProjectDisclaimer.js","webpack:///./src/main/js/apps/permissions/project/components/App.js","webpack:///./src/main/js/apps/permissions/project/components/AppContainer.js"],"names":["_super","AllHoldersList","_this","apply","this","arguments","handleToggleUser","user","permission","permissions","includes","props","revokePermissionFromUser","login","grantPermissionToUser","handleToggleGroup","group","revokePermissionFromGroup","name","grantPermissionToGroup","handleSelectPermission","onPermissionSelect","AllHoldersList_extends","prototype","render","order","constants","component","qualifier","visibility","Object","lodash_js_exposed","map","p","key","l10n","description","index_js_exposed_default","a","createElement","HoldersList","groups","onSelectPermission","onToggleGroup","onToggleUser","selectedPermission","users","SearchForm","filter","onFilter","onFilterChange","onSearch","onQueryChange","query","PureComponent","PageHeader","mounted","state","applyTemplateModal","handleApplyTemplate","setState","handleApplyTemplateClose","PageHeader_extends","componentDidMount","componentWillUnmount","configuration","canApplyPermissionTemplate","visibilityDescription","index_js_exposed","className","loading","buttons","onClick","ApplyTemplate","onApply","loadHolders","onClose","organization","project","PublicProjectDisclaimer","handleCancelClick","event","preventDefault","handleConfirmClick","onConfirm","PublicProjectDisclaimer_extends","Modal","contentLabel","onRequestClose","id","href","App","call","stopLoading","_a","getUsers","api_permissions","Promise","resolve","getGroups","all","then","responses","error","onRequestFail","handleFilterChange","handleQueryChange","handlePermissionSelect","undefined","addPermissionToGroup","candidate","App_assign","concat","addPermissionToUser","removePermissionFromGroup","removePermissionFromUser","handleVisibilityChange","openDisclaimer","turnProjectToPrivate","turnProjectToPublic","onComponentChange","disclaimer","closeDisclaimer","App_extends","canTurnToPrivate","canUpdateProjectVisibilityToPrivate","Helmet_default","title","components_PageHeader","PageError","VisibilitySelector","onChange","UpgradeOrganizationBox","components_PublicProjectDisclaimer","components_AllHoldersList","__webpack_exports__","es","currentUser","rootReducer","dispatch","rootActions","components_App"],"mappings":"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","file":"js/298.046f7993.chunk.js","sourcesContent":["/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport { without } from 'lodash';\nimport SearchForm from '../../shared/components/SearchForm';\nimport HoldersList from '../../shared/components/HoldersList';\nimport { translate } from '../../../../helpers/l10n';\nimport { PERMISSIONS_ORDER_BY_QUALIFIER } from '../constants';\n\n/*::\ntype Props = {|\n  component: {\n    configuration?: {\n      canApplyPermissionTemplate: boolean,\n      canUpdateProjectVisibilityToPrivate: boolean\n    },\n    key: string,\n    organization: string,\n    qualifier: string,\n    visibility: string\n  },\n  filter: string,\n  grantPermissionToGroup: (group: string, permission: string) => Promise<void>,\n  grantPermissionToUser: (user: string, permission: string) => Promise<void>,\n  groups: Array<{\n    name: string,\n    permissions: Array<string>\n  }>,\n  onFilterChange: string => void,\n  onPermissionSelect: (string | void) => void,\n  onQueryChange: string => void,\n  query: string,\n  revokePermissionFromGroup: (group: string, permission: string) => Promise<void>,\n  revokePermissionFromUser: (user: string, permission: string) => Promise<void>,\n  selectedPermission: ?string,\n  visibility: string,\n  users: Array<{\n    login: string,\n    name: string,\n    permissions: Array<string>\n  }>\n|};\n*/\n\nexport default class AllHoldersList extends React.PureComponent {\n  /*:: props: Props; */\n\n  handleToggleUser = (user /*: Object */, permission /*: string */) => {\n    const hasPermission = user.permissions.includes(permission);\n\n    if (hasPermission) {\n      return this.props.revokePermissionFromUser(user.login, permission);\n    } else {\n      return this.props.grantPermissionToUser(user.login, permission);\n    }\n  };\n\n  handleToggleGroup = (group /*: Object */, permission /*: string */) => {\n    const hasPermission = group.permissions.includes(permission);\n\n    if (hasPermission) {\n      return this.props.revokePermissionFromGroup(group.name, permission);\n    } else {\n      return this.props.grantPermissionToGroup(group.name, permission);\n    }\n  };\n\n  handleSelectPermission = (permission /*: string | void */) => {\n    this.props.onPermissionSelect(permission);\n  };\n\n  render() {\n    let order = PERMISSIONS_ORDER_BY_QUALIFIER[this.props.component.qualifier];\n    if (this.props.visibility === 'public') {\n      order = without(order, 'user', 'codeviewer');\n    }\n\n    const permissions = order.map(p => ({\n      key: p,\n      name: translate('projects_role', p),\n      description: translate('projects_role', p, 'desc')\n    }));\n\n    return (\n      <HoldersList\n        groups={this.props.groups}\n        onSelectPermission={this.handleSelectPermission}\n        onToggleGroup={this.handleToggleGroup}\n        onToggleUser={this.handleToggleUser}\n        permissions={permissions}\n        selectedPermission={this.props.selectedPermission}\n        users={this.props.users}>\n        <SearchForm\n          filter={this.props.filter}\n          onFilter={this.props.onFilterChange}\n          onSearch={this.props.onQueryChange}\n          query={this.props.query}\n        />\n      </HoldersList>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport ApplyTemplate from './ApplyTemplate';\nimport { Component } from '../../../../app/types';\nimport { Button } from '../../../../components/ui/buttons';\nimport { translate } from '../../../../helpers/l10n';\n\ninterface Props {\n  component: Component;\n  loadHolders: () => void;\n  loading: boolean;\n}\n\ninterface State {\n  applyTemplateModal: boolean;\n}\n\nexport default class PageHeader extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { applyTemplateModal: false };\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  handleApplyTemplate = () => {\n    this.setState({ applyTemplateModal: true });\n  };\n\n  handleApplyTemplateClose = () => {\n    if (this.mounted) {\n      this.setState({ applyTemplateModal: false });\n    }\n  };\n\n  render() {\n    const { component } = this.props;\n    const { configuration } = component;\n    const canApplyPermissionTemplate =\n      configuration != null && configuration.canApplyPermissionTemplate;\n\n    const description = ['VW', 'SVW', 'APP'].includes(component.qualifier)\n      ? translate('roles.page.description_portfolio')\n      : translate('roles.page.description2');\n\n    const visibilityDescription =\n      component.qualifier === 'TRK' && component.visibility\n        ? translate('visibility', component.visibility, 'description', component.qualifier)\n        : null;\n\n    return (\n      <header className=\"page-header\">\n        <h1 className=\"page-title\">{translate('permissions.page')}</h1>\n\n        {this.props.loading && <i className=\"spinner\" />}\n\n        {canApplyPermissionTemplate && (\n          <div className=\"page-actions\">\n            <Button className=\"js-apply-template\" onClick={this.handleApplyTemplate}>\n              {translate('projects_role.apply_template')}\n            </Button>\n\n            {this.state.applyTemplateModal && (\n              <ApplyTemplate\n                onApply={this.props.loadHolders}\n                onClose={this.handleApplyTemplateClose}\n                organization={component.organization}\n                project={component}\n              />\n            )}\n          </div>\n        )}\n\n        <div className=\"page-description\">\n          <p>{description}</p>\n          {visibilityDescription != null && <p>{visibilityDescription}</p>}\n        </div>\n      </header>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport Modal from '../../../../components/controls/Modal';\nimport { translate, translateWithParameters } from '../../../../helpers/l10n';\n\n/*::\ntype Props = {\n  component: {\n    name: string,\n    qualifier: string\n  },\n  onClose: () => void,\n  onConfirm: () => void\n};\n*/\n\nexport default class PublicProjectDisclaimer extends React.PureComponent {\n  /*:: props: Props; */\n\n  handleCancelClick = (event /*: Event */) => {\n    event.preventDefault();\n    this.props.onClose();\n  };\n\n  handleConfirmClick = (event /*: Event */) => {\n    event.preventDefault();\n    this.props.onConfirm();\n    this.props.onClose();\n  };\n\n  render() {\n    const { qualifier } = this.props.component;\n\n    return (\n      <Modal contentLabel=\"modal form\" onRequestClose={this.props.onClose}>\n        <header className=\"modal-head\">\n          <h2>\n            {translateWithParameters('projects_role.turn_x_to_public', this.props.component.name)}\n          </h2>\n        </header>\n\n        <div className=\"modal-body\">\n          <p>{translate('projects_role.are_you_sure_to_turn_project_to_public', qualifier)}</p>\n          <p className=\"spacer-top\">\n            {translate('projects_role.are_you_sure_to_turn_project_to_public.2', qualifier)}\n          </p>\n        </div>\n\n        <footer className=\"modal-foot\">\n          <button id=\"confirm-turn-to-public\" onClick={this.handleConfirmClick}>\n            {translate('projects_role.turn_project_to_public', qualifier)}\n          </button>\n          <a href=\"#\" onClick={this.handleCancelClick}>\n            {translate('cancel')}\n          </a>\n        </footer>\n      </Modal>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport Helmet from 'react-helmet';\nimport { without } from 'lodash';\nimport AllHoldersList from './AllHoldersList';\nimport PageHeader from './PageHeader';\nimport PublicProjectDisclaimer from './PublicProjectDisclaimer';\nimport UpgradeOrganizationBox from '../../../../components/common/UpgradeOrganizationBox';\nimport VisibilitySelector from '../../../../components/common/VisibilitySelector';\nimport PageError from '../../shared/components/PageError';\nimport * as api from '../../../../api/permissions';\nimport { translate } from '../../../../helpers/l10n';\nimport '../../styles.css';\n\n/*::\nexport type Props = {|\n  component: {\n    configuration?: {\n      canApplyPermissionTemplate: boolean,\n      canUpdateProjectVisibilityToPrivate: boolean\n    },\n    key: string,\n    name: string,\n    organization: string,\n    qualifier: string,\n    visibility: string\n  },\n  onComponentChange: (changes: {}) => void,\n  onRequestFail: Object => void\n|};\n*/\n\n/*::\nexport type State = {|\n  disclaimer: boolean,\n  filter: string,\n  groups: Array<{\n    name: string,\n    permissions: Array<string>\n  }>,\n  loading: boolean,\n  query: string,\n  selectedPermission?: string,\n  users: Array<{\n    login: string,\n    name: string,\n    permissions: Array<string>\n  }>\n|};\n*/\n\nexport default class App extends React.PureComponent {\n  /*:: mounted: boolean; */\n  /*:: props: Props; */\n  /*:: state: State; */\n\n  constructor(props /*: Props */) {\n    super(props);\n    this.state = {\n      disclaimer: false,\n      filter: 'all',\n      groups: [],\n      loading: true,\n      query: '',\n      users: []\n    };\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n    this.loadHolders();\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  stopLoading = () => {\n    if (this.mounted) {\n      this.setState({ loading: false });\n    }\n  };\n\n  loadHolders = () => {\n    if (this.mounted) {\n      this.setState({ loading: true });\n\n      const { component } = this.props;\n      const { filter, query, selectedPermission } = this.state;\n\n      const getUsers =\n        filter !== 'groups'\n          ? api.getPermissionsUsersForComponent(\n              component.key,\n              query,\n              selectedPermission,\n              component.organization\n            )\n          : Promise.resolve([]);\n\n      const getGroups =\n        filter !== 'users'\n          ? api.getPermissionsGroupsForComponent(\n              component.key,\n              query,\n              selectedPermission,\n              component.organization\n            )\n          : Promise.resolve([]);\n\n      Promise.all([getUsers, getGroups]).then(\n        responses => {\n          if (this.mounted) {\n            this.setState({ loading: false, groups: responses[1], users: responses[0] });\n          }\n        },\n        error => {\n          if (this.mounted) {\n            this.props.onRequestFail(error);\n            this.setState({ loading: false });\n          }\n        }\n      );\n    }\n  };\n\n  handleFilterChange = (filter /*: string */) => {\n    if (this.mounted) {\n      this.setState({ filter }, this.loadHolders);\n    }\n  };\n\n  handleQueryChange = (query /*: string */) => {\n    if (this.mounted) {\n      this.setState({ query }, this.loadHolders);\n    }\n  };\n\n  handlePermissionSelect = (selectedPermission /*: ?string */) => {\n    if (this.mounted) {\n      this.setState(\n        (state /*: State */) => ({\n          selectedPermission:\n            state.selectedPermission === selectedPermission ? undefined : selectedPermission\n        }),\n        this.loadHolders\n      );\n    }\n  };\n\n  addPermissionToGroup = (group /*: string */, permission /*: string */) =>\n    this.state.groups.map(\n      candidate =>\n        candidate.name === group\n          ? { ...candidate, permissions: [...candidate.permissions, permission] }\n          : candidate\n    );\n\n  addPermissionToUser = (user /*: string */, permission /*: string */) =>\n    this.state.users.map(\n      candidate =>\n        candidate.login === user\n          ? { ...candidate, permissions: [...candidate.permissions, permission] }\n          : candidate\n    );\n\n  removePermissionFromGroup = (group /*: string */, permission /*: string */) =>\n    this.state.groups.map(\n      candidate =>\n        candidate.name === group\n          ? { ...candidate, permissions: without(candidate.permissions, permission) }\n          : candidate\n    );\n\n  removePermissionFromUser = (user /*: string */, permission /*: string */) =>\n    this.state.users.map(\n      candidate =>\n        candidate.login === user\n          ? { ...candidate, permissions: without(candidate.permissions, permission) }\n          : candidate\n    );\n\n  grantPermissionToGroup = (group /*: string */, permission /*: string */) => {\n    if (this.mounted) {\n      this.setState({ loading: true, groups: this.addPermissionToGroup(group, permission) });\n      return api\n        .grantPermissionToGroup(\n          this.props.component.key,\n          group,\n          permission,\n          this.props.component.organization\n        )\n        .then(this.stopLoading, error => {\n          if (this.mounted) {\n            this.setState({\n              loading: false,\n              groups: this.removePermissionFromGroup(group, permission)\n            });\n            this.props.onRequestFail(error);\n          }\n        });\n    }\n    return Promise.resolve();\n  };\n\n  grantPermissionToUser = (user /*: string */, permission /*: string */) => {\n    if (this.mounted) {\n      this.setState({ loading: true, users: this.addPermissionToUser(user, permission) });\n      return api\n        .grantPermissionToUser(\n          this.props.component.key,\n          user,\n          permission,\n          this.props.component.organization\n        )\n        .then(this.stopLoading, error => {\n          if (this.mounted) {\n            this.setState({\n              loading: false,\n              users: this.removePermissionFromUser(user, permission)\n            });\n            this.props.onRequestFail(error);\n          }\n        });\n    }\n    return Promise.resolve();\n  };\n\n  revokePermissionFromGroup = (group /*: string */, permission /*: string */) => {\n    if (this.mounted) {\n      this.setState({ loading: true, groups: this.removePermissionFromGroup(group, permission) });\n      return api\n        .revokePermissionFromGroup(\n          this.props.component.key,\n          group,\n          permission,\n          this.props.component.organization\n        )\n        .then(this.stopLoading, error => {\n          if (this.mounted) {\n            this.setState({\n              loading: false,\n              groups: this.addPermissionToGroup(group, permission)\n            });\n            this.props.onRequestFail(error);\n          }\n        });\n    }\n    return Promise.resolve();\n  };\n\n  revokePermissionFromUser = (user /*: string */, permission /*: string */) => {\n    if (this.mounted) {\n      this.setState({ loading: true, users: this.removePermissionFromUser(user, permission) });\n      return api\n        .revokePermissionFromUser(\n          this.props.component.key,\n          user,\n          permission,\n          this.props.component.organization\n        )\n        .then(this.stopLoading, error => {\n          if (this.mounted) {\n            this.setState({\n              loading: false,\n              users: this.addPermissionToUser(user, permission)\n            });\n            this.props.onRequestFail(error);\n          }\n        });\n    }\n    return Promise.resolve();\n  };\n\n  handleVisibilityChange = (visibility /*: string */) => {\n    if (visibility === 'public') {\n      this.openDisclaimer();\n    } else {\n      this.turnProjectToPrivate();\n    }\n  };\n\n  turnProjectToPublic = () => {\n    this.props.onComponentChange({ visibility: 'public' });\n    api.changeProjectVisibility(this.props.component.key, 'public').then(\n      () => {\n        this.loadHolders();\n      },\n      error => {\n        this.props.onComponentChange({ visibility: 'private' });\n        this.props.onRequestFail(error);\n      }\n    );\n  };\n\n  turnProjectToPrivate = () => {\n    this.props.onComponentChange({ visibility: 'private' });\n    api.changeProjectVisibility(this.props.component.key, 'private').then(\n      () => {\n        this.loadHolders();\n      },\n      error => {\n        this.props.onComponentChange({ visibility: 'public' });\n        this.props.onRequestFail(error);\n      }\n    );\n  };\n\n  openDisclaimer = () => {\n    if (this.mounted) {\n      this.setState({ disclaimer: true });\n    }\n  };\n\n  closeDisclaimer = () => {\n    if (this.mounted) {\n      this.setState({ disclaimer: false });\n    }\n  };\n\n  render() {\n    const canTurnToPrivate =\n      this.props.component.configuration != null &&\n      this.props.component.configuration.canUpdateProjectVisibilityToPrivate;\n\n    return (\n      <div className=\"page page-limited\" id=\"project-permissions-page\">\n        <Helmet title={translate('permissions.page')} />\n\n        <PageHeader\n          component={this.props.component}\n          loading={this.state.loading}\n          loadHolders={this.loadHolders}\n        />\n        <PageError />\n        <div>\n          <VisibilitySelector\n            canTurnToPrivate={canTurnToPrivate}\n            className=\"big-spacer-top big-spacer-bottom\"\n            onChange={this.handleVisibilityChange}\n            visibility={this.props.component.visibility}\n          />\n          {this.props.component.qualifier === 'TRK' &&\n            !canTurnToPrivate && (\n              <UpgradeOrganizationBox organization={this.props.component.organization} />\n            )}\n          {this.state.disclaimer && (\n            <PublicProjectDisclaimer\n              component={this.props.component}\n              onClose={this.closeDisclaimer}\n              onConfirm={this.turnProjectToPublic}\n            />\n          )}\n        </div>\n        <AllHoldersList\n          component={this.props.component}\n          filter={this.state.filter}\n          grantPermissionToGroup={this.grantPermissionToGroup}\n          grantPermissionToUser={this.grantPermissionToUser}\n          groups={this.state.groups}\n          onFilterChange={this.handleFilterChange}\n          onPermissionSelect={this.handlePermissionSelect}\n          onQueryChange={this.handleQueryChange}\n          query={this.state.query}\n          revokePermissionFromGroup={this.revokePermissionFromGroup}\n          revokePermissionFromUser={this.revokePermissionFromUser}\n          selectedPermission={this.state.selectedPermission}\n          users={this.state.users}\n          visibility={this.props.component.visibility}\n        />\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { connect } from 'react-redux';\nimport App from './App';\nimport { onFail } from '../../../../store/rootActions';\nimport { getCurrentUser } from '../../../../store/rootReducer';\n\nconst mapStateToProps = state => ({\n  currentUser: getCurrentUser(state)\n});\n\nconst mapDispatchToProps = dispatch => ({\n  onRequestFail: onFail(dispatch)\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n"],"sourceRoot":""}
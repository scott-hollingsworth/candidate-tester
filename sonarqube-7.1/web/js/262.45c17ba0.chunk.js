(window.webpackJsonp=window.webpackJsonp||[]).push([[262],{1008:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"a",function(){return o}),n.d(t,"b",function(){return r}),n.d(t,"d",function(){return s}),n.d(t,"c",function(){return c});var a={ALL:"__ALL__",ALL_EXCEPT_PENDING:"__ALL_EXCEPT_PENDING__",PENDING:"PENDING",IN_PROGRESS:"IN_PROGRESS",SUCCESS:"SUCCESS",FAILED:"FAILED",CANCELED:"CANCELED"},o="ALL_TYPES",r={ALL:"__ALL__",ONLY_CURRENTS:"CURRENTS"},s={status:a.ALL_EXCEPT_PENDING,taskType:o,currents:r.ALL,minSubmittedAt:void 0,maxExecutedAt:void 0,query:""},c=250},1022:function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"d",function(){return s}),n.d(t,"e",function(){return c}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return l}),n.d(t,"f",function(){return u}),n.d(t,"g",function(){return p}),n.d(t,"h",function(){return m}),n.d(t,"i",function(){return d});var a=n(3),o=n(13);function r(e){return Object(a.getJSON)("/api/ce/activity",e)}function s(e){var t={};return e&&Object.assign(t,{componentId:e}),Object(a.getJSON)("/api/ce/activity_status",t)}function c(e,t){return Object(a.getJSON)("/api/ce/task",{id:e,additionalFields:t}).then(function(e){return e.task})}function i(e){return Object(a.post)("/api/ce/cancel",{id:e}).then(function(){return c(e)},function(){return c(e)})}function l(){return Object(a.post)("/api/ce/cancel_all")}function u(e){return Object(a.getJSON)("/api/ce/component",{componentKey:e}).catch(o.a)}function p(){return Object(a.getJSON)("/api/ce/task_types").then(function(e){return e.taskTypes})}function m(){return Object(a.getJSON)("/api/ce/worker_count").catch(o.a)}function d(e){return Object(a.post)("/api/ce/set_worker_count",{count:e}).catch(o.a)}},1025:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var a=n(0),o=n(27),r=n(28),s=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},c={hour:"numeric",minute:"numeric"},i={hour:"numeric",minute:"numeric",second:"numeric"};function l(e){var t=e.children,n=e.date,l=e.long;return a.createElement(o.d,s({value:Object(r.e)(n)},l?i:c),t)}},1026:function(e,t,n){"use strict";var a,o=n(0),r=n(6),s=n(250),c=n(1),i=(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleFromChange=function(e){t.props.onChange({from:e,to:t.to}),setTimeout(function(){e&&!t.to&&t.toDateInput&&t.toDateInput.focus()},0)},t.handleToChange=function(e){t.setState({to:e}),t.props.onChange({from:t.from,to:e})},t}return i(t,e),Object.defineProperty(t.prototype,"from",{get:function(){return this.props.value&&this.props.value.from},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"to",{get:function(){return this.props.value&&this.props.value.to},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this;return o.createElement("div",{className:r("display-inline-flex-center",this.props.className)},o.createElement(s.a,{currentMonth:this.to,"data-test":"from",highlightTo:this.to,maxDate:this.to,onChange:this.handleFromChange,placeholder:Object(c.l)("start_date"),value:this.from}),o.createElement("span",{className:"note little-spacer-left little-spacer-right"},Object(c.l)("to_")),o.createElement(s.a,{currentMonth:this.from,"data-test":"to",highlightFrom:this.from,minDate:this.from,onChange:this.handleToChange,placeholder:Object(c.l)("end_date"),ref:function(t){return e.toDateInput=t},value:this.to}))},t}(o.PureComponent);t.a=l},1027:function(e,t,n){"use strict";var a=n(0),o=n(10),r=n(7),s=n(247);function c(e){var t=e.link,n=void 0===t||t,o=e.organization;return e.shouldBeDisplayed&&o?a.createElement("span",null,n?a.createElement(s.a,{className:e.linkClassName,organization:o},o.name):o.name,a.createElement("span",{className:"slash-separator"})):null}t.a=Object(o.connect)(function(e,t){return{organization:Object(r.getOrganizationByKey)(e,t.organizationKey),shouldBeDisplayed:Object(r.areThereCustomOrganizations)(e)}})(c)},1132:function(e,t,n){},1180:function(e,t,n){"use strict";n.r(t);var a,o=n(0),r=n.n(o),s=n(5),c=n.n(s),i=n(22),l=n.n(i),u=n(4),p=n(10),m=n(1008),d=n(1022),h=n(20),f=n(51),b=n(11),g=n(1),k=(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),E=function(e){function t(t){var n=e.call(this,t)||this;return n.mounted=!1,n.handleClose=function(){n.props.onClose()},n.handleWorkerCountChange=function(e){return n.setState({newWorkerCount:e.value})},n.handleSubmit=function(e){e.preventDefault(),n.setState({submitting:!0});var t=n.state.newWorkerCount;Object(d.i)(t).then(function(){n.mounted&&n.props.onClose(t)},function(){n.mounted&&n.setState({submitting:!1})})},n.state={newWorkerCount:t.workerCount,submitting:!1},n}return k(t,e),t.prototype.componentDidMount=function(){this.mounted=!0},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){var e=Object(u.times)(10).map(function(e,t){return{label:String(t+1),value:t+1}});return o.createElement(h.a,{contentLabel:Object(g.l)("background_tasks.change_number_of_workers"),onRequestClose:this.handleClose},o.createElement("header",{className:"modal-head"},o.createElement("h2",null,Object(g.l)("background_tasks.change_number_of_workers"))),o.createElement("form",{onSubmit:this.handleSubmit},o.createElement("div",{className:"modal-body"},o.createElement(f.c,{className:"input-tiny spacer-top",clearable:!1,onChange:this.handleWorkerCountChange,options:e,searchable:!1,value:this.state.newWorkerCount}),o.createElement("div",{className:"big-spacer-top alert alert-success markdown"},Object(g.l)("background_tasks.change_number_of_workers.hint"))),o.createElement("footer",{className:"modal-foot"},o.createElement("div",null,this.state.submitting&&o.createElement("i",{className:"spinner spacer-right"}),o.createElement(b.f,{disabled:this.state.submitting},Object(g.l)("save")),o.createElement(b.e,{onClick:this.handleClose},Object(g.l)("cancel"))))))},t}(o.PureComponent),y=n(994);function _(e){return o.createElement(y.a,{position:e.popupPosition,customClass:"bubble-popup-bottom-right"},o.createElement("div",{className:"abs-width-400"},o.createElement("h6",{className:"spacer-bottom"},Object(g.l)("background_tasks.add_more_workers")),o.createElement("p",{className:"big-spacer-bottom markdown"},Object(g.l)("background_tasks.add_more_workers.text")),o.createElement("p",null,o.createElement("a",{href:"https://redirect.sonarsource.com/editions/enterprise.html",target:"_blank"},Object(g.l)("learn_more")))))}var C=n(105),O=n(996),v=n(149),N=n(25),j=n(15),S=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mounted=!1,t.state={canSetWorkerCount:!1,formOpen:!1,loading:!0,noSupportPopup:!1,workerCount:1},t.loadWorkers=function(){t.setState({loading:!0}),Object(d.h)().then(function(e){var n=e.canSetWorkerCount,a=e.value;t.mounted&&t.setState({canSetWorkerCount:n,loading:!1,workerCount:a})},function(){t.mounted&&t.setState({loading:!1})})},t.closeForm=function(e){return e?t.setState({formOpen:!1,workerCount:e}):t.setState({formOpen:!1})},t.handleChangeClick=function(){t.setState({formOpen:!0})},t.handleHelpClick=function(e){e.preventDefault(),e.stopPropagation(),t.toggleNoSupportPopup()},t.toggleNoSupportPopup=function(e){void 0!==e?t.setState({noSupportPopup:e}):t.setState(function(e){return{noSupportPopup:!e.noSupportPopup}})},t}return S(t,e),t.prototype.componentDidMount=function(){this.mounted=!0,this.loadWorkers()},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){var e=this.state,t=e.canSetWorkerCount,n=e.formOpen,a=e.loading,r=e.workerCount;return o.createElement("div",null,!a&&r>1&&o.createElement(N.a,{overlay:Object(g.l)("background_tasks.number_of_workers.warning")},o.createElement("span",null,o.createElement(C.a,{className:"little-spacer-right bt-workers-warning-icon",fill:"#d3d3d3"}))),o.createElement("span",{className:"text-middle"},Object(g.l)("background_tasks.number_of_workers"),a?o.createElement("i",{className:"spinner little-spacer-left"}):o.createElement("strong",{className:"little-spacer-left"},r)),!a&&t&&o.createElement(N.a,{overlay:Object(g.l)("background_tasks.change_number_of_workers")},o.createElement(b.d,{className:"js-edit button-small spacer-left",onClick:this.handleChangeClick})),!a&&!t&&o.createElement("span",{className:"spacer-left"},o.createElement("a",{className:"link-no-underline",href:"#",onClick:this.handleHelpClick},o.createElement(v.a,{className:"text-text-bottom",fill:j.gray80})),o.createElement(O.a,{isOpen:this.state.noSupportPopup,popup:o.createElement(_,null),position:"bottomright",togglePopup:this.toggleNoSupportPopup})),n&&o.createElement(E,{onClose:this.closeForm,workerCount:this.state.workerCount}))},t}(o.PureComponent);function P(e){return o.createElement("header",{className:"page-header"},o.createElement("h1",{className:"page-title"},Object(g.l)("background_tasks.page")),!e.component&&o.createElement("div",{className:"page-actions"},o.createElement(A,null)),o.createElement("p",{className:"page-description"},Object(g.l)("background_tasks.page.description")))}var w=function(e){return e.tasks.length<1e3?null:r.a.createElement("footer",{className:"spacer-top note text-center"},Object(g.m)("max_results_reached",1e3))},x=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleShowFailing=function(e){e.preventDefault(),e.currentTarget.blur(),t.props.onShowFailing()},t}return x(t,e),t.prototype.renderPending=function(){return null==this.props.pendingCount?null:this.props.pendingCount>0?r.a.createElement("span",null,r.a.createElement("span",{className:"js-pending-count emphasised-measure"},this.props.pendingCount)," ",Object(g.l)("background_tasks.pending"),this.props.isSystemAdmin&&r.a.createElement(N.a,{overlay:Object(g.l)("background_tasks.cancel_all_tasks")},r.a.createElement(b.c,{className:"js-cancel-pending spacer-left",onClick:this.props.onCancelAllPending}))):r.a.createElement("span",null,r.a.createElement("span",{className:"js-pending-count emphasised-measure"},this.props.pendingCount)," ",Object(g.l)("background_tasks.pending"))},t.prototype.renderFailures=function(){return null==this.props.failingCount?null:this.props.component?null:this.props.failingCount>0?r.a.createElement("span",null,r.a.createElement(N.a,{overlay:Object(g.l)("background_tasks.failing_count")},r.a.createElement("a",{className:"js-failures-count emphasised-measure",href:"#",onClick:this.handleShowFailing},this.props.failingCount))," ",Object(g.l)("background_tasks.failures")):r.a.createElement("span",null,r.a.createElement(N.a,{overlay:Object(g.l)("background_tasks.failing_count")},r.a.createElement("span",{className:"js-failures-count emphasised-measure"},this.props.failingCount))," ",Object(g.l)("background_tasks.failures"))},t.prototype.render=function(){return r.a.createElement("section",{className:"big-spacer-top big-spacer-bottom"},r.a.createElement("span",null,this.renderPending()),r.a.createElement("span",{className:"huge-spacer-left"},this.renderFailures()))},t}(r.a.PureComponent),L=n(7),D=Object(p.connect)(function(e){return{isSystemAdmin:!!Object(L.getAppState)(e).canAdmin}})(T),R=function(e){var t=e.value,n=e.onChange,a=[{value:m.e.ALL,label:Object(g.l)("background_task.status.ALL")},{value:m.e.ALL_EXCEPT_PENDING,label:Object(g.l)("background_task.status.ALL_EXCEPT_PENDING")},{value:m.e.PENDING,label:Object(g.l)("background_task.status.PENDING")},{value:m.e.IN_PROGRESS,label:Object(g.l)("background_task.status.IN_PROGRESS")},{value:m.e.SUCCESS,label:Object(g.l)("background_task.status.SUCCESS")},{value:m.e.FAILED,label:Object(g.l)("background_task.status.FAILED")},{value:m.e.CANCELED,label:Object(g.l)("background_task.status.CANCELED")}];return r.a.createElement(f.c,{value:t,onChange:function(e){return n(e.value)},className:"input-medium",options:a,clearable:!1,searchable:!1})},q=function(e){var t=e.value,n=e.onChange,a=e.types.map(function(e){return{value:e,label:Object(g.l)("background_task.type",e)}}),o=[{value:m.a,label:Object(g.l)("background_task.type.ALL")}].concat(a);return r.a.createElement(f.c,{value:t,onChange:function(e){return n(e.value)},className:"input-medium",options:o,clearable:!1,searchable:!1})},F=n(46),I=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleChange=function(e){var n=e?m.b.ONLY_CURRENTS:m.b.ALL;t.props.onChange(n)},t}return I(t,e),t.prototype.render=function(){var e=this.props.value===m.b.ONLY_CURRENTS;return o.createElement("div",{className:"bt-search-form-field"},o.createElement(F.a,{checked:e,onCheck:this.handleChange},o.createElement("span",{className:"little-spacer-left"},Object(g.l)("yes"))))},t}(o.PureComponent),G=n(1026),W=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleDateRangeChange=function(e){var n=e.from,a=e.to;t.props.onChange({minSubmittedAt:n,maxExecutedAt:a})},t}return W(t,e),t.prototype.render=function(){var e={from:this.props.minSubmittedAt,to:this.props.maxExecutedAt};return o.createElement("div",{className:"nowrap"},o.createElement(G.a,{onChange:this.handleDateRangeChange,value:e}))},t}(o.PureComponent),M=n(47),K=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleDateChange=function(e){t.props.onFilterUpdate(e)},t.handleQueryChange=function(e){t.props.onFilterUpdate({query:e})},t}return K(t,e),t.prototype.handleStatusChange=function(e){this.props.onFilterUpdate({status:e})},t.prototype.handleTypeChange=function(e){this.props.onFilterUpdate({taskType:e})},t.prototype.handleCurrentsChange=function(e){this.props.onFilterUpdate({currents:e})},t.prototype.handleReload=function(e){e.target.blur(),this.props.onReload()},t.prototype.handleReset=function(e){e.preventDefault(),e.target.blur(),this.props.onFilterUpdate(m.d)},t.prototype.renderSearchBox=function(){var e=this.props,t=e.component,n=e.query;return t?null:r.a.createElement("li",{className:"bt-search-form-large"},r.a.createElement(M.a,{onChange:this.handleQueryChange,placeholder:Object(g.l)("background_tasks.search_by_task_or_component"),value:n}))},t.prototype.render=function(){var e=this.props,t=e.loading,n=e.component,a=e.types,o=e.status,s=e.taskType,c=e.currents,i=e.minSubmittedAt,l=e.maxExecutedAt;return r.a.createElement("section",{className:"big-spacer-top big-spacer-bottom"},r.a.createElement("ul",{className:"bt-search-form"},r.a.createElement("li",null,r.a.createElement("h6",{className:"bt-search-form-label"},Object(g.l)("status")),r.a.createElement(R,{value:o,onChange:this.handleStatusChange.bind(this)})),a.length>1&&r.a.createElement("li",null,r.a.createElement("h6",{className:"bt-search-form-label"},Object(g.l)("type")),r.a.createElement(q,{value:s,types:a,onChange:this.handleTypeChange.bind(this)})),!n&&r.a.createElement("li",null,r.a.createElement("h6",{className:"bt-search-form-label"},Object(g.l)("background_tasks.currents_filter.ONLY_CURRENTS")),r.a.createElement(U,{value:c,onChange:this.handleCurrentsChange.bind(this)})),r.a.createElement("li",null,r.a.createElement("h6",{className:"bt-search-form-label"},Object(g.l)("date")),r.a.createElement(z,{maxExecutedAt:l,minSubmittedAt:i,onChange:this.handleDateChange})),this.renderSearchBox(),r.a.createElement("li",{className:"nowrap"},r.a.createElement("button",{className:"js-reload",onClick:this.handleReload.bind(this),disabled:t},Object(g.l)("reload"))," ",r.a.createElement("button",{ref:"resetButton",onClick:this.handleReset.bind(this),disabled:t},Object(g.l)("reset_verb")))))},t.propTypes={loading:c.a.bool.isRequired,status:c.a.any.isRequired,taskType:c.a.any.isRequired,currents:c.a.any.isRequired,query:c.a.string.isRequired,onFilterUpdate:c.a.func.isRequired,onReload:c.a.func.isRequired},t}(r.a.PureComponent),B=n(6),X=n.n(B),Y=n(261);function Q(e){var t;switch(e.status){case m.e.PENDING:t=o.createElement(Y.a,null);break;case m.e.IN_PROGRESS:t=o.createElement("i",{className:"spinner"});break;case m.e.SUCCESS:t=o.createElement("span",{className:"badge badge-success"},Object(g.l)("background_task.status.SUCCESS"));break;case m.e.FAILED:t=o.createElement("span",{className:"badge badge-danger"},Object(g.l)("background_task.status.FAILED"));break;case m.e.CANCELED:t=o.createElement("span",{className:"badge badge-muted"},Object(g.l)("background_task.status.CANCELED"));break;default:t=""}return o.createElement("td",{className:"thin spacer-right"},t)}var H=n(2);function V(e){var t=e.type;return o.createElement("span",{className:"display-inline-block note"},"[",Object(g.l)("background_task.type",t),"]")}var Z=n(53),$=n(1027),ee=n(38),te=n(164),ne=n(163),ae=n(162);function oe(e){var t=e.task;return t.componentKey?o.createElement("td",null,"SHORT"===t.branchType&&o.createElement(te.a,{className:"little-spacer-right"}),"LONG"===t.branchType&&o.createElement(ne.a,{className:"little-spacer-right"}),void 0!==t.pullRequest&&o.createElement(ae.a,{className:"little-spacer-right"}),!t.branchType&&!t.pullRequest&&t.componentQualifier&&o.createElement("span",{className:"little-spacer-right"},o.createElement(Z.a,{qualifier:t.componentQualifier})),t.organization&&o.createElement($.a,{organizationKey:t.organization}),t.componentName&&o.createElement(H.Link,{className:"spacer-right",to:function(e,t){return t.branch&&"SHORT"===t.branchType?Object(ee.y)(e,t.branchType):t.branchType&&"LONG"===t.branchType?Object(ee.m)(e,t.branchType):t.pullRequest?Object(ee.s)(e,t.pullRequest):Object(ee.r)(e)}(t.componentKey,t)},t.componentName,t.branch&&o.createElement("span",{className:"text-limited text-text-top",title:t.branch},o.createElement("span",{style:{marginLeft:5,marginRight:5}},"/"),t.branch),t.pullRequest&&o.createElement(N.a,{overlay:t.pullRequestTitle},o.createElement("span",{className:"text-limited text-text-top"},o.createElement("span",{style:{marginLeft:5,marginRight:5}},"/"),t.pullRequest))),o.createElement(V,{type:t.type})):o.createElement("td",null,o.createElement("span",{className:"note"},t.id),o.createElement(V,{type:t.type}))}function re(e){var t=e.id;return o.createElement("td",{className:"thin nowrap"},o.createElement("div",{className:"note"},t))}var se=n(147),ce=n(28);function ie(e){var t=e.submittedAt,n=e.prevSubmittedAt,a=!n||!Object(ce.c)(Object(ce.e)(t),Object(ce.e)(n));return o.createElement("td",{className:"thin nowrap text-right"},a?o.createElement(se.a,{date:t,long:!0}):"")}var le=n(1025);function ue(e){var t=e.date,n=e.baseDate,a=t&&Object(ce.e)(t),r=n&&Object(ce.e)(n),s=a&&r&&Object(ce.d)(a)&&Object(ce.d)(r)?Object(ce.a)(a,r):0;return o.createElement("td",{className:"thin nowrap text-right"},s>0&&o.createElement("span",{className:"text-warning little-spacer-right"},"(+"+s+"d)"),a&&Object(ce.d)(a)?o.createElement(le.a,{date:a,long:!0}):"")}var pe=1e3,me=60*pe;function de(e,t){return""+e+t}function he(e){var t,n=e.ms;return o.createElement("td",{className:"thin nowrap text-right"},n&&((t=n)?t>=me?de(Math.round(t/me),"min"):t>=pe?de(Math.round(t/pe),"s"):de(t,"ms"):""))}var fe=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),be=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mounted=!1,t.state={},t.handleCloseClick=function(e){e.preventDefault(),t.props.onClose()},t}return fe(t,e),t.prototype.componentDidMount=function(){this.mounted=!0,this.loadScannerContext()},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.loadScannerContext=function(){var e=this;Object(d.e)(this.props.task.id,["scannerContext"]).then(function(t){e.mounted&&e.setState({scannerContext:t.scannerContext})})},t.prototype.render=function(){var e=this.props.task,t=this.state.scannerContext;return o.createElement(h.a,{contentLabel:"scanner context",large:!0,onRequestClose:this.props.onClose},o.createElement("div",{className:"modal-head"},o.createElement("h2",null,Object(g.l)("background_tasks.scanner_context"),": ",e.componentName," [",Object(g.l)("background_task.type",e.type),"]")),o.createElement("div",{className:"modal-body modal-container"},null!=t?o.createElement("pre",{className:"js-task-scanner-context"},t):o.createElement("i",{className:"spinner"})),o.createElement("div",{className:"modal-foot"},o.createElement("a",{href:"#",className:"js-modal-close",onClick:this.handleCloseClick},Object(g.l)("close"))))},t}(o.PureComponent),ge=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),ke=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mounted=!1,t.state={loading:!0},t.handleCloseClick=function(e){e.preventDefault(),t.props.onClose()},t}return ge(t,e),t.prototype.componentDidMount=function(){this.mounted=!0,this.loadStacktrace()},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.loadStacktrace=function(){var e=this;Object(d.e)(this.props.task.id,["stacktrace"]).then(function(t){e.mounted&&e.setState({loading:!1,stacktrace:t.errorStacktrace})},function(){e.mounted&&e.setState({loading:!1})})},t.prototype.render=function(){var e=this.props.task,t=this.state,n=t.loading,a=t.stacktrace;return o.createElement(h.a,{contentLabel:"stacktrace",large:!0,onRequestClose:this.props.onClose},o.createElement("div",{className:"modal-head"},o.createElement("h2",null,Object(g.l)("background_tasks.error_stacktrace"),": ",e.componentName," [",Object(g.l)("background_task.type",e.type),"]")),o.createElement("div",{className:"modal-body modal-container"},n?o.createElement("i",{className:"spinner"}):a?o.createElement("div",null,o.createElement("h4",{className:"spacer-bottom"},Object(g.l)("background_tasks.error_stacktrace")),o.createElement("pre",{className:"js-task-stacktrace"},a)):o.createElement("div",null,o.createElement("h4",{className:"spacer-bottom"},Object(g.l)("background_tasks.error_message")),o.createElement("pre",{className:"js-task-error-message"},e.errorMessage))),o.createElement("div",{className:"modal-foot"},o.createElement("a",{href:"#",className:"js-modal-close",onClick:this.handleCloseClick},Object(g.l)("close"))))},t}(o.PureComponent),Ee=n(31),ye=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),_e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={scannerContextOpen:!1,stacktraceOpen:!1},t.handleFilterClick=function(){t.props.onFilterTask(t.props.task)},t.handleCancelClick=function(){t.props.onCancelTask(t.props.task)},t.handleShowScannerContextClick=function(){t.setState({scannerContextOpen:!0})},t.closeScannerContext=function(){return t.setState({scannerContextOpen:!1})},t.handleShowStacktraceClick=function(){t.setState({stacktraceOpen:!0})},t.closeStacktrace=function(){return t.setState({stacktraceOpen:!1})},t}return ye(t,e),t.prototype.render=function(){var e=this.props,t=e.component,n=e.task,a=void 0===t,r=n.status===m.e.PENDING,s=void 0!==n.errorMessage;return a||r||n.hasScannerContext||s?o.createElement("td",{className:"thin nowrap"},o.createElement(Ee.c,{className:"js-task-action"},a&&n.componentName&&o.createElement(Ee.b,{className:"js-task-filter",onClick:this.handleFilterClick},Object(g.m)("background_tasks.filter_by_component_x",n.componentName)),r&&o.createElement(Ee.b,{className:"js-task-cancel",destructive:!0,onClick:this.handleCancelClick},Object(g.l)("background_tasks.cancel_task")),n.hasScannerContext&&o.createElement(Ee.b,{className:"js-task-show-scanner-context",onClick:this.handleShowScannerContextClick},Object(g.l)("background_tasks.show_scanner_context")),s&&o.createElement(Ee.b,{className:"js-task-show-stacktrace",onClick:this.handleShowStacktraceClick},Object(g.l)("background_tasks.show_stacktrace"))),this.state.scannerContextOpen&&o.createElement(be,{onClose:this.closeScannerContext,task:n}),this.state.stacktraceOpen&&o.createElement(ke,{onClose:this.closeStacktrace,task:n})):o.createElement("td",null," ")},t}(o.PureComponent);function Ce(e){var t=e.task,n=e.component,a=e.onCancelTask,r=e.onFilterTask,s=e.previousTask;return o.createElement("tr",null,o.createElement(Q,{status:t.status}),o.createElement(oe,{task:t}),o.createElement(re,{id:t.id}),o.createElement(ie,{submittedAt:t.submittedAt,prevSubmittedAt:s&&s.submittedAt}),o.createElement(ue,{date:t.submittedAt}),o.createElement(ue,{date:t.startedAt,baseDate:t.submittedAt}),o.createElement(ue,{date:t.executedAt,baseDate:t.submittedAt}),o.createElement(he,{ms:t.executionTimeMs}),o.createElement(_e,{component:n,task:t,onFilterTask:r,onCancelTask:a}))}var Oe=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Oe(t,e),t.prototype.render=function(){var e=this.props,t=e.tasks,n=e.component,a=e.loading,o=e.onCancelTask,s=e.onFilterTask,c=X()("data zebra zebra-hover background-tasks",{"new-loading":a});return r.a.createElement("div",{className:"boxed-group boxed-group-inner"},r.a.createElement("table",{className:c},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,Object(g.l)("background_tasks.table.status")),r.a.createElement("th",null,Object(g.l)("background_tasks.table.task")),r.a.createElement("th",null,Object(g.l)("background_tasks.table.id")),r.a.createElement("th",null," "),r.a.createElement("th",{className:"text-right"},Object(g.l)("background_tasks.table.submitted")),r.a.createElement("th",{className:"text-right"},Object(g.l)("background_tasks.table.started")),r.a.createElement("th",{className:"text-right"},Object(g.l)("background_tasks.table.finished")),r.a.createElement("th",{className:"text-right"},Object(g.l)("background_tasks.table.duration")),r.a.createElement("th",null," "))),r.a.createElement("tbody",null,t.map(function(e,t,a){return r.a.createElement(Ce,{key:e.id,task:e,tasks:a,component:n,onCancelTask:o,onFilterTask:s,previousTask:t>0?a[t-1]:void 0})}))))},t}(r.a.PureComponent),Ne=(n(1132),n(43)),je=n(8),Se=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Ae=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Pe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={loading:!0,tasks:[],query:"",pendingCount:0,failingCount:0},t}return Se(t,e),t.prototype.componentWillMount=function(){this.loadTasksDebounced=Object(u.debounce)(this.loadTasks.bind(this),m.c)},t.prototype.componentDidMount=function(){var e=this;this.mounted=!0,Object(d.g)().then(function(t){e.setState({types:t}),e.loadTasks()})},t.prototype.componentDidUpdate=function(e){e.component===this.props.component&&e.location===this.props.location||this.loadTasksDebounced()},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.loadTasks=function(){var e=this;this.setState({loading:!0});var t=function(e){void 0===e&&(e={});var t={};return e.status===m.e.ALL?t.status=[m.e.PENDING,m.e.IN_PROGRESS,m.e.SUCCESS,m.e.FAILED,m.e.CANCELED].join():e.status===m.e.ALL_EXCEPT_PENDING?t.status=[m.e.IN_PROGRESS,m.e.SUCCESS,m.e.FAILED,m.e.CANCELED].join():t.status=e.status,e.taskType!==m.a&&(t.type=e.taskType),e.currents!==m.b.ALL&&(t.onlyCurrents=!0),e.minSubmittedAt&&(t.minSubmittedAt=Object(ce.h)(e.minSubmittedAt)),e.maxExecutedAt&&(t.maxExecutedAt=Object(ce.h)(e.maxExecutedAt)),e.query&&(t.componentQuery=e.query),1!==e.lastPage&&(t.p=e.lastPage),t}({status:this.props.location.query.status||m.d.status,taskType:this.props.location.query.taskType||m.d.taskType,currents:this.props.location.query.currents||m.d.currents,minSubmittedAt:this.props.location.query.minSubmittedAt||m.d.minSubmittedAt,maxExecutedAt:this.props.location.query.maxExecutedAt||m.d.maxExecutedAt,query:this.props.location.query.query||m.d.query});this.props.component&&(t.componentId=this.props.component.id),Promise.all([Object(d.c)(t),Object(d.d)(t.componentId)]).then(function(t){if(e.mounted){var n=t[0],a=t[1],o=n.tasks,r=a.pending,s=a.failing,c=Object(u.uniq)(o.map(function(e){return e.organization}).filter(function(e){return e}));e.props.fetchOrganizations(c),e.setState({tasks:o,pendingCount:r,failingCount:s,loading:!1})}})},t.prototype.handleFilterUpdate=function(e){var t=Ae({},this.props.location.query,e);Object.keys(m.d).forEach(function(e){t[e]===m.d[e]&&delete t[e]}),t.minSubmittedAt&&(t.minSubmittedAt=Object(ce.h)(t.minSubmittedAt)),t.maxExecutedAt&&(t.maxExecutedAt=Object(ce.h)(t.maxExecutedAt)),this.context.router.push({pathname:this.props.location.pathname,query:t})},t.prototype.handleCancelTask=function(e){var t=this;this.setState({loading:!0}),Object(d.b)(e.id).then(function(e){if(t.mounted){var n=function(e,t){return e.map(function(e){return e.id===t.id?t:e})}(t.state.tasks,e);t.setState({tasks:n,loading:!1})}})},t.prototype.handleFilterTask=function(e){this.handleFilterUpdate({query:e.componentKey})},t.prototype.handleShowFailing=function(){this.handleFilterUpdate(Ae({},m.d,{status:m.e.FAILED,currents:m.b.ONLY_CURRENTS}))},t.prototype.handleCancelAllPending=function(){var e=this;this.setState({loading:!0}),Object(d.a)().then(function(){e.mounted&&e.loadTasks()})},t.prototype.render=function(){var e=this.props.component,t=this.state,n=t.loading,a=t.types,o=t.tasks,s=t.pendingCount,c=t.failingCount;if(!a)return r.a.createElement("div",{className:"page page-limited"},r.a.createElement("i",{className:"spinner"}));var i=this.props.location.query.status||m.d.status,u=this.props.location.query.taskType||m.d.taskType,p=this.props.location.query.currents||m.d.currents,d=Object(je.d)(this.props.location.query.minSubmittedAt),h=Object(je.d)(this.props.location.query.maxExecutedAt),f=this.props.location.query.query||"";return r.a.createElement("div",{className:"page page-limited"},r.a.createElement(l.a,{title:Object(g.l)("background_tasks.page")}),r.a.createElement(P,{component:e}),r.a.createElement(D,{component:e,pendingCount:s,failingCount:c,onShowFailing:this.handleShowFailing.bind(this),onCancelAllPending:this.handleCancelAllPending.bind(this)}),r.a.createElement(J,{loading:n,component:e,status:i,currents:p,minSubmittedAt:d,maxExecutedAt:h,query:f,taskType:u,types:a,onFilterUpdate:this.handleFilterUpdate.bind(this),onReload:this.loadTasksDebounced}),r.a.createElement(ve,{loading:n,component:e,tasks:o,onCancelTask:this.handleCancelTask.bind(this),onFilterTask:this.handleFilterTask.bind(this)}),r.a.createElement(w,{tasks:o}))},t.contextTypes={router:c.a.object.isRequired},t}(r.a.PureComponent),we={fetchOrganizations:Ne.f};t.default=Object(p.connect)(null,we)(Pe)},994:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var a=n(0),o=n(6),r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};function s(e){var t=o("bubble-popup",e.customClass),n=r({},e.position);return a.createElement("div",{className:t,style:n},e.children,a.createElement("div",{className:"bubble-popup-arrow"}))}},996:function(e,t,n){"use strict";var a,o=n(0),r=n(6),s=(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={position:{top:0,right:0}},t.handleKey=function(e){27===e.keyCode&&t.props.togglePopup(!1)},t.handleOutsideClick=function(e){t.popupContainer&&t.popupContainer.contains(e.target)||t.props.togglePopup(!1)},t}return s(t,e),t.prototype.componentDidMount=function(){this.setState({position:this.getPosition(this.props)})},t.prototype.componentWillReceiveProps=function(e){!this.props.isOpen&&e.isOpen?(window.addEventListener("keydown",this.handleKey,!1),window.addEventListener("click",this.handleOutsideClick,!1)):this.props.isOpen&&!e.isOpen&&(window.removeEventListener("keydown",this.handleKey),window.removeEventListener("click",this.handleOutsideClick))},t.prototype.handleClick=function(e){e.stopPropagation()},t.prototype.getPosition=function(e){if(this.container){var t=this.container.getBoundingClientRect(),n=e.position,a=e.offset||{vertical:0,horizontal:0};return"bottomleft"===n?{top:t.height+a.vertical,left:a.horizontal}:{top:t.height+a.vertical,right:a.horizontal}}return{top:0,right:0}},t.prototype.render=function(){var e=this;return o.createElement("div",{className:r(this.props.className,"bubble-popup-helper"),onClick:this.handleClick,ref:function(t){return e.container=t},role:"tooltip",tabIndex:0},this.props.children,this.props.isOpen&&o.createElement("div",{ref:function(t){return e.popupContainer=t}},o.cloneElement(this.props.popup,{popupPosition:this.state.position})))},t}(o.PureComponent);t.a=c}}]);
//# sourceMappingURL=262.45c17ba0.chunk.js.map
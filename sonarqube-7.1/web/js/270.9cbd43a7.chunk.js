(window.webpackJsonp=window.webpackJsonp||[]).push([[270],{1163:function(e,t,n){"use strict";n.r(t);var a,r=n(0),o=n(22),c=n(32),i=n(65),l=n(1),m=n(51),s=n(11),u=(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),p=function(e){function t(t){var n=e.call(this,t)||this;return n.handleSubmit=function(){return n.props.onSubmit({description:n.state.description,domain:n.state.domain,key:n.state.key,name:n.state.name,type:n.state.type}).then(n.props.onClose)},n.handleKeyChange=function(e){n.setState({key:e.currentTarget.value})},n.handleDescriptionChange=function(e){n.setState({description:e.currentTarget.value})},n.handleNameChange=function(e){n.setState({name:e.currentTarget.value})},n.handleDomainChange=function(e){n.setState({domain:e?e.value:void 0})},n.handleTypeChange=function(e){var t=e.value;n.setState({type:t})},n.state={description:t.metric&&t.metric.description||"",domain:t.metric&&t.metric.domain,key:t.metric&&t.metric.key||"",name:t.metric&&t.metric.name||"",type:t.metric&&t.metric.type||"INT"},n}return u(t,e),t.prototype.render=function(){var e=this;return r.createElement(i.a,{header:this.props.header,onClose:this.props.onClose,onSubmit:this.handleSubmit},function(t){var n=t.onCloseClick,a=t.onFormSubmit,o=t.submitting;return r.createElement("form",{onSubmit:a},r.createElement("header",{className:"modal-head"},r.createElement("h2",null,e.props.header)),r.createElement("div",{className:"modal-body"},r.createElement("div",{className:"modal-field"},r.createElement("label",{htmlFor:"create-metric-key"},Object(l.l)("key"),r.createElement("em",{className:"mandatory"},"*")),r.createElement("input",{autoFocus:!0,id:"create-metric-key",maxLength:64,name:"key",onChange:e.handleKeyChange,required:!0,type:"text",value:e.state.key})),r.createElement("div",{className:"modal-field"},r.createElement("label",{htmlFor:"create-metric-name"},Object(l.l)("name"),r.createElement("em",{className:"mandatory"},"*")),r.createElement("input",{id:"create-metric-name",maxLength:64,name:"name",onChange:e.handleNameChange,required:!0,type:"text",value:e.state.name})),r.createElement("div",{className:"modal-field"},r.createElement("label",{htmlFor:"create-metric-description"},Object(l.l)("description")),r.createElement("textarea",{id:"create-metric-description",name:"description",onChange:e.handleDescriptionChange,value:e.state.description})),r.createElement("div",{className:"modal-field"},r.createElement("label",{htmlFor:"create-metric-domain"},Object(l.l)("custom_metrics.domain")),r.createElement(m.b,{onChange:e.handleDomainChange,options:e.props.domains.map(function(e){return{label:e,value:e}}),value:e.state.domain})),r.createElement("div",{className:"modal-field"},r.createElement("label",{htmlFor:"create-metric-type"},Object(l.l)("type"),r.createElement("em",{className:"mandatory"},"*")),r.createElement(m.c,{clearable:!1,onChange:e.handleTypeChange,options:e.props.types.map(function(e){return{label:Object(l.l)("metric.type",e),value:e}}),value:e.state.type}))),r.createElement("footer",{className:"modal-foot"},r.createElement(c.a,{className:"spacer-right",loading:o}),r.createElement(s.f,{disabled:o,id:"create-metric-submit"},e.props.confirmButtonText),r.createElement(s.e,{disabled:o,id:"create-metric-cancel",onClick:n},Object(l.l)("cancel"))))})},t}(r.PureComponent),d=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mounted=!1,t.state={modal:!1},t.handleClick=function(){t.setState({modal:!0})},t.handleClose=function(){t.mounted&&t.setState({modal:!1})},t}return d(t,e),t.prototype.componentDidMount=function(){this.mounted=!0},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){return r.createElement(r.Fragment,null,r.createElement(s.a,{id:"metrics-create",onClick:this.handleClick},Object(l.l)("custom_metrics.create_metric")),this.state.modal&&r.createElement(p,{confirmButtonText:Object(l.l)("create"),domains:this.props.domains,header:Object(l.l)("custom_metrics.create_metric"),onClose:this.handleClose,onSubmit:this.props.onCreate,types:this.props.types}))},t}(r.PureComponent);function f(e){var t=e.domains,n=e.loading,a=e.onCreate,o=e.types;return r.createElement("header",{className:"page-header",id:"custom-metrics-header"},r.createElement("h1",{className:"page-title"},Object(l.l)("custom_metrics.page")),r.createElement(c.a,{loading:n}),r.createElement("div",{className:"page-actions"},t&&o&&r.createElement(h,{domains:t,onCreate:a,types:o})),r.createElement("p",{className:"page-description"},Object(l.l)("custom_metrics.page.description")))}var y=n(4),g=n(79),b=n(31);function E(e){var t=e.metric,n=e.onDelete;return r.createElement(g.a,{confirmButtonText:Object(l.l)("delete"),confirmData:t.key,isDestructive:!0,modalBody:Object(l.m)("custom_metrics.delete_metric.confirmation",t.name),modalHeader:Object(l.l)("custom_metrics.delete_metric"),onConfirm:n},function(e){var t=e.onClick;return r.createElement(b.b,{className:"js-metric-delete",destructive:!0,onClick:t},Object(l.l)("delete"))})}var v=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),O=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},j=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mounted=!1,t.state={modal:!1},t.handleClick=function(){t.setState({modal:!0})},t.handleClose=function(){t.mounted&&t.setState({modal:!1})},t.handleSubmit=function(e){return t.props.onEdit(O({id:t.props.metric.id},e))},t}return v(t,e),t.prototype.componentDidMount=function(){this.mounted=!0},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){return r.createElement(r.Fragment,null,r.createElement(b.b,{className:"js-metric-update",onClick:this.handleClick},Object(l.l)("update_details")),this.state.modal&&r.createElement(p,{confirmButtonText:Object(l.l)("update_verb"),domains:this.props.domains,header:Object(l.l)("custom_metrics.update_metric"),metric:this.props.metric,onClose:this.handleClose,onSubmit:this.handleSubmit,types:this.props.types}))},t}(r.PureComponent);function C(e){var t=e.domains,n=e.metrics,a=e.onDelete,o=e.onEdit,c=e.types;return r.createElement("div",{className:"boxed-group boxed-group-inner",id:"custom-metrics-list"},n.length>0?r.createElement("table",{className:"data zebra zebra-hover"},r.createElement("tbody",null,Object(y.sortBy)(n,function(e){return e.name.toLowerCase()}).map(function(e){return r.createElement("tr",{"data-metric":e.key,key:e.key},r.createElement("td",{className:"width-30"},r.createElement("div",null,r.createElement("strong",{className:"js-metric-name"},e.name),r.createElement("span",{className:"js-metric-key note little-spacer-left"},e.key))),r.createElement("td",{className:"width-20"},r.createElement("span",{className:"js-metric-domain"},e.domain)),r.createElement("td",{className:"width-20"},r.createElement("span",{className:"js-metric-type"},Object(l.l)("metric.type",e.type))),r.createElement("td",{className:"width-20",title:e.description},r.createElement("span",{className:"js-metric-description"},e.description)),r.createElement("td",{className:"thin nowrap"},r.createElement(b.c,null,t&&c&&r.createElement(j,{domains:t,metric:e,onEdit:o,types:c}),r.createElement(b.a,null),r.createElement(E,{metric:e,onDelete:a}))))}))):r.createElement("p",null,Object(l.l)("no_results")))}var _=n(256),N=n(78),k=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),S=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},w=50,P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mounted=!1,t.state={loading:!0},t.fetchData=function(){Promise.all([Object(_.d)(),Object(_.e)(),Object(_.f)({isCustom:!0,ps:w})]).then(function(e){var n=e[0],a=e[1],r=e[2];t.mounted&&t.setState({domains:n,loading:!1,metrics:r.metrics,paging:t.getPaging(r),types:a})},t.stopLoading)},t.fetchMore=function(){var e=t.state.paging;e&&(t.setState({loading:!0}),Object(_.f)({isCustom:!0,p:e.pageIndex+1,ps:w}).then(function(e){t.mounted&&t.setState(function(n){var a=n.metrics;return{loading:!1,metrics:(void 0===a?[]:a).concat(e.metrics),paging:t.getPaging(e)}})},t.stopLoading))},t.stopLoading=function(){t.mounted&&t.setState({loading:!1})},t.getPaging=function(e){return{pageIndex:e.p,pageSize:e.ps,total:e.total}},t.handleCreate=function(e){return Object(_.a)(e).then(function(e){t.mounted&&t.setState(function(t){var n=t.metrics,a=void 0===n?[]:n,r=t.paging;return{metrics:a.concat([e]),paging:r&&S({},r,{total:r.total+1})}})})},t.handleEdit=function(e){return Object(_.g)(e).then(function(){t.mounted&&t.setState(function(t){var n=t.metrics;return{metrics:(void 0===n?[]:n).map(function(t){return t.id===e.id?S({},t,e):t})}})})},t.handleDelete=function(e){return Object(_.b)({keys:e}).then(function(){t.mounted&&t.setState(function(t){var n=t.metrics,a=void 0===n?[]:n,r=t.paging;return{metrics:a.filter(function(t){return t.key!==e}),paging:r&&S({},r,{total:r.total-1})}})})},t}return k(t,e),t.prototype.componentDidMount=function(){this.mounted=!0,this.fetchData()},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){var e=this.state,t=e.domains,n=e.loading,a=e.metrics,c=e.paging,i=e.types;return r.createElement(r.Fragment,null,r.createElement(o.Helmet,{title:Object(l.l)("custom_metrics.page")}),r.createElement("div",{className:"page page-limited",id:"custom-metrics-page"},r.createElement(f,{domains:t,loading:n,onCreate:this.handleCreate,types:i}),a&&r.createElement(C,{domains:t,metrics:a,onDelete:this.handleDelete,onEdit:this.handleEdit,types:i}),a&&c&&r.createElement(N.a,{count:a.length,loadMore:this.fetchMore,ready:!n,total:c.total})))},t}(r.PureComponent);t.default=P}}]);
//# sourceMappingURL=270.9cbd43a7.chunk.js.map
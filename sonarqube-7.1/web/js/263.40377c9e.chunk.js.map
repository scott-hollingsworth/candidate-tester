{"version":3,"sources":["webpack:///./src/main/js/apps/code/components/Truncated.tsx","webpack:///./src/main/js/apps/code/components/ComponentName.tsx","webpack:///./src/main/js/apps/code/components/ComponentMeasure.tsx","webpack:///./src/main/js/apps/code/components/ComponentLink.tsx","webpack:///./src/main/js/components/shared/pin-icon.js","webpack:///./src/main/js/apps/code/components/ComponentPin.tsx","webpack:///./src/main/js/apps/code/components/Component.tsx","webpack:///./src/main/js/apps/code/components/ComponentsEmpty.tsx","webpack:///./src/main/js/apps/code/components/ComponentsHeader.tsx","webpack:///./src/main/js/apps/code/components/Components.tsx","webpack:///./src/main/js/apps/code/components/Breadcrumbs.tsx","webpack:///./src/main/js/apps/code/components/Search.tsx","webpack:///./src/main/js/apps/code/bucket.ts","webpack:///./src/main/js/apps/code/utils.ts","webpack:///./src/main/js/apps/code/components/App.tsx"],"names":["Truncated_Truncated","_a","children","title","index_js_exposed","className","ComponentName_ComponentName","props","branchLike","component","rootComponent","previous","canBrowse","prefix","qualifier","undefined","strings","sortedStrings","slice","sort","firstString","firstStringLength","length","lastString","i","charAt","substr","prefixTokens","split","lastPrefixPart","ComponentName_mostCommitPrefix","name","style","color","theme","inner","refKey","es","to","pathname","query","id","QualifierIcon","ComponentName_assign","key","Object","branches","assign","selected","path","ComponentName_getTooltip","ComponentMeasure_ComponentMeasure","metricKey","metricType","isProject","isReleasability","finalMetricKey","finalMetricType","measure","Array","isArray","measures","find","metric","Measure","value","ComponentLink_ComponentLink","l10n","urls","LinkIcon","pin_icon_PinIcon","index_js_exposed_default","a","createElement","width","height","viewBox","fill","d","_super","ComponentPin","_this","apply","this","arguments","handleClick","event","preventDefault","currentTarget","blur","context","workspace","openComponent","ComponentPin_extends","prototype","render","href","onClick","contextTypes","prop_types","isRequired","Component","Component_extends","componentDidMount","handleUpdate","componentDidUpdate","setTimeout","handleScroll","node","position","getBoundingClientRect","top","bottom","window","innerHeight","scrollTo","pageYOffset","_b","_c","isPortfolio","includes","isApplication","componentAction","components_ComponentPin","columns","type","filter","Boolean","classnames","ref","map","column","ComponentsEmpty_ComponentsEmpty","colSpan","ComponentsHeader_ComponentsHeader","baseComponent","Components_Components","components","components_Component","index","list","Breadcrumbs_Breadcrumbs","breadcrumbs","Search","mounted","state","loading","handleKeyDown","keyCode","handleSelectCurrent","handleSelectPrevious","handleSelectNext","handleSearch","onError_1","onError","setState","qualifiers","api_components","Search_assign","q","s","then","r","results","selectedIndex","catch","e","request","handleQueryChange","Search_extends","componentWillReceiveProps","nextProps","location","componentWillUnmount","router","push","containerClassName","code-search-with-results","SearchBox","minLength","onChange","onKeyDown","placeholder","bucket","childrenBucket","breadcrumbsBucket","addComponent","addComponentChildren","componentKey","total","page","getComponentChildren","concat","addComponentBreadcrumbs","getComponentBreadcrumbs","utils_METRICS","utils_PORTFOLIO_METRICS","utils_PAGE_SIZE","utils_requestAllChildren","metrics","utils_requestChildren","utils_assign","p","ps","paging","pageSize","pageIndex","moreComponents","utils_expandRootDir","other","utils_rest","rootDir","rootDirComponents","nextComponents","lodash_js_exposed","nextTotal","Promise","resolve","utils_prepareChildren","utils_skipRootDir","utils_storeChildrenBase","forEach","utils_storeChildrenBreadcrumbs","parentComponentKey","parentBreadcrumbs","child","utils_getMetrics","utils_retrieveComponentBase","existing","getComponent","metricKeys","join","utils_retrieveComponentChildren","utils_retrieveComponent","all","utils_retrieveComponentBreadcrumbs","App_App","App","handleLoadMore","utils_loadMoreChildren","handleError","error","App_extends","handleComponentChange","prevProps","loadComponent","sourceViewer","searchResults","finalKey","shouldShowBreadcrumbs","componentsClassName","new-loading","Helmet_default","components_Search","ListFooter","count","loadMore","SourceViewer"],"mappings":"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","file":"js/263.40377c9e.chunk.js","sourcesContent":["/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\n\ninterface Props {\n  children: React.ReactNode;\n  title: string;\n}\n\nexport default function Truncated({ children, title }: Props) {\n  return (\n    <span className=\"code-truncated\" title={title}>\n      {children}\n    </span>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport Truncated from './Truncated';\nimport { Component } from '../types';\nimport * as theme from '../../../app/theme';\nimport { BranchLike } from '../../../app/types';\nimport QualifierIcon from '../../../components/shared/QualifierIcon';\nimport { getBranchLikeQuery } from '../../../helpers/branches';\n\nfunction getTooltip(component: Component) {\n  const isFile = component.qualifier === 'FIL' || component.qualifier === 'UTS';\n  if (isFile && component.path) {\n    return component.path + '\\n\\n' + component.key;\n  } else {\n    return component.name + '\\n\\n' + component.key;\n  }\n}\n\nfunction mostCommitPrefix(strings: string[]) {\n  const sortedStrings = strings.slice(0).sort();\n  const firstString = sortedStrings[0];\n  const firstStringLength = firstString.length;\n  const lastString = sortedStrings[sortedStrings.length - 1];\n  let i = 0;\n  while (i < firstStringLength && firstString.charAt(i) === lastString.charAt(i)) {\n    i++;\n  }\n  const prefix = firstString.substr(0, i);\n  const prefixTokens = prefix.split(/[\\s\\\\/]/);\n  const lastPrefixPart = prefixTokens[prefixTokens.length - 1];\n  return prefix.substr(0, prefix.length - lastPrefixPart.length);\n}\n\ninterface Props {\n  branchLike?: BranchLike;\n  canBrowse?: boolean;\n  component: Component;\n  previous?: Component;\n  rootComponent: Component;\n}\n\nexport default function ComponentName(props: Props) {\n  const { branchLike, component, rootComponent, previous, canBrowse = false } = props;\n  const areBothDirs = component.qualifier === 'DIR' && previous && previous.qualifier === 'DIR';\n  const prefix =\n    areBothDirs && previous !== undefined\n      ? mostCommitPrefix([component.name + '/', previous.name + '/'])\n      : '';\n  const name = prefix ? (\n    <span>\n      <span style={{ color: theme.secondFontColor }}>{prefix}</span>\n      <span>{component.name.substr(prefix.length)}</span>\n    </span>\n  ) : (\n    component.name\n  );\n\n  let inner = null;\n\n  if (component.refKey && component.qualifier !== 'SVW') {\n    inner = (\n      <Link\n        to={{ pathname: '/dashboard', query: { id: component.refKey } }}\n        className=\"link-with-icon\">\n        <QualifierIcon qualifier={component.qualifier} /> <span>{name}</span>\n      </Link>\n    );\n  } else if (canBrowse) {\n    const query = { id: rootComponent.key, ...getBranchLikeQuery(branchLike) };\n    if (component.key !== rootComponent.key) {\n      Object.assign(query, { selected: component.key });\n    }\n    inner = (\n      <Link to={{ pathname: '/code', query }} className=\"link-with-icon\">\n        <QualifierIcon qualifier={component.qualifier} /> <span>{name}</span>\n      </Link>\n    );\n  } else {\n    inner = (\n      <span>\n        <QualifierIcon qualifier={component.qualifier} /> {name}\n      </span>\n    );\n  }\n\n  return <Truncated title={getTooltip(component)}>{inner}</Truncated>;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Measure from '../../../components/measure/Measure';\nimport { Component } from '../types';\n\ninterface Props {\n  component: Component;\n  metricKey: string;\n  metricType: string;\n}\n\nexport default function ComponentMeasure({ component, metricKey, metricType }: Props) {\n  const isProject = component.qualifier === 'TRK';\n  const isReleasability = metricKey === 'releasability_rating';\n\n  const finalMetricKey = isProject && isReleasability ? 'alert_status' : metricKey;\n  const finalMetricType = isProject && isReleasability ? 'LEVEL' : metricType;\n\n  const measure =\n    Array.isArray(component.measures) &&\n    component.measures.find(measure => measure.metric === finalMetricKey);\n\n  if (!measure) {\n    return <span />;\n  }\n\n  return <Measure value={measure.value} metricKey={finalMetricKey} metricType={finalMetricType} />;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport { Component } from '../types';\nimport { BranchLike } from '../../../app/types';\nimport LinkIcon from '../../../components/icons-components/LinkIcon';\nimport { translate } from '../../../helpers/l10n';\nimport { getBranchLikeUrl } from '../../../helpers/urls';\n\ninterface Props {\n  branchLike?: BranchLike;\n  component: Component;\n}\n\nexport default function ComponentLink({ component, branchLike }: Props) {\n  return (\n    <Link\n      className=\"link-no-underline\"\n      title={translate('code.open_component_page')}\n      to={getBranchLikeUrl(component.refKey || component.key, branchLike)}>\n      <LinkIcon />\n    </Link>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n/* eslint max-len: 0 */\nimport React from 'react';\nimport * as theme from '../../app/theme';\n\nexport default function PinIcon() {\n  return (\n    <svg width=\"9\" height=\"14\" viewBox=\"0 0 288 448\">\n      <path\n        fill={theme.darkBlue}\n        d=\"M120 216v-112q0-3.5-2.25-5.75t-5.75-2.25-5.75 2.25-2.25 5.75v112q0 3.5 2.25 5.75t5.75 2.25 5.75-2.25 2.25-5.75zM288 304q0 6.5-4.75 11.25t-11.25 4.75h-107.25l-12.75 120.75q-0.5 3-2.625 5.125t-5.125 2.125h-0.25q-6.75 0-8-6.75l-19-121.25h-101q-6.5 0-11.25-4.75t-4.75-11.25q0-30.75 19.625-55.375t44.375-24.625v-128q-13 0-22.5-9.5t-9.5-22.5 9.5-22.5 22.5-9.5h160q13 0 22.5 9.5t9.5 22.5-9.5 22.5-22.5 9.5v128q24.75 0 44.375 24.625t19.625 55.375z\"\n      />\n    </svg>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as PropTypes from 'prop-types';\nimport { Component } from '../types';\nimport { BranchLike } from '../../../app/types';\nimport PinIcon from '../../../components/shared/pin-icon';\nimport { WorkspaceContext } from '../../../components/workspace/context';\nimport { translate } from '../../../helpers/l10n';\n\ninterface Props {\n  branchLike?: BranchLike;\n  component: Component;\n}\n\nexport default class ComponentPin extends React.PureComponent<Props> {\n  context!: { workspace: WorkspaceContext };\n\n  static contextTypes = {\n    workspace: PropTypes.object.isRequired\n  };\n\n  handleClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    this.context.workspace.openComponent({\n      branchLike: this.props.branchLike,\n      key: this.props.component.key,\n      name: this.props.component.path,\n      qualifier: this.props.component.qualifier\n    });\n  };\n\n  render() {\n    return (\n      <a\n        className=\"link-no-underline\"\n        href=\"#\"\n        onClick={this.handleClick}\n        title={translate('component_viewer.open_in_workspace')}>\n        <PinIcon />\n      </a>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport ComponentName from './ComponentName';\nimport ComponentMeasure from './ComponentMeasure';\nimport ComponentLink from './ComponentLink';\nimport ComponentPin from './ComponentPin';\nimport { Component as IComponent } from '../types';\nimport { BranchLike } from '../../../app/types';\n\nconst TOP_OFFSET = 200;\nconst BOTTOM_OFFSET = 10;\n\ninterface Props {\n  branchLike?: BranchLike;\n  canBrowse?: boolean;\n  component: IComponent;\n  previous?: IComponent;\n  rootComponent: IComponent;\n  selected?: boolean;\n}\n\nexport default class Component extends React.PureComponent<Props> {\n  node?: HTMLElement | null;\n\n  componentDidMount() {\n    this.handleUpdate();\n  }\n\n  componentDidUpdate() {\n    this.handleUpdate();\n  }\n\n  handleUpdate() {\n    const { selected } = this.props;\n\n    // scroll viewport so the current selected component is visible\n    if (selected) {\n      setTimeout(() => {\n        this.handleScroll();\n      }, 0);\n    }\n  }\n\n  handleScroll() {\n    if (this.node) {\n      const position = this.node.getBoundingClientRect();\n      const { top, bottom } = position;\n      if (bottom > window.innerHeight - BOTTOM_OFFSET) {\n        window.scrollTo(0, bottom - window.innerHeight + window.pageYOffset + BOTTOM_OFFSET);\n      } else if (top < TOP_OFFSET) {\n        window.scrollTo(0, top + window.pageYOffset - TOP_OFFSET);\n      }\n    }\n  }\n\n  render() {\n    const {\n      branchLike,\n      component,\n      rootComponent,\n      selected = false,\n      previous,\n      canBrowse = false\n    } = this.props;\n    const isPortfolio = ['VW', 'SVW'].includes(rootComponent.qualifier);\n    const isApplication = rootComponent.qualifier === 'APP';\n\n    let componentAction = null;\n\n    if (!component.refKey || component.qualifier === 'SVW') {\n      switch (component.qualifier) {\n        case 'FIL':\n        case 'UTS':\n          componentAction = <ComponentPin branchLike={branchLike} component={component} />;\n          break;\n        default:\n          componentAction = <ComponentLink branchLike={branchLike} component={component} />;\n      }\n    }\n\n    const columns = isPortfolio\n      ? [\n          { metric: 'releasability_rating', type: 'RATING' },\n          { metric: 'reliability_rating', type: 'RATING' },\n          { metric: 'security_rating', type: 'RATING' },\n          { metric: 'sqale_rating', type: 'RATING' },\n          { metric: 'ncloc', type: 'SHORT_INT' }\n        ]\n      : ([\n          isApplication && { metric: 'alert_status', type: 'LEVEL' },\n          { metric: 'ncloc', type: 'SHORT_INT' },\n          { metric: 'bugs', type: 'SHORT_INT' },\n          { metric: 'vulnerabilities', type: 'SHORT_INT' },\n          { metric: 'code_smells', type: 'SHORT_INT' },\n          { metric: 'coverage', type: 'PERCENT' },\n          { metric: 'duplicated_lines_density', type: 'PERCENT' }\n        ].filter(Boolean) as Array<{ metric: string; type: string }>);\n\n    return (\n      <tr className={classNames({ selected })} ref={node => (this.node = node)}>\n        <td className=\"thin nowrap\">\n          <span className=\"spacer-right\">{componentAction}</span>\n        </td>\n        <td className=\"code-name-cell\">\n          <ComponentName\n            branchLike={branchLike}\n            component={component}\n            rootComponent={rootComponent}\n            previous={previous}\n            canBrowse={canBrowse}\n          />\n        </td>\n\n        {columns.map(column => (\n          <td key={column.metric} className=\"thin nowrap text-right\">\n            <div className=\"code-components-cell\">\n              <ComponentMeasure\n                component={component}\n                metricKey={column.metric}\n                metricType={column.type}\n              />\n            </div>\n          </td>\n        ))}\n      </tr>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { translate } from '../../../helpers/l10n';\n\nexport default function ComponentsEmpty() {\n  return (\n    <tr>\n      <td colSpan={2}>{translate('no_results')}</td>\n      <td colSpan={6} />\n    </tr>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { translate } from '../../../helpers/l10n';\nimport { Component } from '../types';\n\ninterface Props {\n  baseComponent?: Component;\n  rootComponent: Component;\n}\n\nexport default function ComponentsHeader({ baseComponent, rootComponent }: Props) {\n  const isPortfolio = rootComponent.qualifier === 'VW' || rootComponent.qualifier === 'SVW';\n  const isApplication = rootComponent.qualifier === 'APP';\n\n  const columns = isPortfolio\n    ? [\n        translate('metric_domain.Releasability'),\n        translate('metric_domain.Reliability'),\n        translate('metric_domain.Security'),\n        translate('metric_domain.Maintainability'),\n        translate('metric', 'ncloc', 'name')\n      ]\n    : ([\n        isApplication && translate('metric.alert_status.name'),\n        translate('metric', 'ncloc', 'name'),\n        translate('metric', 'bugs', 'name'),\n        translate('metric', 'vulnerabilities', 'name'),\n        translate('metric', 'code_smells', 'name'),\n        translate('metric', 'coverage', 'name'),\n        translate('metric', 'duplicated_lines_density', 'short_name')\n      ].filter(Boolean) as string[]);\n\n  return (\n    <thead>\n      <tr className=\"code-components-header\">\n        <th className=\"thin nowrap\">&nbsp;</th>\n        <th>&nbsp;</th>\n        {columns.map(column => (\n          <th key={column} className=\"thin nowrap text-right code-components-cell\">\n            {baseComponent && column}\n          </th>\n        ))}\n      </tr>\n    </thead>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Component from './Component';\nimport ComponentsEmpty from './ComponentsEmpty';\nimport ComponentsHeader from './ComponentsHeader';\nimport { Component as IComponent } from '../types';\nimport { BranchLike } from '../../../app/types';\n\ninterface Props {\n  baseComponent?: IComponent;\n  branchLike?: BranchLike;\n  components: IComponent[];\n  rootComponent: IComponent;\n  selected?: IComponent;\n}\n\nexport default function Components(props: Props) {\n  const { baseComponent, branchLike, components, rootComponent, selected } = props;\n  return (\n    <table className=\"data zebra\">\n      <ComponentsHeader baseComponent={baseComponent} rootComponent={rootComponent} />\n      {baseComponent && (\n        <tbody>\n          <Component\n            branchLike={branchLike}\n            component={baseComponent}\n            key={baseComponent.key}\n            rootComponent={rootComponent}\n          />\n          <tr className=\"blank\">\n            <td colSpan={8}>&nbsp;</td>\n          </tr>\n        </tbody>\n      )}\n      <tbody>\n        {components.length ? (\n          components.map((component, index, list) => (\n            <Component\n              branchLike={branchLike}\n              canBrowse={true}\n              component={component}\n              key={component.key}\n              previous={index > 0 ? list[index - 1] : undefined}\n              rootComponent={rootComponent}\n              selected={component === selected}\n            />\n          ))\n        ) : (\n          <ComponentsEmpty />\n        )}\n      </tbody>\n    </table>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport ComponentName from './ComponentName';\nimport { Component } from '../types';\nimport { BranchLike } from '../../../app/types';\n\ninterface Props {\n  branchLike?: BranchLike;\n  breadcrumbs: Component[];\n  rootComponent: Component;\n}\n\nexport default function Breadcrumbs({ branchLike, breadcrumbs, rootComponent }: Props) {\n  return (\n    <ul className=\"code-breadcrumbs\">\n      {breadcrumbs.map((component, index) => (\n        <li key={component.key}>\n          <ComponentName\n            branchLike={branchLike}\n            canBrowse={index < breadcrumbs.length - 1}\n            component={component}\n            rootComponent={rootComponent}\n          />\n        </li>\n      ))}\n    </ul>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as PropTypes from 'prop-types';\nimport * as classNames from 'classnames';\nimport Components from './Components';\nimport { Component } from '../types';\nimport { getTree } from '../../../api/components';\nimport { BranchLike } from '../../../app/types';\nimport SearchBox from '../../../components/controls/SearchBox';\nimport { getBranchLikeQuery } from '../../../helpers/branches';\nimport { translate } from '../../../helpers/l10n';\nimport { parseError } from '../../../helpers/request';\nimport { getProjectUrl } from '../../../helpers/urls';\n\ninterface Props {\n  branchLike?: BranchLike;\n  component: Component;\n  location: {};\n  onError: (error: string) => void;\n}\n\ninterface State {\n  query: string;\n  loading: boolean;\n  results?: Component[];\n  selectedIndex?: number;\n}\n\nexport default class Search extends React.PureComponent<Props, State> {\n  mounted = false;\n\n  static contextTypes = {\n    router: PropTypes.object.isRequired\n  };\n\n  state: State = {\n    query: '',\n    loading: false\n  };\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillReceiveProps(nextProps: Props) {\n    // if the url has change, reset the current state\n    if (nextProps.location !== this.props.location) {\n      this.setState({\n        query: '',\n        loading: false,\n        results: undefined,\n        selectedIndex: undefined\n      });\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  handleSelectNext() {\n    const { selectedIndex, results } = this.state;\n    if (results != null && selectedIndex != null && selectedIndex < results.length - 1) {\n      this.setState({ selectedIndex: selectedIndex + 1 });\n    }\n  }\n\n  handleSelectPrevious() {\n    const { selectedIndex, results } = this.state;\n    if (results != null && selectedIndex != null && selectedIndex > 0) {\n      this.setState({ selectedIndex: selectedIndex - 1 });\n    }\n  }\n\n  handleSelectCurrent() {\n    const { branchLike, component } = this.props;\n    const { results, selectedIndex } = this.state;\n    if (results != null && selectedIndex != null) {\n      const selected = results[selectedIndex];\n\n      if (selected.refKey) {\n        this.context.router.push(getProjectUrl(selected.refKey));\n      } else {\n        this.context.router.push({\n          pathname: '/code',\n          query: { id: component.key, selected: selected.key, ...getBranchLikeQuery(branchLike) }\n        });\n      }\n    }\n  }\n\n  handleKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    switch (event.keyCode) {\n      case 13:\n        event.preventDefault();\n        this.handleSelectCurrent();\n        break;\n      case 38:\n        event.preventDefault();\n        this.handleSelectPrevious();\n        break;\n      case 40:\n        event.preventDefault();\n        this.handleSelectNext();\n        break;\n      default: // do nothing\n    }\n  };\n\n  handleSearch = (query: string) => {\n    if (this.mounted) {\n      const { branchLike, component, onError } = this.props;\n      this.setState({ loading: true });\n\n      const isPortfolio = ['VW', 'SVW', 'APP'].includes(component.qualifier);\n      const qualifiers = isPortfolio ? 'SVW,TRK' : 'BRC,UTS,FIL';\n\n      getTree(component.key, {\n        q: query,\n        s: 'qualifier,name',\n        qualifiers,\n        ...getBranchLikeQuery(branchLike)\n      })\n        .then(r => {\n          if (this.mounted) {\n            this.setState({\n              results: r.components,\n              selectedIndex: r.components.length > 0 ? 0 : undefined,\n              loading: false\n            });\n          }\n        })\n        .catch(e => {\n          if (this.mounted) {\n            this.setState({ loading: false });\n            parseError(e).then(onError);\n          }\n        });\n    }\n  };\n\n  handleQueryChange = (query: string) => {\n    this.setState({ query });\n    if (query.length === 0) {\n      this.setState({ results: undefined });\n    } else {\n      this.handleSearch(query);\n    }\n  };\n\n  render() {\n    const { component } = this.props;\n    const { loading, selectedIndex, results } = this.state;\n    const selected = selectedIndex != null && results != null ? results[selectedIndex] : undefined;\n    const containerClassName = classNames('code-search', {\n      'code-search-with-results': results != null\n    });\n    const isPortfolio = ['VW', 'SVW', 'APP'].includes(component.qualifier);\n\n    return (\n      <div id=\"code-search\" className={containerClassName}>\n        <SearchBox\n          minLength={3}\n          onChange={this.handleQueryChange}\n          onKeyDown={this.handleKeyDown}\n          placeholder={translate(\n            isPortfolio ? 'code.search_placeholder.portfolio' : 'code.search_placeholder'\n          )}\n          value={this.state.query}\n        />\n        {loading && <i className=\"spinner spacer-left\" />}\n\n        {results != null && (\n          <div className=\"boxed-group boxed-group-inner spacer-top\">\n            <Components\n              branchLike={this.props.branchLike}\n              components={results}\n              rootComponent={component}\n              selected={selected}\n            />\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { Breadcrumb, Component } from './types';\n\nlet bucket: { [key: string]: Component } = {};\nlet childrenBucket: {\n  [key: string]: {\n    children: Component[];\n    page: number;\n    total: number;\n  };\n} = {};\nlet breadcrumbsBucket: { [key: string]: Breadcrumb[] } = {};\n\nexport function addComponent(component: Component): void {\n  bucket[component.key] = component;\n}\n\nexport function getComponent(componentKey: string): Component {\n  return bucket[componentKey];\n}\n\nexport function addComponentChildren(\n  componentKey: string,\n  children: Component[],\n  total: number,\n  page: number\n): void {\n  const previous = getComponentChildren(componentKey);\n  if (previous) {\n    children = [...previous.children, ...children];\n  }\n  childrenBucket[componentKey] = { children, total, page };\n}\n\nexport function getComponentChildren(\n  componentKey: string\n): {\n  children: Component[];\n  page: number;\n  total: number;\n} {\n  return childrenBucket[componentKey];\n}\n\nexport function addComponentBreadcrumbs(componentKey: string, breadcrumbs: Breadcrumb[]): void {\n  breadcrumbsBucket[componentKey] = breadcrumbs;\n}\n\nexport function getComponentBreadcrumbs(componentKey: string): Breadcrumb[] {\n  return breadcrumbsBucket[componentKey];\n}\n\nexport function clearBucket(): void {\n  bucket = {};\n  childrenBucket = {};\n  breadcrumbsBucket = {};\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { without } from 'lodash';\nimport {\n  addComponent,\n  getComponent as getComponentFromBucket,\n  addComponentChildren,\n  getComponentChildren,\n  addComponentBreadcrumbs,\n  getComponentBreadcrumbs\n} from './bucket';\nimport { Breadcrumb, Component } from './types';\nimport { getChildren, getComponent, getBreadcrumbs } from '../../api/components';\nimport { BranchLike } from '../../app/types';\nimport { getBranchLikeQuery } from '../../helpers/branches';\n\nconst METRICS = [\n  'ncloc',\n  'code_smells',\n  'bugs',\n  'vulnerabilities',\n  'coverage',\n  'duplicated_lines_density',\n  'alert_status'\n];\n\nconst PORTFOLIO_METRICS = [\n  'releasability_rating',\n  'alert_status',\n  'reliability_rating',\n  'security_rating',\n  'sqale_rating',\n  'ncloc'\n];\n\nconst PAGE_SIZE = 100;\n\nfunction requestChildren(\n  componentKey: string,\n  metrics: string[],\n  page: number,\n  branchLike?: BranchLike\n): Promise<Component[]> {\n  return getChildren(componentKey, metrics, {\n    p: page,\n    ps: PAGE_SIZE,\n    ...getBranchLikeQuery(branchLike)\n  }).then(r => {\n    if (r.paging.total > r.paging.pageSize * r.paging.pageIndex) {\n      return requestChildren(componentKey, metrics, page + 1, branchLike).then(moreComponents => {\n        return [...r.components, ...moreComponents];\n      });\n    }\n    return r.components;\n  });\n}\n\nfunction requestAllChildren(\n  componentKey: string,\n  metrics: string[],\n  branchLike?: BranchLike\n): Promise<Component[]> {\n  return requestChildren(componentKey, metrics, 1, branchLike);\n}\n\ninterface Children {\n  components: Component[];\n  page: number;\n  total: number;\n}\n\ninterface ExpandRootDirFunc {\n  (children: Children): Promise<Children>;\n}\n\nfunction expandRootDir(metrics: string[], branchLike?: BranchLike): ExpandRootDirFunc {\n  return function({ components, total, ...other }) {\n    const rootDir = components.find(\n      (component: Component) => component.qualifier === 'DIR' && component.name === '/'\n    );\n    if (rootDir) {\n      return requestAllChildren(rootDir.key, metrics, branchLike).then(rootDirComponents => {\n        const nextComponents = without([...rootDirComponents, ...components], rootDir);\n        const nextTotal = total + rootDirComponents.length - /* root dir */ 1;\n        return { components: nextComponents, total: nextTotal, ...other };\n      });\n    } else {\n      return Promise.resolve({ components, total, ...other });\n    }\n  };\n}\n\nfunction prepareChildren(r: any): Children {\n  return {\n    components: r.components,\n    total: r.paging.total,\n    page: r.paging.pageIndex\n  };\n}\n\nfunction skipRootDir(breadcrumbs: Component[]) {\n  return breadcrumbs.filter(component => {\n    return !(component.qualifier === 'DIR' && component.name === '/');\n  });\n}\n\nfunction storeChildrenBase(children: Component[]) {\n  children.forEach(addComponent);\n}\n\nfunction storeChildrenBreadcrumbs(parentComponentKey: string, children: Breadcrumb[]) {\n  const parentBreadcrumbs = getComponentBreadcrumbs(parentComponentKey);\n  if (parentBreadcrumbs) {\n    children.forEach(child => {\n      const breadcrumbs = [...parentBreadcrumbs, child];\n      addComponentBreadcrumbs(child.key, breadcrumbs);\n    });\n  }\n}\n\nfunction getMetrics(isPortfolio: boolean) {\n  return isPortfolio ? PORTFOLIO_METRICS : METRICS;\n}\n\nfunction retrieveComponentBase(\n  componentKey: string,\n  isPortfolio: boolean,\n  branchLike?: BranchLike\n) {\n  const existing = getComponentFromBucket(componentKey);\n  if (existing) {\n    return Promise.resolve(existing);\n  }\n\n  const metrics = getMetrics(isPortfolio);\n\n  return getComponent({\n    componentKey,\n    metricKeys: metrics.join(),\n    ...getBranchLikeQuery(branchLike)\n  }).then(component => {\n    addComponent(component);\n    return component;\n  });\n}\n\nexport function retrieveComponentChildren(\n  componentKey: string,\n  isPortfolio: boolean,\n  branchLike?: BranchLike\n): Promise<{ components: Component[]; page: number; total: number }> {\n  const existing = getComponentChildren(componentKey);\n  if (existing) {\n    return Promise.resolve({\n      components: existing.children,\n      total: existing.total,\n      page: existing.page\n    });\n  }\n\n  const metrics = getMetrics(isPortfolio);\n\n  return getChildren(componentKey, metrics, {\n    ps: PAGE_SIZE,\n    s: 'qualifier,name',\n    ...getBranchLikeQuery(branchLike)\n  })\n    .then(prepareChildren)\n    .then(expandRootDir(metrics, branchLike))\n    .then(r => {\n      addComponentChildren(componentKey, r.components, r.total, r.page);\n      storeChildrenBase(r.components);\n      storeChildrenBreadcrumbs(componentKey, r.components);\n      return r;\n    });\n}\n\nfunction retrieveComponentBreadcrumbs(\n  component: string,\n  branchLike?: BranchLike\n): Promise<Breadcrumb[]> {\n  const existing = getComponentBreadcrumbs(component);\n  if (existing) {\n    return Promise.resolve(existing);\n  }\n\n  return getBreadcrumbs({ component, ...getBranchLikeQuery(branchLike) })\n    .then(skipRootDir)\n    .then(breadcrumbs => {\n      addComponentBreadcrumbs(component, breadcrumbs);\n      return breadcrumbs;\n    });\n}\n\nexport function retrieveComponent(\n  componentKey: string,\n  isPortfolio: boolean,\n  branchLike?: BranchLike\n): Promise<{\n  breadcrumbs: Component[];\n  component: Component;\n  components: Component[];\n  page: number;\n  total: number;\n}> {\n  return Promise.all([\n    retrieveComponentBase(componentKey, isPortfolio, branchLike),\n    retrieveComponentChildren(componentKey, isPortfolio, branchLike),\n    retrieveComponentBreadcrumbs(componentKey, branchLike)\n  ]).then(r => {\n    return {\n      component: r[0],\n      components: r[1].components,\n      total: r[1].total,\n      page: r[1].page,\n      breadcrumbs: r[2]\n    };\n  });\n}\n\nexport function loadMoreChildren(\n  componentKey: string,\n  page: number,\n  isPortfolio: boolean,\n  branchLike?: BranchLike\n): Promise<Children> {\n  const metrics = getMetrics(isPortfolio);\n\n  return getChildren(componentKey, metrics, {\n    ps: PAGE_SIZE,\n    p: page,\n    ...getBranchLikeQuery(branchLike)\n  })\n    .then(prepareChildren)\n    .then(expandRootDir(metrics, branchLike))\n    .then(r => {\n      addComponentChildren(componentKey, r.components, r.total, r.page);\n      storeChildrenBase(r.components);\n      storeChildrenBreadcrumbs(componentKey, r.components);\n      return r;\n    });\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport Helmet from 'react-helmet';\nimport Components from './Components';\nimport Breadcrumbs from './Breadcrumbs';\nimport Search from './Search';\nimport { addComponent, addComponentBreadcrumbs, clearBucket } from '../bucket';\nimport { Component as CodeComponent } from '../types';\nimport { retrieveComponentChildren, retrieveComponent, loadMoreChildren } from '../utils';\nimport { Component, BranchLike } from '../../../app/types';\nimport ListFooter from '../../../components/controls/ListFooter';\nimport SourceViewer from '../../../components/SourceViewer/SourceViewer';\nimport { isSameBranchLike } from '../../../helpers/branches';\nimport { translate } from '../../../helpers/l10n';\nimport { parseError } from '../../../helpers/request';\nimport '../code.css';\n\ninterface Props {\n  branchLike?: BranchLike;\n  component: Component;\n  location: { query: { [x: string]: string } };\n}\n\ninterface State {\n  baseComponent?: CodeComponent;\n  breadcrumbs: Array<CodeComponent>;\n  components?: Array<CodeComponent>;\n  error?: string;\n  loading: boolean;\n  page: number;\n  searchResults?: Array<CodeComponent>;\n  sourceViewer?: CodeComponent;\n  total: number;\n}\n\nexport default class App extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = {\n    loading: true,\n    breadcrumbs: [],\n    total: 0,\n    page: 0\n  };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.handleComponentChange();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (\n      prevProps.component !== this.props.component ||\n      !isSameBranchLike(prevProps.branchLike, this.props.branchLike)\n    ) {\n      this.handleComponentChange();\n    } else if (prevProps.location !== this.props.location) {\n      this.handleUpdate();\n    }\n  }\n\n  componentWillUnmount() {\n    clearBucket();\n    this.mounted = false;\n  }\n\n  handleComponentChange() {\n    const { branchLike, component } = this.props;\n\n    // we already know component's breadcrumbs,\n    addComponentBreadcrumbs(component.key, component.breadcrumbs);\n\n    this.setState({ loading: true });\n    const isPortfolio = ['VW', 'SVW'].includes(component.qualifier);\n    retrieveComponentChildren(component.key, isPortfolio, branchLike)\n      .then(() => {\n        addComponent(component);\n        if (this.mounted) {\n          this.handleUpdate();\n        }\n      })\n      .catch(e => {\n        if (this.mounted) {\n          this.setState({ loading: false });\n          parseError(e).then(this.handleError);\n        }\n      });\n  }\n\n  loadComponent(componentKey: string) {\n    this.setState({ loading: true });\n\n    const isPortfolio = ['VW', 'SVW'].includes(this.props.component.qualifier);\n    retrieveComponent(componentKey, isPortfolio, this.props.branchLike)\n      .then(r => {\n        if (this.mounted) {\n          if (['FIL', 'UTS'].includes(r.component.qualifier)) {\n            this.setState({\n              loading: false,\n              sourceViewer: r.component,\n              breadcrumbs: r.breadcrumbs,\n              searchResults: undefined\n            });\n          } else {\n            this.setState({\n              loading: false,\n              baseComponent: r.component,\n              components: r.components,\n              breadcrumbs: r.breadcrumbs,\n              total: r.total,\n              page: r.page,\n              sourceViewer: undefined,\n              searchResults: undefined\n            });\n          }\n        }\n      })\n      .catch(e => {\n        if (this.mounted) {\n          this.setState({ loading: false });\n          parseError(e).then(this.handleError);\n        }\n      });\n  }\n\n  handleUpdate() {\n    const { component, location } = this.props;\n    const { selected } = location.query;\n    const finalKey = selected || component.key;\n\n    this.loadComponent(finalKey);\n  }\n\n  handleLoadMore = () => {\n    const { baseComponent, components, page } = this.state;\n    if (!baseComponent || !components) {\n      return;\n    }\n    const isPortfolio = ['VW', 'SVW'].includes(this.props.component.qualifier);\n    loadMoreChildren(baseComponent.key, page + 1, isPortfolio, this.props.branchLike)\n      .then(r => {\n        if (this.mounted) {\n          this.setState({\n            components: [...components, ...r.components],\n            page: r.page,\n            total: r.total\n          });\n        }\n      })\n      .catch(e => {\n        if (this.mounted) {\n          this.setState({ loading: false });\n          parseError(e).then(this.handleError);\n        }\n      });\n  };\n\n  handleError = (error: string) => {\n    if (this.mounted) {\n      this.setState({ error });\n    }\n  };\n\n  render() {\n    const { branchLike, component, location } = this.props;\n    const {\n      loading,\n      error,\n      baseComponent,\n      components,\n      breadcrumbs,\n      total,\n      sourceViewer\n    } = this.state;\n    const shouldShowBreadcrumbs = breadcrumbs.length > 1;\n\n    const componentsClassName = classNames('boxed-group', 'boxed-group-inner', 'spacer-top', {\n      'new-loading': loading\n    });\n\n    return (\n      <div className=\"page page-limited\">\n        <Helmet title={translate('code.page')} />\n\n        {error && <div className=\"alert alert-danger\">{error}</div>}\n\n        <Search\n          branchLike={branchLike}\n          component={component}\n          location={location}\n          onError={this.handleError}\n        />\n\n        <div className=\"code-components\">\n          {shouldShowBreadcrumbs && (\n            <Breadcrumbs\n              branchLike={branchLike}\n              breadcrumbs={breadcrumbs}\n              rootComponent={component}\n            />\n          )}\n\n          {sourceViewer === undefined &&\n            components !== undefined && (\n              <div className={componentsClassName}>\n                <Components\n                  baseComponent={baseComponent}\n                  branchLike={branchLike}\n                  components={components}\n                  rootComponent={component}\n                />\n              </div>\n            )}\n\n          {sourceViewer === undefined &&\n            components !== undefined && (\n              <ListFooter count={components.length} total={total} loadMore={this.handleLoadMore} />\n            )}\n\n          {sourceViewer !== undefined && (\n            <div className=\"spacer-top\">\n              <SourceViewer branchLike={branchLike} component={sourceViewer.key} />\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n"],"sourceRoot":""}
{"version":3,"sources":["webpack:///./src/main/js/components/measure/Measure.tsx","webpack:///./src/main/js/components/ui/Rating.tsx","webpack:///./src/main/js/api/measures.ts","webpack:///./src/main/js/components/measure/utils.ts","webpack:///./src/main/js/components/SourceViewer/components/MeasuresOverlayMeasure.tsx","webpack:///./src/main/js/components/SourceViewer/components/MeasuresOverlayCoveredFiles.tsx","webpack:///./src/main/js/api/tests.ts","webpack:///./src/main/js/components/shared/TestStatusIcon.tsx","webpack:///./src/main/js/components/SourceViewer/components/MeasuresOverlayTestCase.tsx","webpack:///./src/main/js/components/SourceViewer/components/MeasuresOverlayTestCases.tsx","webpack:///./src/main/js/components/SourceViewer/components/MeasuresOverlay.tsx","webpack:///./src/main/js/components/SourceViewer/SourceViewerHeader.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineOptionsPopup.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineNumber.tsx","webpack:///./src/main/js/components/SourceViewer/components/SCMPopup.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineSCM.tsx","webpack:///./src/main/js/components/SourceViewer/components/CoveragePopup.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineCoverage.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineDuplications.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineDuplicationBlock.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineIssuesIndicator.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineIssuesList.tsx","webpack:///./src/main/js/components/SourceViewer/helpers/highlight.ts","webpack:///./src/main/js/components/SourceViewer/components/LineCode.tsx","webpack:///./src/main/js/components/SourceViewer/components/Line.tsx","webpack:///./src/main/js/components/SourceViewer/helpers/issueLocations.tsx","webpack:///./src/main/js/components/SourceViewer/SourceViewerCode.tsx","webpack:///./src/main/js/components/SourceViewer/components/DuplicationPopup.tsx","webpack:///./src/main/js/components/SourceViewer/helpers/loadIssues.tsx","webpack:///./src/main/js/components/SourceViewer/helpers/indexing.ts","webpack:///./src/main/js/components/SourceViewer/SourceViewerBase.tsx","webpack:///./src/main/js/components/SourceViewer/helpers/getCoverageStatus.tsx","webpack:///./src/main/js/components/SourceViewer/SourceViewer.tsx","webpack:///./src/main/js/components/common/LocationIndex.js","webpack:///./src/main/js/components/issue/components/IssueChangelogDiff.js","webpack:///./src/main/js/components/issue/popups/ChangelogPopup.js","webpack:///./src/main/js/components/issue/components/IssueChangelog.js","webpack:///./src/main/js/components/issue/components/IssueMessage.js","webpack:///./src/main/js/components/common/SelectListItem.js","webpack:///./src/main/js/components/common/SelectList.js","webpack:///./src/main/js/components/shared/StatusIcon.js","webpack:///./src/main/js/components/shared/StatusHelper.js","webpack:///./src/main/js/components/issue/popups/SimilarIssuesPopup.js","webpack:///./src/main/js/components/issue/components/SimilarIssuesFilter.js","webpack:///./src/main/js/components/issue/components/IssueTitleBar.js","webpack:///./src/main/js/components/issue/popups/SetAssigneePopup.js","webpack:///./src/main/js/components/issue/components/IssueAssign.js","webpack:///./src/main/js/components/issue/actions.js","webpack:///./src/main/js/components/issue/popups/CommentPopup.js","webpack:///./src/main/js/components/issue/components/IssueCommentAction.js","webpack:///./src/main/js/components/issue/popups/SetSeverityPopup.js","webpack:///./src/main/js/components/issue/components/IssueSeverity.js","webpack:///./src/main/js/components/issue/popups/SetIssueTagsPopup.tsx","webpack:///./src/main/js/components/issue/components/IssueTags.js","webpack:///./src/main/js/components/issue/popups/SetTransitionPopup.js","webpack:///./src/main/js/components/issue/components/IssueTransition.js","webpack:///./src/main/js/components/issue/popups/SetTypePopup.js","webpack:///./src/main/js/components/issue/components/IssueType.js","webpack:///./src/main/js/components/issue/components/IssueActionsBar.js","webpack:///./src/main/js/components/issue/popups/CommentDeletePopup.js","webpack:///./src/main/js/components/issue/components/IssueCommentLine.js","webpack:///./src/main/js/components/issue/IssueView.js","webpack:///./src/main/js/components/issue/Issue.js","webpack:///./src/main/js/components/common/LocationMessage.js"],"names":["_helpers_measures__WEBPACK_IMPORTED_MODULE_5__","__webpack_require__","Measure","_a","className","decimals","metricKey","metricType","small","value","undefined","react__WEBPACK_IMPORTED_MODULE_0__","_ui_Level__WEBPACK_IMPORTED_MODULE_3__","level","formattedValue","Object","tooltip","_utils__WEBPACK_IMPORTED_MODULE_1__","Number","rating","_ui_Rating__WEBPACK_IMPORTED_MODULE_2__","_controls_Tooltip__WEBPACK_IMPORTED_MODULE_4__","overlay","Rating","_b","muted","_c","formatted","_helpers_measures__WEBPACK_IMPORTED_MODULE_2__","classnames__WEBPACK_IMPORTED_MODULE_1__","rating-small","rating-muted","getMeasures","data","_helpers_request__WEBPACK_IMPORTED_MODULE_0__","then","r","component","measures","_app_utils_throwGlobalError__WEBPACK_IMPORTED_MODULE_1__","getMeasuresAndMeta","componentKey","metrics","additional","__assign","metricKeys","join","getMeasuresForProjects","projectKeys","getCustomMeasures","customMeasures","paging","pageIndex","p","pageSize","ps","total","createCustomMeasure","catch","updateCustomMeasure","deleteCustomMeasure","KNOWN_RATINGS","enhanceMeasure","measure","metric","leak","periods","period","find","index","getLeakValue","getRatingTooltip","finalMetricKey","_helpers_measures__WEBPACK_IMPORTED_MODULE_0__","substr","includes","MeasuresOverlayMeasure_MeasuresOverlayMeasure","index_js_exposed","data-metric","key","IssueTypeIcon","query","l10n","type","_super","MeasuresOverlayCoveredFiles","_this","apply","this","arguments","mounted","state","loading","fetchCoveredFiles","setState","testId","props","testCase","id","request","files","throwGlobalError","coveredFiles","MeasuresOverlayCoveredFiles_extends","prototype","componentDidMount","componentDidUpdate","prevProps","componentWillUnmount","render","DeferredSpinner","status","length","map","coveredFile","react_router_es","to","urls","longName","coveredLines","message","stacktrace","TestStatusIcon_TestStatusIcon","classnames","toLowerCase","MeasuresOverlayTestCase","handleTestCaseClick","event","preventDefault","currentTarget","blur","onClick","MeasuresOverlayTestCase_extends","hasAdditionalData","durationInMs","href","name","MeasuresOverlayTestCases","fetchTests","parameters","MeasuresOverlayTestCases_assign","testFileKey","branches","branchLike","testCases","tests","handleTestCasesSortClick","sort","dataset","sortAsc","selectedTestId","MeasuresOverlayTestCases_extends","selectedTest","test","colSpan","active-link","data-sort","mainOrder","lodash_js_exposed","MeasuresOverlayTestCases_sortTestCases","components_MeasuresOverlayTestCase","components_MeasuresOverlayCoveredFiles","MeasuresOverlay","showAllMeasures","fetchData","Promise","all","fetchMeasures","fetchIssues","facets","MeasuresOverlay_assign","api_metrics","helpers_measures","api_measures","sourceViewerFile","withMetrics","filter","api_issues","componentKeys","resolved","severitiesFacet","f","property","tagsFacet","typesFacet","values","handleAllMeasuresClick","renderMeasure","renderLines","lines","ncloc","comment_lines","comment_lines_density","cognitive_complexity","complexity","function_complexity","renderBigMeasure","renderIssues","violations","sqale_index","constants","indexOf","val","count","SeverityHelper","severity","renderCoverage","coverage","CoverageRating","size","uncovered_lines","lines_to_cover","uncovered_conditions","conditions_to_cover","renderDuplications","duplications","duplicated_lines_density","DuplicationsRating","duplicated_blocks","duplicated_lines","renderTests","test_success_density","test_failures","test_errors","skipped_tests","test_execution_time","renderDomain","domain","renderAllMeasures","domains","domainKeys","keys","odd","_","even","MeasuresOverlay_extends","Modal","contentLabel","large","onRequestClose","onClose","QualifierIcon","qualifier","project","projectName","subProject","subProjectName","q","path","components_MeasuresOverlayTestCases","buttons","SourceViewerHeader","measuresOverlay","handleShowMeasuresClick","handleMeasuresOverlayClose","openInWorkspace","context","workspace","openComponent","SourceViewerHeader_extends","uuid","isUnitTest","rawSourcesLink","querystring_es3","SourceViewerHeader_assign","helpers_path","canMarkAsFavorite","FavoriteContainer","Dropdown","onToggleClick","open","ListIcon","components_MeasuresOverlay","pathname","target","fileUuids","issues","duplicationDensity","contextTypes","prop_types","isRequired","LineOptionsPopup_LineOptionsPopup","line","popupPosition","permalink","LineOptionsPopup_assign","BubblePopup","customClass","position","LineNumber","handleClick","stopPropagation","onPopupToggle","handleTogglePopup","LineNumber_extends","popupOpen","lineNumber","data-line-number","role","tabIndex","BubblePopupHelper","isOpen","offset","vertical","horizontal","popup","togglePopup","SCMPopup_SCMPopup","scmAuthor","scmDate","DateFormatter","date","scmRevision","LineSCM","LineSCM_extends","previousLine","hasPopup","cell","s","changed","LineSCM_isSCMChanged","data-author","CoveragePopup","components","CoveragePopup_assign","sourceFileKey","sourceFileLineNumber","handleTestClick","CoveragePopup_extends","testCasesByFile","testFiles","fileKey","testSet","file","fileName","conditions","coveredConditions","testFile","data-key","title","LineCoverage","closePopup","LineCoverage_extends","coverageStatus","Tooltip","placement","components_CoveragePopup","LineDuplications","LineDuplications_extends","source-line-duplicated","duplicated","LineDuplicationBlock","LineDuplicationBlock_extends","data-index","renderDuplicationPopup","LineIssuesIndicator","LineIssuesIndicator_extends","hasIssues","source-line-with-issues","mostImportantIssue","helpers_issues","SeverityIcon","LineIssuesList_LineIssuesList","issuePopup","issue","Issue","displayLocationsCount","displayIssueLocationsCount","displayLocationsLink","displayIssueLocationsLink","onChange","onIssueChange","onIssueClick","onIssuePopupToggle","openPopup","selected","selectedIssue","highlight_ISSUE_LOCATION_CLASS","highlight_splitByTokens","code","rootClassName","container","document","createElement","tokens","innerHTML","forEach","call","childNodes","node","nodeType","fullClassName","innerTokens","concat","nodeValue","push","markers","text","highlight_part","str","from","acc","highlight_highlightIssueLocations","issueLocations","location","nextTokens","markerAdded","startLine","token","s1","e1","s2","e2","x","Math","max","min","p1","p2","p3","highlight_assign","newClassName","slice","LineCode","handleSymbolClick","match","onSymbolClick","LineCode_extends","attachEvents","highlightedLocationMessage","activeMarkerNode","scroll","componentWillReceiveProps","nextProps","componentWillUpdate","detachEvents","codeNode","symbols","querySelectorAll","i","addEventListener","renderMarker","leading","onLocationSelect","ref","LocationIndex","LocationMessage","highlightedSymbols","onIssueSelect","secondaryIssueLocations","showIssues","symbol","symbolRegExp","RegExp","highlight_highlightSymbol","has-issues","renderedTokens","leadingMarker","displayLocationMarkers","marker","trim","Line","isPopupOpen","linePopup","handleIssuesIndicatorClick","openIssues","onIssuesClose","onIssueUnselect","onIssuesOpen","Line_extends","displayCoverage","duplicationsCount","filtered","source-line-highlighted","highlighted","source-line-filtered","source-line-filtered-dark","source-line-last","last","components_LineNumber","onLinePopupToggle","components_LineSCM","components_LineCoverage","displayDuplications","components_LineDuplications","loadDuplications","components_LineDuplicationBlock","displayIssues","displayAllIssues","components_LineIssuesIndicator","components_LineCode","getLinearLocations","textRange","locations","endLine","startOffset","endOffset","SourceViewerCode_EMPTY_ARRAY","SourceViewerCode_ZERO_LINE","SourceViewerCode","getDuplicationsForLine","duplicationsByLine","getIssuesForLine","issuesByLine","getIssueLocationsForLine","issueLocationsByLine","getSecondaryIssueLocationsForLine","highlightedLocations","reduce","linearLocations","l","SourceViewerCode_assign","renderLine","filterLine","sources","issuesForLine","symbolsForLine","symbolsByLine","optimizedHighlightedSymbols","optimizedSelectedIssue","optimizedSecondaryIssueLocations","optimizedLocationMessage","some","components_Line","highlightedLine","hasSourcesAfter","openIssuesByLine","SourceViewerCode_extends","hasFileIssues","hasSourcesBefore","loadingSourcesBefore","loadSourcesBefore","loadingSourcesAfter","loadSourcesAfter","DuplicationPopup","isDifferentComponent","a","b","Boolean","handleFileClick","DuplicationPopup_extends","duplicatedFiles","groupedBlocks","blocks","fileRef","d","inRemovedComponent","duplication","block","data-line","loadIssues_PAGE_SIZE","loadIssues_loadPageAndNext","toLine","page","loadIssues_assign","users","rules","loadIssues_loadPage","lastIssue","nextIssues","loadIssues_loadIssues","_fromLine","additionalFields","loadIssues_buildQuery","resolve","indexing_issuesByLine","indexing_locationsByLine","indexing_symbolsByLine","SourceViewerBase_LINES","SourceViewerBase","loadSources","reject","aroundLine","safeLoadSources","response","firstSourceLine","safeLoadIssues","prevState","computeCoverageStatus","SourceViewerBase_assign","lastSourceLine","fromLine","changes","duplicationIndex","_ref","indexing_duplicationsByLine","handleLinePopupToggle","samePopup","closeLinePopup","handleIssuePopupToggle","popupName","handleIssueSelect","handleIssueUnselect","handleOpenIssues","handleCloseIssues","handleIssueChange","newIssues","candidate","handleFilterLine","leakPeriodDate","dates","foundOne","outOfBounds","shouldDisplay","isOk","components_DuplicationPopup","notAccessible","notExist","sourceRemoved","SourceViewerBase_extends","fetchComponent","isLineOutsideOfRange","fetchSources","selectedIssue_1","reloadIssues","defineProperty","loadComponent","SourceViewerBase_defaultLoadComponent","loadIssues","SourceViewerBase_defaultLoadSources","lineHits","firstLine","lastList","safeLoadComponent","onReceiveComponent","finalSources_1","onLoaded","onFailLoadSources","finalSources_2","renderCode","SourceViewer_SourceViewerCode","source-duplications-expanded","SourceViewer_SourceViewerHeader","defaultProps","SourceViewer_mapDispatchToProps","dispatch","favorites","notFavorites","fav","duck","__webpack_exports__","es","SourceViewer_SourceViewerBase","children","other","__rest","clickAttributes","react__WEBPACK_IMPORTED_MODULE_0___default","classnames__WEBPACK_IMPORTED_MODULE_1___default","is-leading","IssueChangelogDiff_IssueChangelogDiff","diff","index_js_exposed_default","oldValue","newValue","ChangelogPopup","changelogs","ChangelogPopup_extends","loadChangelog","onFail","author","DateTimeFormatter","creationDate","item","idx","userName","Avatar","hash","avatar","diffs","PureComponent","IssueChangelog","evt","toggleChangelog","IssueChangelog_extends","popups_ChangelogPopup","mouseEnterDelay","DateFromNow","IssueMessage","e","openRule","rule","organization","IssueMessage_extends","aria-label","prop_types_default","object","SelectListItem","handleSelect","onSelect","handleHover","onHover","SelectListItem_extends","renderLink","classnames_default","active","onMouseOver","onFocus","SelectList","attachShortcuts","previousKeyScope","keymaster_default","getScope","previousFilter","currentKeyScope","setScope","tagName","srcElement","isInput","keyCode","selectNextElement","selectPreviousElement","detachShortcuts","deleteScope","items","renderChild","child","common_SelectListItem","cloneElement","currentItem","SelectList_extends","hasChildren","Children","StatusIcon_StatusIcon","StatusHelper_StatusHelper","resolution","SimilarIssuesPopup","onFilter","SimilarIssuesPopup_extends","tags","tag","common_SelectList","assignee","assigneeAvatar","assigneeName","ruleName","componentQualifier","componentLongName","SimilarIssuesFilter","handleFilter","SimilarIssuesFilter_extends","popups_SimilarIssuesPopup","IssueTitleBar_stopPropagation","IssueTitleBar_IssueTitleBar","hasSimilarIssuesFilter","locationsCount","secondaryLocations","flows","sum","locationsBadge","displayLocations","issueUrl","IssueTitleBar_assign","components_IssueMessage","components_IssueChangelog","currentPopup","LinkIcon","components_SimilarIssuesFilter","SetAssigneePopup_LIST_SIZE","SetAssigneePopup_SetAssigneePopup","SetAssigneePopup","searchMembers","organizations","projectOrganization","handleSearchResult","searchUsers","currentUser","login","handleSearchChange","defaultUsersArray","organizationsEnabled","isLoggedIn","SetAssigneePopup_extends","SearchBox","autoFocus","minLength","placeholder","user","style","marginLeft","popups_SetAssigneePopup","react_redux_es","rootReducer","IssueAssign","toggleAssign","IssueAssign_extends","renderAssignee","canAssign","onAssign","actions_updateIssue","resultPromise","oldIssue","newIssue","optimisticUpdate","error","CommentPopup","handleCommentChange","textComment","handleCommentClick","onComment","handleCancelClick","toggleComment","handleKeyboard","metaKey","ctrlKey","comment","markdown","CommentPopup_extends","onKeyDown","rows","disabled","MarkdownTips","IssueCommentAction","addComment","issueKey","IssueCommentAction_extends","popups_CommentPopup","commentPlaceholder","SetSeverityPopup_SEVERITY","SetSeverityPopup","SetSeverityPopup_extends","IssueSeverity","toggleSetSeverity","setSeverity","setIssueProperty","IssueSeverity_extends","canSetSeverity","popups_SetSeverityPopup","SetIssueTagsPopup_LIST_SIZE","SetIssueTagsPopup","searchResult","onSearch","selectedTags","setTags","onUnselect","SetIssueTagsPopup_extends","availableTags","TagsSelector","listSize","IssueTags","toggleSetTags","IssueTags_assign","IssueTags_extends","canSetTags","popups_SetIssueTagsPopup","TagsList","allowUpdate","SetTransitionPopup","SetTransitionPopup_extends","transitions","transition","IssueTransition","setTransition","toggleSetTransition","IssueTransition_extends","hasTransitions","popups_SetTransitionPopup","SetTypePopup_TYPES","SetTypePopup","SetTypePopup_extends","IssueType","toggleSetType","setType","IssueType_extends","popups_SetTypePopup","IssueActionsBar","apiCall","IssueActionsBar_assign","handleTransition","IssueActionsBar_extends","actions","canComment","components_IssueType","components_IssueSeverity","components_IssueTransition","components_IssueAssign","effort","components_IssueCommentAction","components_IssueTags","CommentDeletePopup_CommentDeletePopup","onDelete","IssueCommentLine","handleEdit","onEdit","toggleEditPopup","handleDelete","toggleDeletePopup","force","IssueCommentLine_extends","authorName","authorAvatar","dangerouslySetInnerHTML","__html","htmlText","createdAt","updatable","IssueView","handleCheck","onCheck","editComment","deleteComment","IssueView_extends","hasCheckbox","issueClass","issue-with-checkbox","data-issue","components_IssueActionsBar","comments","components_IssueCommentLine","icon-checkbox-checked","checked","Issue_Issue","handleAssignement","handleFail","rootActions","store","Issue_extends","bindShortcuts","unbindShortcuts","unbind","issue_IssueView"],"mappings":"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","file":"js/2.fe7b6cef.chunk.js","sourcesContent":["/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { getRatingTooltip } from './utils';\nimport Rating from '../ui/Rating';\nimport Level from '../ui/Level';\nimport Tooltips from '../controls/Tooltip';\nimport { formatMeasure } from '../../helpers/measures';\n\ninterface Props {\n  className?: string;\n  decimals?: number | null;\n  metricKey: string;\n  metricType: string;\n  small?: boolean;\n  value: string | undefined;\n}\n\nexport default function Measure({\n  className,\n  decimals,\n  metricKey,\n  metricType,\n  small,\n  value\n}: Props) {\n  if (value === undefined) {\n    return <span>{'–'}</span>;\n  }\n\n  if (metricType === 'LEVEL') {\n    return <Level className={className} level={value} small={small} />;\n  }\n\n  if (metricType !== 'RATING') {\n    const formattedValue = formatMeasure(value, metricType, { decimals });\n    return <span className={className}>{formattedValue != null ? formattedValue : '–'}</span>;\n  }\n\n  const tooltip = getRatingTooltip(metricKey, Number(value));\n  const rating = <Rating small={small} value={value} />;\n  if (tooltip) {\n    return (\n      <Tooltips overlay={tooltip}>\n        <span className={className}>{rating}</span>\n      </Tooltips>\n    );\n  }\n  return rating;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\nimport { formatMeasure } from '../../helpers/measures';\nimport './Rating.css';\n\ninterface Props {\n  className?: string;\n  muted?: boolean;\n  small?: boolean;\n  value: string | number | undefined;\n}\n\nexport default function Rating({ className, muted = false, small = false, value }: Props) {\n  if (value === undefined) {\n    return <span>{'–'}</span>;\n  }\n  const formatted = formatMeasure(value, 'RATING');\n  return (\n    <span\n      className={classNames(\n        'rating',\n        'rating-' + formatted,\n        { 'rating-small': small, 'rating-muted': muted },\n        className\n      )}>\n      {formatted}\n    </span>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { getJSON, RequestData, postJSON, post } from '../helpers/request';\nimport throwGlobalError from '../app/utils/throwGlobalError';\nimport { Measure, MeasurePeriod } from '../helpers/measures';\nimport { Metric, CustomMeasure, Paging, BranchParameters } from '../app/types';\nimport { Period } from '../helpers/periods';\n\nexport function getMeasures(\n  data: { componentKey: string; metricKeys: string } & BranchParameters\n): Promise<{ metric: string; value?: string }[]> {\n  return getJSON('/api/measures/component', data).then(r => r.component.measures, throwGlobalError);\n}\n\nexport interface MeasureComponent {\n  key: string;\n  description?: string;\n  measures: Measure[];\n  name: string;\n  qualifier: string;\n}\n\nexport function getMeasuresAndMeta(\n  componentKey: string,\n  metrics: string[],\n  additional: RequestData = {}\n): Promise<{ component: MeasureComponent; metrics?: Metric[]; periods?: Period[] }> {\n  const data = { ...additional, componentKey, metricKeys: metrics.join(',') };\n  return getJSON('/api/measures/component', data);\n}\n\ninterface MeasuresForProjects {\n  component: string;\n  metric: string;\n  periods?: MeasurePeriod[];\n  value?: string;\n}\n\nexport function getMeasuresForProjects(\n  projectKeys: string[],\n  metricKeys: string[]\n): Promise<MeasuresForProjects[]> {\n  return getJSON('/api/measures/search', {\n    projectKeys: projectKeys.join(),\n    metricKeys: metricKeys.join()\n  }).then(r => r.measures);\n}\n\nexport function getCustomMeasures(data: {\n  f?: string;\n  p?: number;\n  projectKey: string;\n  ps?: number;\n}): Promise<{ customMeasures: CustomMeasure[]; paging: Paging }> {\n  return getJSON('/api/custom_measures/search', data).then(\n    r =>\n      ({\n        customMeasures: r.customMeasures,\n        paging: { pageIndex: r.p, pageSize: r.ps, total: r.total }\n      } as any),\n    throwGlobalError\n  );\n}\n\nexport function createCustomMeasure(data: {\n  description?: string;\n  metricKey: string;\n  projectKey: string;\n  value: string;\n}): Promise<CustomMeasure> {\n  return postJSON('/api/custom_measures/create', data).catch(throwGlobalError);\n}\n\nexport function updateCustomMeasure(data: { description?: string; id: string; value?: string }) {\n  return post('/api/custom_measures/update', data).catch(throwGlobalError);\n}\n\nexport function deleteCustomMeasure(data: { id: string }) {\n  return post('/api/custom_measures/delete', data).catch(throwGlobalError);\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport {\n  getRatingTooltip as nextGetRatingTooltip,\n  isDiffMetric,\n  Measure,\n  MeasureEnhanced\n} from '../../helpers/measures';\nimport { Metric } from '../../app/types';\n\nconst KNOWN_RATINGS = ['sqale_rating', 'reliability_rating', 'security_rating'];\n\nexport function enhanceMeasure(\n  measure: Measure,\n  metrics: { [key: string]: Metric }\n): MeasureEnhanced {\n  return {\n    ...measure,\n    metric: metrics[measure.metric],\n    leak: getLeakValue(measure)\n  };\n}\n\nexport function getLeakValue(measure: Measure | undefined): string | undefined {\n  if (!measure || !measure.periods) {\n    return undefined;\n  }\n  const period = measure.periods.find(period => period.index === 1);\n  return period && period.value;\n}\n\nexport function getRatingTooltip(metricKey: string, value: number): string | undefined {\n  const finalMetricKey = isDiffMetric(metricKey) ? metricKey.substr(4) : metricKey;\n  if (KNOWN_RATINGS.includes(finalMetricKey)) {\n    return nextGetRatingTooltip(finalMetricKey, value);\n  }\n  return undefined;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Metric } from '../../../app/types';\nimport Measure from '../../measure/Measure';\nimport IssueTypeIcon from '../../ui/IssueTypeIcon';\nimport { getLocalizedMetricName } from '../../../helpers/l10n';\n\nexport interface MeasureWithMetric {\n  metric: Metric;\n  value?: string;\n}\n\ninterface Props {\n  measure: MeasureWithMetric;\n}\n\nexport default function MeasuresOverlayMeasure({ measure }: Props) {\n  return (\n    <div\n      className=\"measure measure-one-line\"\n      data-metric={measure.metric.key}\n      key={measure.metric.key}>\n      <span className=\"measure-name\">\n        {['bugs', 'vulnerabilities', 'code_smells'].includes(measure.metric.key) && (\n          <IssueTypeIcon className=\"little-spacer-right\" query={measure.metric.key} />\n        )}\n        {getLocalizedMetricName(measure.metric)}\n      </span>\n      <span className=\"measure-value\">\n        <Measure\n          metricKey={measure.metric.key}\n          metricType={measure.metric.type}\n          small={true}\n          value={measure.value}\n        />\n      </span>\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport { getCoveredFiles } from '../../../api/tests';\nimport { TestCase, CoveredFile } from '../../../app/types';\nimport { translate, translateWithParameters } from '../../../helpers/l10n';\nimport { getProjectUrl } from '../../../helpers/urls';\nimport DeferredSpinner from '../../common/DeferredSpinner';\n\ninterface Props {\n  testCase: TestCase;\n}\n\ninterface State {\n  coveredFiles?: CoveredFile[];\n  loading: boolean;\n}\n\nexport default class MeasuresOverlayCoveredFiles extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { loading: true };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.fetchCoveredFiles();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (this.props.testCase.id !== prevProps.testCase.id) {\n      this.fetchCoveredFiles();\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  fetchCoveredFiles = () => {\n    this.setState({ loading: true });\n    getCoveredFiles({ testId: this.props.testCase.id }).then(\n      coveredFiles => {\n        if (this.mounted) {\n          this.setState({ coveredFiles, loading: false });\n        }\n      },\n      () => {\n        if (this.mounted) {\n          this.setState({ loading: false });\n        }\n      }\n    );\n  };\n\n  render() {\n    const { testCase } = this.props;\n    const { loading, coveredFiles } = this.state;\n\n    return (\n      <div className=\"source-viewer-measures-section source-viewer-measures-section-big js-selected-test\">\n        <DeferredSpinner loading={loading}>\n          <div className=\"source-viewer-measures-card source-viewer-measures-card-fixed-height\">\n            {testCase.status !== 'ERROR' &&\n              testCase.status !== 'FAILURE' &&\n              coveredFiles !== undefined && (\n                <>\n                  <div className=\"bubble-popup-title\">\n                    {translate('component_viewer.transition.covers')}\n                  </div>\n                  {coveredFiles.length > 0\n                    ? coveredFiles.map(coveredFile => (\n                        <div className=\"bubble-popup-section\" key={coveredFile.key}>\n                          <Link to={getProjectUrl(coveredFile.key)}>{coveredFile.longName}</Link>\n                          <span className=\"note spacer-left\">\n                            {translateWithParameters(\n                              'component_viewer.x_lines_are_covered',\n                              coveredFile.coveredLines\n                            )}\n                          </span>\n                        </div>\n                      ))\n                    : translate('none')}\n                </>\n              )}\n\n            {testCase.status !== 'OK' && (\n              <>\n                <div className=\"bubble-popup-title\">{translate('component_viewer.details')}</div>\n                {testCase.message && <pre>{testCase.message}</pre>}\n                <pre>{testCase.stacktrace}</pre>\n              </>\n            )}\n          </div>\n        </DeferredSpinner>\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport throwGlobalError from '../app/utils/throwGlobalError';\nimport { Paging, TestCase, CoveredFile, BranchParameters } from '../app/types';\nimport { getJSON } from '../helpers/request';\n\nexport function getTests(\n  parameters: {\n    p?: number;\n    ps?: number;\n    sourceFileKey?: string;\n    sourceFileLineNumber?: number;\n    testFileKey: string;\n    testId?: string;\n  } & BranchParameters\n): Promise<{ paging: Paging; tests: TestCase[] }> {\n  return getJSON('/api/tests/list', parameters).catch(throwGlobalError);\n}\n\nexport function getCoveredFiles(data: { testId: string }): Promise<CoveredFile[]> {\n  return getJSON('/api/tests/covered_files', data).then(r => r.files, throwGlobalError);\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\n\ninterface Props {\n  className?: string;\n  status: string;\n}\n\nexport default function TestStatusIcon({ className, status }: Props) {\n  return <i className={classNames('icon-test-status-' + status.toLowerCase(), className)} />;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { TestCase } from '../../../app/types';\nimport TestStatusIcon from '../../shared/TestStatusIcon';\n\ninterface Props {\n  onClick: (testId: string) => void;\n  testCase: TestCase;\n}\n\nexport default class MeasuresOverlayTestCase extends React.PureComponent<Props> {\n  handleTestCaseClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    this.props.onClick(this.props.testCase.id);\n  };\n\n  render() {\n    const { testCase } = this.props;\n    const { status } = testCase;\n    const hasAdditionalData = status !== 'OK' || (status === 'OK' && testCase.coveredLines);\n\n    return (\n      <tr>\n        <td className=\"source-viewer-test-status\">\n          <TestStatusIcon status={status} />\n        </td>\n        <td className=\"source-viewer-test-duration note\">\n          {status !== 'SKIPPED' && `${testCase.durationInMs}ms`}\n        </td>\n        <td className=\"source-viewer-test-name\">\n          {hasAdditionalData ? (\n            <a className=\"js-show-test\" href=\"#\" onClick={this.handleTestCaseClick}>\n              {testCase.name}\n            </a>\n          ) : (\n            testCase.name\n          )}\n        </td>\n        <td className=\"source-viewer-test-covered-lines note\">{testCase.coveredLines}</td>\n      </tr>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\nimport { orderBy } from 'lodash';\nimport MeasuresOverlayCoveredFiles from './MeasuresOverlayCoveredFiles';\nimport MeasuresOverlayTestCase from './MeasuresOverlayTestCase';\nimport { getTests } from '../../../api/tests';\nimport { TestCase, BranchLike } from '../../../app/types';\nimport { translate } from '../../../helpers/l10n';\nimport { getBranchLikeQuery } from '../../../helpers/branches';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  componentKey: string;\n}\n\ninterface State {\n  loading: boolean;\n  selectedTestId?: string;\n  sort?: string;\n  sortAsc?: boolean;\n  testCases?: TestCase[];\n}\n\nexport default class MeasuresOverlayTestCases extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { loading: true };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.fetchTests();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (\n      prevProps.branchLike !== this.props.branchLike ||\n      prevProps.componentKey !== this.props.componentKey\n    ) {\n      this.fetchTests();\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  fetchTests = () => {\n    // TODO implement pagination one day...\n    this.setState({ loading: true });\n    getTests({\n      ps: 500,\n      testFileKey: this.props.componentKey,\n      ...getBranchLikeQuery(this.props.branchLike)\n    }).then(\n      ({ tests: testCases }) => {\n        if (this.mounted) {\n          this.setState({ loading: false, testCases });\n        }\n      },\n      () => {\n        if (this.mounted) {\n          this.setState({ loading: false });\n        }\n      }\n    );\n  };\n\n  handleTestCasesSortClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    const { sort } = event.currentTarget.dataset;\n    if (sort) {\n      this.setState((state: State) => ({\n        sort,\n        sortAsc: sort === state.sort ? !state.sortAsc : true\n      }));\n    }\n  };\n\n  handleTestCaseClick = (selectedTestId: string) => {\n    this.setState({ selectedTestId });\n  };\n\n  render() {\n    const { selectedTestId, sort = 'name', sortAsc = true, testCases } = this.state;\n\n    if (!testCases) {\n      return null;\n    }\n\n    const selectedTest = testCases.find(test => test.id === selectedTestId);\n\n    return (\n      <div className=\"source-viewer-measures\">\n        <div className=\"source-viewer-measures-section source-viewer-measures-section-big\">\n          <div className=\"source-viewer-measures-card source-viewer-measures-card-fixed-height js-test-list\">\n            <div className=\"measures\">\n              <table className=\"source-viewer-tests-list\">\n                <tbody>\n                  <tr>\n                    <td className=\"source-viewer-test-status note\" colSpan={3}>\n                      {translate('component_viewer.measure_section.unit_tests')}\n                      <br />\n                      <span className=\"spacer-right\">\n                        {translate('component_viewer.tests.ordered_by')}\n                      </span>\n                      <a\n                        className={classNames('js-sort-tests-by-duration', {\n                          'active-link': sort === 'duration'\n                        })}\n                        data-sort=\"duration\"\n                        href=\"#\"\n                        onClick={this.handleTestCasesSortClick}>\n                        {translate('component_viewer.tests.duration')}\n                      </a>\n                      <span className=\"slash-separator\" />\n                      <a\n                        className={classNames('js-sort-tests-by-name', {\n                          'active-link': sort === 'name'\n                        })}\n                        data-sort=\"name\"\n                        href=\"#\"\n                        onClick={this.handleTestCasesSortClick}>\n                        {translate('component_viewer.tests.test_name')}\n                      </a>\n                      <span className=\"slash-separator\" />\n                      <a\n                        className={classNames('js-sort-tests-by-status', {\n                          'active-link': sort === 'status'\n                        })}\n                        data-sort=\"status\"\n                        href=\"#\"\n                        onClick={this.handleTestCasesSortClick}>\n                        {translate('component_viewer.tests.status')}\n                      </a>\n                    </td>\n                    <td className=\"source-viewer-test-covered-lines note\">\n                      {translate('component_viewer.covered_lines')}\n                    </td>\n                  </tr>\n                  {sortTestCases(testCases, sort, sortAsc).map(testCase => (\n                    <MeasuresOverlayTestCase\n                      key={testCase.id}\n                      onClick={this.handleTestCaseClick}\n                      testCase={testCase}\n                    />\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n        {selectedTest && <MeasuresOverlayCoveredFiles testCase={selectedTest} />}\n      </div>\n    );\n  }\n}\n\nfunction sortTestCases(testCases: TestCase[], sort: string, sortAsc: boolean) {\n  const mainOrder = sortAsc ? 'asc' : 'desc';\n  if (sort === 'duration') {\n    return orderBy(testCases, ['durationInMs', 'name'], [mainOrder, 'asc']);\n  } else if (sort === 'status') {\n    return orderBy(testCases, ['status', 'name'], [mainOrder, 'asc']);\n  } else {\n    return orderBy(testCases, ['name'], [mainOrder]);\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport { keyBy, sortBy, groupBy } from 'lodash';\nimport MeasuresOverlayMeasure from './MeasuresOverlayMeasure';\nimport MeasuresOverlayTestCases from './MeasuresOverlayTestCases';\nimport { Button } from '../../../components/ui/buttons';\nimport { getFacets } from '../../../api/issues';\nimport { getMeasures } from '../../../api/measures';\nimport { getAllMetrics } from '../../../api/metrics';\nimport { FacetValue, SourceViewerFile, BranchLike } from '../../../app/types';\nimport Modal from '../../controls/Modal';\nimport Measure from '../../measure/Measure';\nimport QualifierIcon from '../../shared/QualifierIcon';\nimport SeverityHelper from '../../shared/SeverityHelper';\nimport CoverageRating from '../../ui/CoverageRating';\nimport DuplicationsRating from '../../ui/DuplicationsRating';\nimport IssueTypeIcon from '../../ui/IssueTypeIcon';\nimport { SEVERITIES, TYPES } from '../../../helpers/constants';\nimport { translate, getLocalizedMetricName } from '../../../helpers/l10n';\nimport {\n  formatMeasure,\n  MeasureEnhanced,\n  getDisplayMetrics,\n  enhanceMeasuresWithMetrics\n} from '../../../helpers/measures';\nimport { getBranchLikeUrl } from '../../../helpers/urls';\nimport { getBranchLikeQuery } from '../../../helpers/branches';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  onClose: () => void;\n  sourceViewerFile: SourceViewerFile;\n}\n\ninterface Measures {\n  [metricKey: string]: MeasureEnhanced;\n}\n\ninterface State {\n  loading: boolean;\n  measures: Measures;\n  severitiesFacet?: FacetValue[];\n  showAllMeasures: boolean;\n  tagsFacet?: FacetValue[];\n  typesFacet?: FacetValue[];\n}\n\nexport default class MeasuresOverlay extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { loading: true, measures: {}, showAllMeasures: false };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.fetchData();\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  fetchData = () => {\n    Promise.all([this.fetchMeasures(), this.fetchIssues()]).then(\n      ([measures, facets]) => {\n        if (this.mounted) {\n          this.setState({ loading: false, measures, ...facets });\n        }\n      },\n      () => {\n        if (this.mounted) {\n          this.setState({ loading: false });\n        }\n      }\n    );\n  };\n\n  fetchMeasures = () => {\n    return getAllMetrics().then(metrics => {\n      const metricKeys = getDisplayMetrics(metrics).map(metric => metric.key);\n\n      // eslint-disable-next-line promise/no-nesting\n      return getMeasures({\n        componentKey: this.props.sourceViewerFile.key,\n        metricKeys: metricKeys.join(),\n        ...getBranchLikeQuery(this.props.branchLike)\n      }).then(measures => {\n        const withMetrics = enhanceMeasuresWithMetrics(measures, metrics).filter(\n          measure => measure.metric\n        );\n        return keyBy(withMetrics, measure => measure.metric.key);\n      });\n    });\n  };\n\n  fetchIssues = () => {\n    return getFacets(\n      {\n        componentKeys: this.props.sourceViewerFile.key,\n        resolved: 'false',\n        ...getBranchLikeQuery(this.props.branchLike)\n      },\n      ['types', 'severities', 'tags']\n    ).then(({ facets }) => {\n      const severitiesFacet = facets.find(f => f.property === 'severities');\n      const tagsFacet = facets.find(f => f.property === 'tags');\n      const typesFacet = facets.find(f => f.property === 'types');\n      return {\n        severitiesFacet: severitiesFacet && severitiesFacet.values,\n        tagsFacet: tagsFacet && tagsFacet.values,\n        typesFacet: typesFacet && typesFacet.values\n      };\n    });\n  };\n\n  handleAllMeasuresClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    this.setState({ showAllMeasures: true });\n  };\n\n  renderMeasure = (measure: MeasureEnhanced | undefined) => {\n    return measure ? <MeasuresOverlayMeasure key={measure.metric.key} measure={measure} /> : null;\n  };\n\n  renderLines = () => {\n    const { measures } = this.state;\n\n    return (\n      <div className=\"source-viewer-measures-section\">\n        <div className=\"source-viewer-measures-card\">\n          <div className=\"measures\">\n            <div className=\"measures-list\">\n              {this.renderMeasure(measures.lines)}\n              {this.renderMeasure(measures.ncloc)}\n              {this.renderMeasure(measures.comment_lines)}\n              {this.renderMeasure(measures.comment_lines_density)}\n            </div>\n          </div>\n\n          <div className=\"measures\">\n            <div className=\"measures-list\">\n              {this.renderMeasure(measures.cognitive_complexity)}\n              {this.renderMeasure(measures.complexity)}\n              {this.renderMeasure(measures.function_complexity)}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  renderBigMeasure = (measure: MeasureEnhanced | undefined) => {\n    return measure ? (\n      <div className=\"measure measure-big\" data-metric={measure.metric.key}>\n        <span className=\"measure-value\">\n          <Measure\n            metricKey={measure.metric.key}\n            metricType={measure.metric.type}\n            value={measure.value}\n          />\n        </span>\n        <span className=\"measure-name\">{getLocalizedMetricName(measure.metric, true)}</span>\n      </div>\n    ) : null;\n  };\n\n  renderIssues = () => {\n    const { measures, severitiesFacet, tagsFacet, typesFacet } = this.state;\n    return (\n      <div className=\"source-viewer-measures-section\">\n        <div className=\"source-viewer-measures-card\">\n          <div className=\"measures\">\n            {this.renderBigMeasure(measures.violations)}\n            {this.renderBigMeasure(measures.sqale_index)}\n          </div>\n          {measures.violations &&\n            !measures.violations.value && (\n              <>\n                {typesFacet && (\n                  <div className=\"measures\">\n                    <div className=\"measures-list\">\n                      {sortBy(typesFacet, f => TYPES.indexOf(f.val)).map(f => (\n                        <div className=\"measure measure-one-line\" key={f.val}>\n                          <span className=\"measure-name\">\n                            <IssueTypeIcon className=\"little-spacer-right\" query={f.val} />\n                            {translate('issue.type', f.val)}\n                          </span>\n                          <span className=\"measure-value\">\n                            {formatMeasure(f.count, 'SHORT_INT')}\n                          </span>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                )}\n                {severitiesFacet && (\n                  <div className=\"measures\">\n                    <div className=\"measures-list\">\n                      {sortBy(severitiesFacet, f => SEVERITIES.indexOf(f.val)).map(f => (\n                        <div className=\"measure measure-one-line\" key={f.val}>\n                          <span className=\"measure-name\">\n                            <SeverityHelper severity={f.val} />\n                          </span>\n                          <span className=\"measure-value\">\n                            {formatMeasure(f.count, 'SHORT_INT')}\n                          </span>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                )}\n                {tagsFacet && (\n                  <div className=\"measures\">\n                    <div className=\"measures-list\">\n                      {tagsFacet.map(f => (\n                        <div className=\"measure measure-one-line\" key={f.val}>\n                          <span className=\"measure-name\">\n                            <i className=\"icon-tags little-spacer-right\" />\n                            {f.val}\n                          </span>\n                          <span className=\"measure-value\">\n                            {formatMeasure(f.count, 'SHORT_INT')}\n                          </span>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                )}\n              </>\n            )}\n        </div>\n      </div>\n    );\n  };\n\n  renderCoverage = () => {\n    const { coverage } = this.state.measures;\n    if (!coverage) {\n      return null;\n    }\n    return (\n      <div className=\"source-viewer-measures-section\">\n        <div className=\"source-viewer-measures-card\">\n          <div className=\"measures\">\n            <div className=\"measures-chart\">\n              <CoverageRating size=\"big\" value={coverage.value} />\n            </div>\n            <div className=\"measure measure-big\" data-metric={coverage.metric.key}>\n              <span className=\"measure-value\">\n                <Measure\n                  metricKey={coverage.metric.key}\n                  metricType={coverage.metric.type}\n                  value={coverage.value}\n                />\n              </span>\n              <span className=\"measure-name\">{getLocalizedMetricName(coverage.metric)}</span>\n            </div>\n          </div>\n\n          <div className=\"measures\">\n            <div className=\"measures-list\">\n              {this.renderMeasure(this.state.measures.uncovered_lines)}\n              {this.renderMeasure(this.state.measures.lines_to_cover)}\n              {this.renderMeasure(this.state.measures.uncovered_conditions)}\n              {this.renderMeasure(this.state.measures.conditions_to_cover)}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  renderDuplications = () => {\n    const { duplicated_lines_density: duplications } = this.state.measures;\n    if (!duplications) {\n      return null;\n    }\n    return (\n      <div className=\"source-viewer-measures-section\">\n        <div className=\"source-viewer-measures-card\">\n          <div className=\"measures\">\n            <div className=\"measures-chart\">\n              <DuplicationsRating\n                muted={duplications.value === undefined}\n                size=\"big\"\n                value={Number(duplications.value || 0)}\n              />\n            </div>\n            <div className=\"measure measure-big\" data-metric={duplications.metric.key}>\n              <span className=\"measure-value\">\n                <Measure\n                  metricKey={duplications.metric.key}\n                  metricType={duplications.metric.type}\n                  value={duplications.value}\n                />\n              </span>\n              <span className=\"measure-name\">\n                {getLocalizedMetricName(duplications.metric, true)}\n              </span>\n            </div>\n          </div>\n\n          <div className=\"measures\">\n            <div className=\"measures-list\">\n              {this.renderMeasure(this.state.measures.duplicated_blocks)}\n              {this.renderMeasure(this.state.measures.duplicated_lines)}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  renderTests = () => {\n    const { measures } = this.state;\n    return (\n      <div className=\"source-viewer-measures\">\n        <div className=\"source-viewer-measures-section\">\n          <div className=\"source-viewer-measures-card\">\n            <div className=\"measures\">\n              <div className=\"measures-list\">\n                {this.renderMeasure(measures.tests)}\n                {this.renderMeasure(measures.test_success_density)}\n                {this.renderMeasure(measures.test_failures)}\n                {this.renderMeasure(measures.test_errors)}\n                {this.renderMeasure(measures.skipped_tests)}\n                {this.renderMeasure(measures.test_execution_time)}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  renderDomain = (domain: string, measures: MeasureEnhanced[]) => {\n    return (\n      <div className=\"source-viewer-measures-card\" key={domain}>\n        <div className=\"measures\">\n          <div className=\"measures-list\">\n            <div className=\"measure measure-one-line measure-big\">\n              <span className=\"measure-name\">{domain}</span>\n            </div>\n            {sortBy(measures.filter(measure => measure.value !== undefined), measure =>\n              getLocalizedMetricName(measure.metric)\n            ).map(measure => this.renderMeasure(measure))}\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  renderAllMeasures = () => {\n    const domains = groupBy(Object.values(this.state.measures), measure => measure.metric.domain);\n    const domainKeys = Object.keys(domains);\n    const odd = domainKeys.filter((_, index) => index % 2 === 1);\n    const even = domainKeys.filter((_, index) => index % 2 === 0);\n    return (\n      <div className=\"source-viewer-measures source-viewer-measures-secondary js-all-measures\">\n        <div className=\"source-viewer-measures-section source-viewer-measures-section-big\">\n          {odd.map(domain => this.renderDomain(domain, domains[domain]))}\n        </div>\n        <div className=\"source-viewer-measures-section source-viewer-measures-section-big\">\n          {even.map(domain => this.renderDomain(domain, domains[domain]))}\n        </div>\n      </div>\n    );\n  };\n\n  render() {\n    const { branchLike, sourceViewerFile } = this.props;\n    const { loading } = this.state;\n\n    return (\n      <Modal contentLabel=\"\" large={true} onRequestClose={this.props.onClose}>\n        <div className=\"modal-container source-viewer-measures-modal\">\n          <div className=\"source-viewer-header-component source-viewer-measures-component\">\n            <div className=\"source-viewer-header-component-project\">\n              <QualifierIcon className=\"little-spacer-right\" qualifier=\"TRK\" />\n              <Link to={getBranchLikeUrl(sourceViewerFile.project, branchLike)}>\n                {sourceViewerFile.projectName}\n              </Link>\n\n              {sourceViewerFile.subProject && (\n                <>\n                  <QualifierIcon className=\"big-spacer-left little-spacer-right\" qualifier=\"BRC\" />\n                  <Link to={getBranchLikeUrl(sourceViewerFile.subProject, branchLike)}>\n                    {sourceViewerFile.subProjectName}\n                  </Link>\n                </>\n              )}\n            </div>\n\n            <div className=\"source-viewer-header-component-name\">\n              <QualifierIcon className=\"little-spacer-right\" qualifier={sourceViewerFile.q} />\n              {sourceViewerFile.path}\n            </div>\n          </div>\n\n          {loading ? (\n            <i className=\"spinner\" />\n          ) : (\n            <>\n              {sourceViewerFile.q === 'UTS' ? (\n                <>\n                  {this.renderTests()}\n                  <MeasuresOverlayTestCases\n                    branchLike={branchLike}\n                    componentKey={sourceViewerFile.key}\n                  />\n                </>\n              ) : (\n                <div className=\"source-viewer-measures\">\n                  {this.renderLines()}\n                  {this.renderIssues()}\n                  {this.renderCoverage()}\n                  {this.renderDuplications()}\n                </div>\n              )}\n            </>\n          )}\n\n          <div className=\"spacer-top\">\n            {this.state.showAllMeasures ? (\n              this.renderAllMeasures()\n            ) : (\n              <a className=\"js-show-all-measures\" href=\"#\" onClick={this.handleAllMeasuresClick}>\n                {translate('component_viewer.show_all_measures')}\n              </a>\n            )}\n          </div>\n        </div>\n\n        <footer className=\"modal-foot\">\n          <Button className=\"button-link\" onClick={this.props.onClose}>\n            {translate('close')}\n          </Button>\n        </footer>\n      </Modal>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { stringify } from 'querystring';\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport * as PropTypes from 'prop-types';\nimport * as classNames from 'classnames';\nimport MeasuresOverlay from './components/MeasuresOverlay';\nimport { SourceViewerFile, BranchLike } from '../../app/types';\nimport QualifierIcon from '../shared/QualifierIcon';\nimport Dropdown from '../controls/Dropdown';\nimport FavoriteContainer from '../controls/FavoriteContainer';\nimport ListIcon from '../icons-components/ListIcon';\nimport { ButtonIcon } from '../ui/buttons';\nimport { WorkspaceContext } from '../workspace/context';\nimport {\n  getPathUrlAsString,\n  getBranchLikeUrl,\n  getComponentIssuesUrl,\n  getBaseUrl\n} from '../../helpers/urls';\nimport { collapsedDirFromPath, fileFromPath } from '../../helpers/path';\nimport { translate } from '../../helpers/l10n';\nimport { getBranchLikeQuery, isMainBranch } from '../../helpers/branches';\nimport { formatMeasure } from '../../helpers/measures';\nimport { omitNil } from '../../helpers/request';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  sourceViewerFile: SourceViewerFile;\n}\n\ninterface State {\n  measuresOverlay: boolean;\n}\n\nexport default class SourceViewerHeader extends React.PureComponent<Props, State> {\n  context!: { workspace: WorkspaceContext };\n\n  static contextTypes = {\n    workspace: PropTypes.object.isRequired\n  };\n\n  state: State = { measuresOverlay: false };\n\n  handleShowMeasuresClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    this.setState({ measuresOverlay: true });\n  };\n\n  handleMeasuresOverlayClose = () => {\n    this.setState({ measuresOverlay: false });\n  };\n\n  openInWorkspace = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    const { key } = this.props.sourceViewerFile;\n    this.context.workspace.openComponent({ branchLike: this.props.branchLike, key });\n  };\n\n  render() {\n    const {\n      key,\n      measures,\n      path,\n      project,\n      projectName,\n      q,\n      subProject,\n      subProjectName,\n      uuid\n    } = this.props.sourceViewerFile;\n    const isUnitTest = q === 'UTS';\n    const workspace = false;\n    const rawSourcesLink =\n      getBaseUrl() +\n      '/api/sources/raw?' +\n      stringify(omitNil({ key, ...getBranchLikeQuery(this.props.branchLike) }));\n\n    // TODO favorite\n    return (\n      <div className=\"source-viewer-header\">\n        <div className=\"source-viewer-header-component\">\n          <div className=\"component-name\">\n            <div className=\"component-name-parent\">\n              <a\n                className=\"link-with-icon\"\n                href={getPathUrlAsString(getBranchLikeUrl(project, this.props.branchLike))}>\n                <QualifierIcon qualifier=\"TRK\" /> <span>{projectName}</span>\n              </a>\n            </div>\n\n            {subProject != null && (\n              <div className=\"component-name-parent\">\n                <a\n                  className=\"link-with-icon\"\n                  href={getPathUrlAsString(getBranchLikeUrl(subProject, this.props.branchLike))}>\n                  <QualifierIcon qualifier=\"BRC\" /> <span>{subProjectName}</span>\n                </a>\n              </div>\n            )}\n\n            <div className=\"component-name-path\">\n              <QualifierIcon qualifier={q} /> <span>{collapsedDirFromPath(path)}</span>\n              <span className=\"component-name-file\">{fileFromPath(path)}</span>\n              {this.props.sourceViewerFile.canMarkAsFavorite &&\n                (!this.props.branchLike || isMainBranch(this.props.branchLike)) && (\n                  <FavoriteContainer className=\"component-name-favorite\" componentKey={key} />\n                )}\n            </div>\n          </div>\n        </div>\n\n        <Dropdown>\n          {({ onToggleClick, open }) => (\n            <div className={classNames('dropdown source-viewer-header-actions', { open })}>\n              <ButtonIcon\n                className=\"js-actions\"\n                onClick={onToggleClick}\n                tooltip={translate('component_viewer.more_actions')}>\n                <ListIcon />\n              </ButtonIcon>\n              <ul className=\"dropdown-menu dropdown-menu-right\">\n                <li>\n                  <a className=\"js-measures\" href=\"#\" onClick={this.handleShowMeasuresClick}>\n                    {translate('component_viewer.show_details')}\n                  </a>\n                  {this.state.measuresOverlay && (\n                    <MeasuresOverlay\n                      branchLike={this.props.branchLike}\n                      onClose={this.handleMeasuresOverlayClose}\n                      sourceViewerFile={this.props.sourceViewerFile}\n                    />\n                  )}\n                </li>\n                <li>\n                  <a\n                    className=\"js-new-window\"\n                    href={getPathUrlAsString({\n                      pathname: '/component',\n                      query: { id: key, ...getBranchLikeQuery(this.props.branchLike) }\n                    })}\n                    target=\"_blank\">\n                    {translate('component_viewer.new_window')}\n                  </a>\n                </li>\n                {!workspace && (\n                  <li>\n                    <a className=\"js-workspace\" href=\"#\" onClick={this.openInWorkspace}>\n                      {translate('component_viewer.open_in_workspace')}\n                    </a>\n                  </li>\n                )}\n                <li>\n                  <a className=\"js-raw-source\" href={rawSourcesLink} target=\"_blank\">\n                    {translate('component_viewer.show_raw_source')}\n                  </a>\n                </li>\n              </ul>\n            </div>\n          )}\n        </Dropdown>\n\n        <div className=\"source-viewer-header-measures\">\n          {isUnitTest && (\n            <div className=\"source-viewer-header-measure\">\n              <span className=\"source-viewer-header-measure-value\">\n                {formatMeasure(measures.tests, 'SHORT_INT')}\n              </span>\n              <span className=\"source-viewer-header-measure-label\">\n                {translate('metric.tests.name')}\n              </span>\n            </div>\n          )}\n\n          {!isUnitTest && (\n            <div className=\"source-viewer-header-measure\">\n              <span className=\"source-viewer-header-measure-value\">\n                {formatMeasure(measures.lines, 'SHORT_INT')}\n              </span>\n              <span className=\"source-viewer-header-measure-label\">\n                {translate('metric.lines.name')}\n              </span>\n            </div>\n          )}\n\n          <div className=\"source-viewer-header-measure\">\n            <span className=\"source-viewer-header-measure-value\">\n              <Link\n                to={getComponentIssuesUrl(project, {\n                  resolved: 'false',\n                  fileUuids: uuid,\n                  ...getBranchLikeQuery(this.props.branchLike)\n                })}>\n                {measures.issues != null ? formatMeasure(measures.issues, 'SHORT_INT') : 0}\n              </Link>\n            </span>\n            <span className=\"source-viewer-header-measure-label\">\n              {translate('metric.violations.name')}\n            </span>\n          </div>\n\n          {measures.coverage != null && (\n            <div className=\"source-viewer-header-measure\">\n              <span className=\"source-viewer-header-measure-value\">\n                {formatMeasure(measures.coverage, 'PERCENT')}\n              </span>\n              <span className=\"source-viewer-header-measure-label\">\n                {translate('metric.coverage.name')}\n              </span>\n            </div>\n          )}\n\n          {measures.duplicationDensity != null && (\n            <div className=\"source-viewer-header-measure\">\n              <span className=\"source-viewer-header-measure-value\">\n                {formatMeasure(measures.duplicationDensity, 'PERCENT')}\n              </span>\n              <span className=\"source-viewer-header-measure-label\">\n                {translate('duplications')}\n              </span>\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport { BranchLike, SourceLine } from '../../../app/types';\nimport BubblePopup from '../../common/BubblePopup';\nimport { translate } from '../../../helpers/l10n';\nimport { getBranchLikeQuery } from '../../../helpers/branches';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  componentKey: string;\n  line: SourceLine;\n  popupPosition?: any;\n}\n\nexport default function LineOptionsPopup({ branchLike, componentKey, line, popupPosition }: Props) {\n  const permalink = {\n    pathname: '/component',\n    query: { id: componentKey, line: line.line, ...getBranchLikeQuery(branchLike) }\n  };\n  return (\n    <BubblePopup customClass=\"source-viewer-bubble-popup\" position={popupPosition}>\n      <div className=\"bubble-popup-section\">\n        <Link className=\"js-get-permalink\" to={permalink}>\n          {translate('component_viewer.get_permalink')}\n        </Link>\n      </div>\n    </BubblePopup>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport LineOptionsPopup from './LineOptionsPopup';\nimport { BranchLike, SourceLine } from '../../../app/types';\nimport BubblePopupHelper from '../../common/BubblePopupHelper';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  componentKey: string;\n  line: SourceLine;\n  onPopupToggle: (x: { index?: number; line: number; name: string; open?: boolean }) => void;\n  popupOpen: boolean;\n}\n\nexport default class LineNumber extends React.PureComponent<Props> {\n  handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    event.preventDefault();\n    event.stopPropagation();\n    event.currentTarget.blur();\n    this.props.onPopupToggle({ line: this.props.line.line, name: 'line-number' });\n  };\n\n  handleTogglePopup = (open: boolean) => {\n    this.props.onPopupToggle({ line: this.props.line.line, name: 'line-number', open });\n  };\n\n  render() {\n    const { branchLike, componentKey, line, popupOpen } = this.props;\n    const { line: lineNumber } = line;\n    const hasLineNumber = !!lineNumber;\n    return hasLineNumber ? (\n      <td\n        className=\"source-meta source-line-number\"\n        data-line-number={lineNumber}\n        onClick={this.handleClick}\n        // eslint-disable-next-line jsx-a11y/no-noninteractive-element-to-interactive-role\n        role=\"button\"\n        tabIndex={0}>\n        <BubblePopupHelper\n          isOpen={popupOpen}\n          offset={{ vertical: -18, horizontal: 0 }}\n          popup={\n            <LineOptionsPopup branchLike={branchLike} componentKey={componentKey} line={line} />\n          }\n          position=\"bottomright\"\n          togglePopup={this.handleTogglePopup}\n        />\n      </td>\n    ) : (\n      <td className=\"source-meta source-line-number\" />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { SourceLine } from '../../../app/types';\nimport BubblePopup from '../../common/BubblePopup';\nimport DateFormatter from '../../intl/DateFormatter';\n\ninterface Props {\n  line: SourceLine;\n  popupPosition?: any;\n}\n\nexport default function SCMPopup({ line, popupPosition }: Props) {\n  return (\n    <BubblePopup customClass=\"source-viewer-bubble-popup\" position={popupPosition}>\n      <div className=\"bubble-popup-section\">{line.scmAuthor}</div>\n      {line.scmDate && (\n        <div className=\"bubble-popup-section\">\n          <DateFormatter date={line.scmDate} />\n        </div>\n      )}\n      {line.scmRevision && <div className=\"bubble-popup-section\">{line.scmRevision}</div>}\n    </BubblePopup>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport SCMPopup from './SCMPopup';\nimport { SourceLine } from '../../../app/types';\nimport BubblePopupHelper from '../../common/BubblePopupHelper';\n\ninterface Props {\n  line: SourceLine;\n  onPopupToggle: (x: { index?: number; line: number; name: string; open?: boolean }) => void;\n  popupOpen: boolean;\n  previousLine: SourceLine | undefined;\n}\n\nexport default class LineSCM extends React.PureComponent<Props> {\n  handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    event.preventDefault();\n    event.stopPropagation();\n    event.currentTarget.blur();\n    this.props.onPopupToggle({ line: this.props.line.line, name: 'scm' });\n  };\n\n  handleTogglePopup = (open: boolean) => {\n    this.props.onPopupToggle({ line: this.props.line.line, name: 'scm', open });\n  };\n\n  render() {\n    const { line, popupOpen, previousLine } = this.props;\n    const hasPopup = !!line.line;\n    const cell = isSCMChanged(line, previousLine) && (\n      <div className=\"source-line-scm-inner\" data-author={line.scmAuthor} />\n    );\n    return hasPopup ? (\n      <td\n        className=\"source-meta source-line-scm\"\n        data-line-number={line.line}\n        onClick={this.handleClick}\n        // eslint-disable-next-line jsx-a11y/no-noninteractive-element-to-interactive-role\n        role=\"button\"\n        tabIndex={0}>\n        {cell}\n        <BubblePopupHelper\n          isOpen={popupOpen}\n          offset={{ vertical: -18, horizontal: 0 }}\n          popup={<SCMPopup line={line} />}\n          position=\"bottomright\"\n          togglePopup={this.handleTogglePopup}\n        />\n      </td>\n    ) : (\n      <td className=\"source-meta source-line-scm\" data-line-number={line.line}>\n        {cell}\n      </td>\n    );\n  }\n}\n\nfunction isSCMChanged(s: SourceLine, p: SourceLine | undefined) {\n  let changed = true;\n  if (p != null && s.scmAuthor != null && p.scmAuthor != null) {\n    changed = s.scmAuthor !== p.scmAuthor || s.scmDate !== p.scmDate;\n  }\n  return changed;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { groupBy } from 'lodash';\nimport * as PropTypes from 'prop-types';\nimport { getTests } from '../../../api/components';\nimport { BranchLike, SourceLine, TestCase } from '../../../app/types';\nimport BubblePopup from '../../common/BubblePopup';\nimport TestStatusIcon from '../../shared/TestStatusIcon';\nimport { WorkspaceContext } from '../../workspace/context';\nimport { isSameBranchLike, getBranchLikeQuery } from '../../../helpers/branches';\nimport { translate } from '../../../helpers/l10n';\nimport { collapsePath } from '../../../helpers/path';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  componentKey: string;\n  line: SourceLine;\n  onClose: () => void;\n  popupPosition?: any;\n}\n\ninterface State {\n  loading: boolean;\n  testCases: TestCase[];\n}\n\nexport default class CoveragePopup extends React.PureComponent<Props, State> {\n  context!: { workspace: WorkspaceContext };\n  mounted = false;\n\n  static contextTypes = {\n    workspace: PropTypes.object.isRequired\n  };\n\n  state: State = { loading: true, testCases: [] };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.fetchTests();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (\n      !isSameBranchLike(prevProps.branchLike, this.props.branchLike) ||\n      prevProps.componentKey !== this.props.componentKey ||\n      prevProps.line.line !== this.props.line.line\n    ) {\n      this.fetchTests();\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  fetchTests = () => {\n    this.setState({ loading: true });\n    getTests({\n      sourceFileKey: this.props.componentKey,\n      sourceFileLineNumber: this.props.line.line,\n      ...getBranchLikeQuery(this.props.branchLike)\n    }).then(\n      testCases => {\n        if (this.mounted) {\n          this.setState({ loading: false, testCases });\n        }\n      },\n      () => {\n        if (this.mounted) {\n          this.setState({ loading: false });\n        }\n      }\n    );\n  };\n\n  handleTestClick = (event: React.MouseEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    const { key } = event.currentTarget.dataset;\n    if (key) {\n      this.context.workspace.openComponent({ branchLike: this.props.branchLike, key });\n    }\n    this.props.onClose();\n  };\n\n  render() {\n    const { line } = this.props;\n    const testCasesByFile = groupBy(this.state.testCases || [], 'fileKey');\n    const testFiles = Object.keys(testCasesByFile).map(fileKey => {\n      const testSet = testCasesByFile[fileKey];\n      const test = testSet[0];\n      return {\n        file: { key: test.fileKey, longName: test.fileName },\n        tests: testSet\n      };\n    });\n\n    return (\n      <BubblePopup customClass=\"source-viewer-bubble-popup\" position={this.props.popupPosition}>\n        <div className=\"bubble-popup-title\">\n          {translate('source_viewer.covered')}\n          {!!line.conditions && (\n            <div>\n              {'('}\n              {line.coveredConditions || '0'}\n              {' of '}\n              {line.conditions} {translate('source_viewer.conditions')}\n              {')'}\n            </div>\n          )}\n        </div>\n        {this.state.loading ? (\n          <i className=\"spinner\" />\n        ) : (\n          <>\n            {testFiles.length === 0 &&\n              translate('source_viewer.tooltip.no_information_about_tests')}\n            {testFiles.map(testFile => (\n              <div className=\"bubble-popup-section\" key={testFile.file.key}>\n                <a\n                  data-key={testFile.file.key}\n                  href=\"#\"\n                  onClick={this.handleTestClick}\n                  title={testFile.file.longName}>\n                  <span>{collapsePath(testFile.file.longName)}</span>\n                </a>\n                <ul className=\"bubble-popup-list\">\n                  {testFile.tests.map(testCase => (\n                    <li\n                      className=\"component-viewer-popup-test\"\n                      key={testCase.id}\n                      title={testCase.name}>\n                      <TestStatusIcon className=\"spacer-right\" status={testCase.status} />\n                      {testCase.name}\n                      {testCase.status !== 'SKIPPED' && (\n                        <span className=\"spacer-left note\">{testCase.durationInMs}ms</span>\n                      )}\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            ))}\n          </>\n        )}\n      </BubblePopup>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport CoveragePopup from './CoveragePopup';\nimport { BranchLike, SourceLine } from '../../../app/types';\nimport Tooltip from '../../controls/Tooltip';\nimport { translate } from '../../../helpers/l10n';\nimport BubblePopupHelper from '../../common/BubblePopupHelper';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  componentKey: string;\n  line: SourceLine;\n  onPopupToggle: (x: { index?: number; line: number; name: string; open?: boolean }) => void;\n  popupOpen: boolean;\n}\n\nexport default class LineCoverage extends React.PureComponent<Props> {\n  handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    event.preventDefault();\n    event.stopPropagation();\n    event.currentTarget.blur();\n    this.props.onPopupToggle({ line: this.props.line.line, name: 'coverage' });\n  };\n\n  handleTogglePopup = (open: boolean) => {\n    this.props.onPopupToggle({ line: this.props.line.line, name: 'coverage', open });\n  };\n\n  closePopup = () => {\n    this.props.onPopupToggle({ line: this.props.line.line, name: 'coverage', open: false });\n  };\n\n  render() {\n    const { branchLike, componentKey, line, popupOpen } = this.props;\n\n    const className =\n      'source-meta source-line-coverage' +\n      (line.coverageStatus != null ? ` source-line-${line.coverageStatus}` : '');\n\n    const hasPopup =\n      line.coverageStatus === 'covered' || line.coverageStatus === 'partially-covered';\n\n    const cell = line.coverageStatus ? (\n      <Tooltip overlay={translate('source_viewer.tooltip', line.coverageStatus)} placement=\"right\">\n        <div className=\"source-line-bar\" />\n      </Tooltip>\n    ) : (\n      <div className=\"source-line-bar\" />\n    );\n\n    if (hasPopup) {\n      return (\n        <td\n          className={className}\n          data-line-number={line.line}\n          onClick={this.handleClick}\n          // eslint-disable-next-line jsx-a11y/no-noninteractive-element-to-interactive-role\n          role=\"button\"\n          tabIndex={0}>\n          {cell}\n          <BubblePopupHelper\n            isOpen={popupOpen}\n            popup={\n              <CoveragePopup\n                branchLike={branchLike}\n                componentKey={componentKey}\n                line={line}\n                onClose={this.closePopup}\n              />\n            }\n            position=\"bottomright\"\n            togglePopup={this.handleTogglePopup}\n          />\n        </td>\n      );\n    }\n\n    return (\n      <td className={className} data-line-number={line.line}>\n        {cell}\n      </td>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\nimport { SourceLine } from '../../../app/types';\nimport Tooltip from '../../controls/Tooltip';\nimport { translate } from '../../../helpers/l10n';\n\ninterface Props {\n  line: SourceLine;\n  onClick: (line: SourceLine) => void;\n}\n\nexport default class LineDuplications extends React.PureComponent<Props> {\n  handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    event.preventDefault();\n    this.props.onClick(this.props.line);\n  };\n\n  render() {\n    const { line } = this.props;\n    const className = classNames('source-meta', 'source-line-duplications', {\n      'source-line-duplicated': line.duplicated\n    });\n\n    const cell = (\n      <td\n        className={className}\n        onClick={line.duplicated ? this.handleClick : undefined}\n        role={line.duplicated ? 'button' : undefined}\n        tabIndex={line.duplicated ? 0 : undefined}>\n        <div className=\"source-line-bar\" />\n      </td>\n    );\n\n    return line.duplicated ? (\n      <Tooltip overlay={translate('source_viewer.tooltip.duplicated_line')} placement=\"right\">\n        {cell}\n      </Tooltip>\n    ) : (\n      cell\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\nimport { SourceLine } from '../../../app/types';\nimport Tooltip from '../../controls/Tooltip';\nimport { translate } from '../../../helpers/l10n';\nimport BubblePopupHelper from '../../common/BubblePopupHelper';\n\ninterface Props {\n  duplicated: boolean;\n  index: number;\n  line: SourceLine;\n  onPopupToggle: (x: { index?: number; line: number; name: string; open?: boolean }) => void;\n  popupOpen: boolean;\n  renderDuplicationPopup: (index: number, line: number) => JSX.Element;\n}\n\nexport default class LineDuplicationBlock extends React.PureComponent<Props> {\n  handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    event.preventDefault();\n    event.stopPropagation();\n    event.currentTarget.blur();\n    this.props.onPopupToggle({\n      index: this.props.index,\n      line: this.props.line.line,\n      name: 'duplications'\n    });\n  };\n\n  handleTogglePopup = (open: boolean) => {\n    this.props.onPopupToggle({\n      index: this.props.index,\n      line: this.props.line.line,\n      name: 'duplications',\n      open\n    });\n  };\n\n  render() {\n    const { duplicated, index, line, popupOpen } = this.props;\n    const className = classNames('source-meta', 'source-line-duplications-extra', {\n      'source-line-duplicated': duplicated\n    });\n\n    const cell = <div className=\"source-line-bar\" />;\n\n    return duplicated ? (\n      <td\n        className={className}\n        data-index={index}\n        data-line-number={line.line}\n        onClick={this.handleClick}\n        // eslint-disable-next-line jsx-a11y/no-noninteractive-element-to-interactive-role\n        role=\"button\"\n        tabIndex={0}>\n        <Tooltip overlay={translate('source_viewer.tooltip.duplicated_block')} placement=\"right\">\n          {cell}\n        </Tooltip>\n        <BubblePopupHelper\n          isOpen={popupOpen}\n          popup={this.props.renderDuplicationPopup(index, line.line)}\n          position=\"bottomright\"\n          togglePopup={this.handleTogglePopup}\n        />\n      </td>\n    ) : (\n      <td className={className} data-index={index} data-line-number={line.line}>\n        {cell}\n      </td>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\nimport SeverityIcon from '../../shared/SeverityIcon';\nimport { sortBySeverity } from '../../../helpers/issues';\nimport { Issue, SourceLine } from '../../../app/types';\n\ninterface Props {\n  issues: Issue[];\n  line: SourceLine;\n  onClick: () => void;\n}\n\nexport default class LineIssuesIndicator extends React.PureComponent<Props> {\n  handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    event.preventDefault();\n    this.props.onClick();\n  };\n\n  render() {\n    const { issues, line } = this.props;\n    const hasIssues = issues.length > 0;\n    const className = classNames('source-meta', 'source-line-issues', {\n      'source-line-with-issues': hasIssues\n    });\n    const mostImportantIssue = hasIssues ? sortBySeverity(issues)[0] : null;\n\n    return (\n      <td\n        className={className}\n        data-line-number={line.line}\n        onClick={hasIssues ? this.handleClick : undefined}\n        role={hasIssues ? 'button' : undefined}\n        tabIndex={hasIssues ? 0 : undefined}>\n        {mostImportantIssue != null && <SeverityIcon severity={mostImportantIssue.severity} />}\n        {issues.length > 1 && <span className=\"source-line-issues-counter\">{issues.length}</span>}\n      </td>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { BranchLike, Issue as IssueType } from '../../../app/types';\nimport Issue from '../../issue/Issue';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  displayIssueLocationsCount?: boolean;\n  displayIssueLocationsLink?: boolean;\n  issuePopup: { issue: string; name: string } | undefined;\n  issues: IssueType[];\n  onIssueChange: (issue: IssueType) => void;\n  onIssueClick: (issueKey: string) => void;\n  onIssuePopupToggle: (issue: string, popupName: string, open?: boolean) => void;\n  selectedIssue: string | undefined;\n}\n\nexport default function LineIssuesList(props: Props) {\n  const { issuePopup } = props;\n\n  return (\n    <div className=\"issue-list\">\n      {props.issues.map(issue => (\n        <Issue\n          branchLike={props.branchLike}\n          displayLocationsCount={props.displayIssueLocationsCount}\n          displayLocationsLink={props.displayIssueLocationsLink}\n          issue={issue}\n          key={issue.key}\n          onChange={props.onIssueChange}\n          onClick={props.onIssueClick}\n          onPopupToggle={props.onIssuePopupToggle}\n          openPopup={issuePopup && issuePopup.issue === issue.key ? issuePopup.name : undefined}\n          selected={props.selectedIssue === issue.key}\n        />\n      ))}\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { uniq } from 'lodash';\nimport { LinearIssueLocation } from '../../../app/types';\n\nexport interface Token {\n  className: string;\n  markers: number[];\n  text: string;\n}\n\nconst ISSUE_LOCATION_CLASS = 'source-line-code-issue';\n\nexport function splitByTokens(code: string, rootClassName = ''): Token[] {\n  const container = document.createElement('div');\n  let tokens: Token[] = [];\n  container.innerHTML = code;\n  [].forEach.call(container.childNodes, (node: Element) => {\n    if (node.nodeType === 1) {\n      // ELEMENT NODE\n      const fullClassName = rootClassName ? rootClassName + ' ' + node.className : node.className;\n      const innerTokens = splitByTokens(node.innerHTML, fullClassName);\n      tokens = tokens.concat(innerTokens);\n    }\n    if (node.nodeType === 3 && node.nodeValue) {\n      // TEXT NODE\n      tokens.push({ className: rootClassName, markers: [], text: node.nodeValue });\n    }\n  });\n  return tokens;\n}\n\nexport function highlightSymbol(tokens: Token[], symbol: string): Token[] {\n  const symbolRegExp = new RegExp(`\\\\b${symbol}\\\\b`);\n  return tokens.map(\n    token =>\n      symbolRegExp.test(token.className)\n        ? { ...token, className: `${token.className} highlighted` }\n        : token\n  );\n}\n\n/**\n * Intersect two ranges\n * @param s1 Start position of the first range\n * @param e1 End position of the first range\n * @param s2 Start position of the second range\n * @param e2 End position of the second range\n */\nfunction intersect(s1: number, e1: number, s2: number, e2: number) {\n  return { from: Math.max(s1, s2), to: Math.min(e1, e2) };\n}\n\n/**\n * Get the substring of a string\n * @param str A string\n * @param from \"From\" offset\n * @param to \"To\" offset\n * @param acc Global offset to eliminate\n */\nfunction part(str: string, from: number, to: number, acc: number): string {\n  // we do not want negative number as the first argument of `substr`\n  return from >= acc ? str.substr(from - acc, to - from) : str.substr(0, to - from);\n}\n\n/**\n * Highlight issue locations in the list of tokens\n */\nexport function highlightIssueLocations(\n  tokens: Token[],\n  issueLocations: LinearIssueLocation[],\n  rootClassName: string = ISSUE_LOCATION_CLASS\n): Token[] {\n  issueLocations.forEach(location => {\n    const nextTokens: Token[] = [];\n    let acc = 0;\n    let markerAdded = location.line !== location.startLine;\n    tokens.forEach(token => {\n      const x = intersect(acc, acc + token.text.length, location.from, location.to);\n      const p1 = part(token.text, acc, x.from, acc);\n      const p2 = part(token.text, x.from, x.to, acc);\n      const p3 = part(token.text, x.to, acc + token.text.length, acc);\n      if (p1.length) {\n        nextTokens.push({ ...token, text: p1 });\n      }\n      if (p2.length) {\n        const newClassName =\n          token.className.indexOf(rootClassName) === -1\n            ? `${token.className} ${rootClassName}`\n            : token.className;\n        nextTokens.push({\n          className: newClassName,\n          markers:\n            !markerAdded && location.index != null\n              ? uniq([...token.markers, location.index])\n              : token.markers,\n          text: p2\n        });\n        markerAdded = true;\n      }\n      if (p3.length) {\n        nextTokens.push({ ...token, text: p3 });\n      }\n      acc += token.text.length;\n    });\n    tokens = nextTokens.slice();\n  });\n  return tokens;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\nimport LineIssuesList from './LineIssuesList';\nimport { BranchLike, Issue, LinearIssueLocation, SourceLine } from '../../../app/types';\nimport LocationIndex from '../../common/LocationIndex';\nimport LocationMessage from '../../common/LocationMessage';\nimport {\n  highlightIssueLocations,\n  highlightSymbol,\n  splitByTokens,\n  Token\n} from '../helpers/highlight';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  displayIssueLocationsCount?: boolean;\n  displayIssueLocationsLink?: boolean;\n  displayLocationMarkers?: boolean;\n  highlightedLocationMessage: { index: number; text: string | undefined } | undefined;\n  highlightedSymbols: string[] | undefined;\n  issueLocations: LinearIssueLocation[];\n  issuePopup: { issue: string; name: string } | undefined;\n  issues: Issue[];\n  line: SourceLine;\n  onIssueChange: (issue: Issue) => void;\n  onIssuePopupToggle: (issue: string, popupName: string, open?: boolean) => void;\n  onIssueSelect: (issueKey: string) => void;\n  onLocationSelect: ((index: number) => void) | undefined;\n  onSymbolClick: (symbols: Array<string>) => void;\n  scroll?: (element: HTMLElement) => void;\n  secondaryIssueLocations: Array<{\n    from: number;\n    to: number;\n    line: number;\n    index: number;\n    startLine: number;\n  }>;\n  selectedIssue: string | undefined;\n  showIssues?: boolean;\n}\n\ninterface State {\n  tokens: Token[];\n}\n\nexport default class LineCode extends React.PureComponent<Props, State> {\n  activeMarkerNode?: HTMLElement | null;\n  codeNode?: HTMLElement | null;\n  symbols?: NodeListOf<HTMLElement>;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      tokens: splitByTokens(props.line.code || '')\n    };\n  }\n\n  componentDidMount() {\n    this.attachEvents();\n    if (this.props.highlightedLocationMessage && this.activeMarkerNode && this.props.scroll) {\n      this.props.scroll(this.activeMarkerNode);\n    }\n  }\n\n  componentWillReceiveProps(nextProps: Props) {\n    if (nextProps.line.code !== this.props.line.code) {\n      this.setState({\n        tokens: splitByTokens(nextProps.line.code || '')\n      });\n    }\n  }\n\n  componentWillUpdate() {\n    this.detachEvents();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    this.attachEvents();\n    if (\n      this.props.highlightedLocationMessage &&\n      prevProps.highlightedLocationMessage !== this.props.highlightedLocationMessage &&\n      this.activeMarkerNode &&\n      this.props.scroll\n    ) {\n      this.props.scroll(this.activeMarkerNode);\n    }\n  }\n\n  componentWillUnmount() {\n    this.detachEvents();\n  }\n\n  attachEvents() {\n    if (this.codeNode) {\n      this.symbols = this.codeNode.querySelectorAll('.sym');\n      if (this.symbols) {\n        for (let i = 0; i < this.symbols.length; i++) {\n          const symbol = this.symbols[i];\n          symbol.addEventListener('click', this.handleSymbolClick);\n        }\n      }\n    }\n  }\n\n  detachEvents() {\n    if (this.symbols) {\n      for (let i = 0; i < this.symbols.length; i++) {\n        const symbol = this.symbols[i];\n        symbol.addEventListener('click', this.handleSymbolClick);\n      }\n    }\n  }\n\n  handleSymbolClick = (event: MouseEvent) => {\n    event.preventDefault();\n    const keys = (event.currentTarget as HTMLElement).className.match(/sym-\\d+/g);\n    if (keys && keys.length > 0) {\n      this.props.onSymbolClick(keys);\n    }\n  };\n\n  renderMarker(index: number, message: string | undefined, selected: boolean, leading: boolean) {\n    const { onLocationSelect } = this.props;\n    const onClick = onLocationSelect ? () => onLocationSelect(index) : undefined;\n    const ref = selected ? (node: HTMLElement | null) => (this.activeMarkerNode = node) : undefined;\n    return (\n      <LocationIndex\n        key={`marker-${index}`}\n        leading={leading}\n        onClick={onClick}\n        selected={selected}>\n        <span ref={ref}>{index + 1}</span>\n        {message && <LocationMessage selected={true}>{message}</LocationMessage>}\n      </LocationIndex>\n    );\n  }\n\n  render() {\n    const {\n      highlightedLocationMessage,\n      highlightedSymbols,\n      issues,\n      issueLocations,\n      line,\n      onIssueSelect,\n      secondaryIssueLocations,\n      selectedIssue,\n      showIssues\n    } = this.props;\n\n    let tokens = [...this.state.tokens];\n\n    if (highlightedSymbols) {\n      highlightedSymbols.forEach(symbol => {\n        tokens = highlightSymbol(tokens, symbol);\n      });\n    }\n\n    if (issueLocations.length > 0) {\n      tokens = highlightIssueLocations(tokens, issueLocations);\n    }\n\n    if (secondaryIssueLocations) {\n      tokens = highlightIssueLocations(tokens, secondaryIssueLocations, 'issue-location');\n\n      if (highlightedLocationMessage) {\n        const location = secondaryIssueLocations.find(\n          location => location.index === highlightedLocationMessage.index\n        );\n        if (location) {\n          tokens = highlightIssueLocations(tokens, [location], 'selected');\n        }\n      }\n    }\n\n    const className = classNames('source-line-code', 'code', {\n      'has-issues': issues.length > 0\n    });\n\n    const renderedTokens: React.ReactNode[] = [];\n\n    // track if the first marker is displayed before the source code\n    // set `false` for the first token in a row\n    let leadingMarker = false;\n\n    tokens.forEach((token, index) => {\n      if (this.props.displayLocationMarkers && token.markers.length > 0) {\n        token.markers.forEach(marker => {\n          const selected =\n            highlightedLocationMessage !== undefined && highlightedLocationMessage.index === marker;\n          const message = selected ? highlightedLocationMessage!.text : undefined;\n          renderedTokens.push(this.renderMarker(marker, message, selected, leadingMarker));\n        });\n      }\n      renderedTokens.push(\n        <span className={token.className} key={index}>\n          {token.text}\n        </span>\n      );\n\n      // keep leadingMarker truthy if previous token has only whitespaces\n      leadingMarker = (index === 0 ? true : leadingMarker) && !token.text.trim().length;\n    });\n\n    return (\n      <td className={className} data-line-number={line.line}>\n        <div className=\"source-line-code-inner\">\n          <pre ref={node => (this.codeNode = node)}>{renderedTokens}</pre>\n        </div>\n        {showIssues &&\n          issues.length > 0 && (\n            <LineIssuesList\n              branchLike={this.props.branchLike}\n              displayIssueLocationsCount={this.props.displayIssueLocationsCount}\n              displayIssueLocationsLink={this.props.displayIssueLocationsLink}\n              issuePopup={this.props.issuePopup}\n              issues={issues}\n              onIssueChange={this.props.onIssueChange}\n              onIssueClick={onIssueSelect}\n              onIssuePopupToggle={this.props.onIssuePopupToggle}\n              selectedIssue={selectedIssue}\n            />\n          )}\n      </td>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\nimport { times } from 'lodash';\nimport LineNumber from './LineNumber';\nimport LineSCM from './LineSCM';\nimport LineCoverage from './LineCoverage';\nimport LineDuplications from './LineDuplications';\nimport LineDuplicationBlock from './LineDuplicationBlock';\nimport LineIssuesIndicator from './LineIssuesIndicator';\nimport LineCode from './LineCode';\nimport { BranchLike, Issue, LinearIssueLocation, SourceLine } from '../../../app/types';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  componentKey: string;\n  displayAllIssues?: boolean;\n  displayCoverage: boolean;\n  displayDuplications: boolean;\n  displayIssueLocationsCount?: boolean;\n  displayIssueLocationsLink?: boolean;\n  displayIssues: boolean;\n  displayLocationMarkers?: boolean;\n  duplications: number[];\n  duplicationsCount: number;\n  filtered: boolean | undefined;\n  highlighted: boolean;\n  highlightedLocationMessage: { index: number; text: string | undefined } | undefined;\n  highlightedSymbols: string[] | undefined;\n  issueLocations: LinearIssueLocation[];\n  issuePopup: { issue: string; name: string } | undefined;\n  issues: Issue[];\n  last: boolean;\n  line: SourceLine;\n  linePopup: { index?: number; line: number; name: string } | undefined;\n  loadDuplications: (line: SourceLine) => void;\n  onLinePopupToggle: (x: { index?: number; line: number; name: string; open?: boolean }) => void;\n  onIssueChange: (issue: Issue) => void;\n  onIssuePopupToggle: (issueKey: string, popupName: string, open?: boolean) => void;\n  onIssuesClose: (line: SourceLine) => void;\n  onIssueSelect: (issueKey: string) => void;\n  onIssuesOpen: (line: SourceLine) => void;\n  onIssueUnselect: () => void;\n  onLocationSelect: ((x: number) => void) | undefined;\n  onSymbolClick: (symbols: string[]) => void;\n  openIssues: boolean;\n  previousLine: SourceLine | undefined;\n  renderDuplicationPopup: (index: number, line: number) => JSX.Element;\n  scroll?: (element: HTMLElement) => void;\n  secondaryIssueLocations: Array<{\n    from: number;\n    to: number;\n    line: number;\n    index: number;\n    startLine: number;\n  }>;\n  selectedIssue: string | undefined;\n}\n\nexport default class Line extends React.PureComponent<Props> {\n  isPopupOpen = (name: string, index?: number) => {\n    const { line, linePopup } = this.props;\n    return (\n      linePopup !== undefined &&\n      linePopup.index === index &&\n      linePopup.line === line.line &&\n      linePopup.name === name\n    );\n  };\n\n  handleIssuesIndicatorClick = () => {\n    if (this.props.openIssues) {\n      this.props.onIssuesClose(this.props.line);\n      this.props.onIssueUnselect();\n    } else {\n      this.props.onIssuesOpen(this.props.line);\n\n      const { issues } = this.props;\n      if (issues.length > 0) {\n        this.props.onIssueSelect(issues[0].key);\n      }\n    }\n  };\n\n  render() {\n    const {\n      displayCoverage,\n      duplications,\n      duplicationsCount,\n      filtered,\n      issuePopup,\n      line\n    } = this.props;\n    const className = classNames('source-line', {\n      'source-line-highlighted': this.props.highlighted,\n      'source-line-filtered': filtered === true,\n      'source-line-filtered-dark':\n        displayCoverage &&\n        (line.coverageStatus === 'uncovered' || line.coverageStatus === 'partially-covered'),\n      'source-line-last': this.props.last\n    });\n\n    return (\n      <tr className={className} data-line-number={line.line}>\n        <LineNumber\n          branchLike={this.props.branchLike}\n          componentKey={this.props.componentKey}\n          line={line}\n          onPopupToggle={this.props.onLinePopupToggle}\n          popupOpen={this.isPopupOpen('line-number')}\n        />\n\n        <LineSCM\n          line={line}\n          onPopupToggle={this.props.onLinePopupToggle}\n          popupOpen={this.isPopupOpen('scm')}\n          previousLine={this.props.previousLine}\n        />\n\n        {this.props.displayCoverage && (\n          <LineCoverage\n            branchLike={this.props.branchLike}\n            componentKey={this.props.componentKey}\n            line={line}\n            onPopupToggle={this.props.onLinePopupToggle}\n            popupOpen={this.isPopupOpen('coverage')}\n          />\n        )}\n\n        {this.props.displayDuplications && (\n          <LineDuplications line={line} onClick={this.props.loadDuplications} />\n        )}\n\n        {times(duplicationsCount).map(index => (\n          <LineDuplicationBlock\n            duplicated={duplications.includes(index)}\n            index={index}\n            key={index}\n            line={this.props.line}\n            onPopupToggle={this.props.onLinePopupToggle}\n            popupOpen={this.isPopupOpen('duplications', index)}\n            renderDuplicationPopup={this.props.renderDuplicationPopup}\n          />\n        ))}\n\n        {this.props.displayIssues &&\n          !this.props.displayAllIssues && (\n            <LineIssuesIndicator\n              issues={this.props.issues}\n              line={line}\n              onClick={this.handleIssuesIndicatorClick}\n            />\n          )}\n\n        <LineCode\n          branchLike={this.props.branchLike}\n          displayIssueLocationsCount={this.props.displayIssueLocationsCount}\n          displayIssueLocationsLink={this.props.displayIssueLocationsLink}\n          displayLocationMarkers={this.props.displayLocationMarkers}\n          highlightedLocationMessage={this.props.highlightedLocationMessage}\n          highlightedSymbols={this.props.highlightedSymbols}\n          issueLocations={this.props.issueLocations}\n          issuePopup={issuePopup}\n          issues={this.props.issues}\n          line={line}\n          onIssueChange={this.props.onIssueChange}\n          onIssuePopupToggle={this.props.onIssuePopupToggle}\n          onIssueSelect={this.props.onIssueSelect}\n          onLocationSelect={this.props.onLocationSelect}\n          onSymbolClick={this.props.onSymbolClick}\n          scroll={this.props.scroll}\n          secondaryIssueLocations={this.props.secondaryIssueLocations}\n          selectedIssue={this.props.selectedIssue}\n          showIssues={this.props.openIssues || this.props.displayAllIssues}\n        />\n      </tr>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { LinearIssueLocation, TextRange } from '../../../app/types';\n\nexport function getLinearLocations(textRange: TextRange | undefined): LinearIssueLocation[] {\n  if (!textRange) {\n    return [];\n  }\n  const locations = [];\n\n  // go through all lines of the `textRange`\n  for (let line = textRange.startLine; line <= textRange.endLine; line++) {\n    // TODO fix 999999\n    const from = line === textRange.startLine ? textRange.startOffset : 0;\n    const to = line === textRange.endLine ? textRange.endOffset : 999999;\n    locations.push({ line, from, to });\n  }\n  return locations;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { intersection } from 'lodash';\nimport Line from './components/Line';\nimport { getLinearLocations } from './helpers/issueLocations';\nimport {\n  BranchLike,\n  Duplication,\n  FlowLocation,\n  Issue,\n  LinearIssueLocation,\n  SourceLine\n} from '../../app/types';\nimport { translate } from '../../helpers/l10n';\nimport { Button } from '../ui/buttons';\n\nconst EMPTY_ARRAY: any[] = [];\n\nconst ZERO_LINE = {\n  code: '',\n  duplicated: false,\n  line: 0\n};\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  componentKey: string;\n  displayAllIssues?: boolean;\n  displayIssueLocationsCount?: boolean;\n  displayIssueLocationsLink?: boolean;\n  displayLocationMarkers?: boolean;\n  duplications: Duplication[] | undefined;\n  duplicationsByLine: { [line: number]: number[] };\n  filterLine?: (line: SourceLine) => boolean;\n  hasSourcesAfter: boolean;\n  hasSourcesBefore: boolean;\n  highlightedLine: number | undefined;\n  highlightedLocationMessage: { index: number; text: string | undefined } | undefined;\n  // `undefined` elements mean they are located in a different file,\n  // but kept to maintain the location indexes\n  highlightedLocations: (FlowLocation | undefined)[] | undefined;\n  highlightedSymbols: string[];\n  issueLocationsByLine: { [line: number]: LinearIssueLocation[] };\n  issuePopup: { issue: string; name: string } | undefined;\n  issues: Issue[] | undefined;\n  issuesByLine: { [line: number]: Issue[] };\n  linePopup: { index?: number; line: number; name: string } | undefined;\n  loadDuplications: (line: SourceLine) => void;\n  loadingSourcesAfter: boolean;\n  loadingSourcesBefore: boolean;\n  loadSourcesAfter: () => void;\n  loadSourcesBefore: () => void;\n  onIssueChange: (issue: Issue) => void;\n  onIssuePopupToggle: (issue: string, popupName: string, open?: boolean) => void;\n  onIssuesClose: (line: SourceLine) => void;\n  onIssueSelect: (issueKey: string) => void;\n  onIssuesOpen: (line: SourceLine) => void;\n  onIssueUnselect: () => void;\n  onLinePopupToggle: (x: { index?: number; line: number; name: string; open?: boolean }) => void;\n  onLocationSelect: ((index: number) => void) | undefined;\n  onSymbolClick: (symbols: string[]) => void;\n  openIssuesByLine: { [line: number]: boolean };\n  renderDuplicationPopup: (index: number, line: number) => JSX.Element;\n  scroll?: (element: HTMLElement) => void;\n  selectedIssue: string | undefined;\n  sources: SourceLine[];\n  symbolsByLine: { [line: number]: string[] };\n}\n\nexport default class SourceViewerCode extends React.PureComponent<Props> {\n  getDuplicationsForLine = (line: SourceLine): number[] => {\n    return this.props.duplicationsByLine[line.line] || EMPTY_ARRAY;\n  };\n\n  getIssuesForLine = (line: SourceLine): Issue[] => {\n    return this.props.issuesByLine[line.line] || EMPTY_ARRAY;\n  };\n\n  getIssueLocationsForLine = (line: SourceLine): LinearIssueLocation[] => {\n    return this.props.issueLocationsByLine[line.line] || EMPTY_ARRAY;\n  };\n\n  getSecondaryIssueLocationsForLine = (line: SourceLine): LinearIssueLocation[] => {\n    const { highlightedLocations } = this.props;\n    if (!highlightedLocations) {\n      return EMPTY_ARRAY;\n    }\n    return highlightedLocations.reduce((locations, location, index) => {\n      const linearLocations: LinearIssueLocation[] = location\n        ? getLinearLocations(location.textRange)\n            .filter(l => l.line === line.line)\n            .map(l => ({ ...l, startLine: location.textRange.startLine, index }))\n        : [];\n      return [...locations, ...linearLocations];\n    }, []);\n  };\n\n  renderLine = ({\n    line,\n    index,\n    displayCoverage,\n    displayDuplications,\n    displayIssues\n  }: {\n    line: SourceLine;\n    index: number;\n    displayCoverage: boolean;\n    displayDuplications: boolean;\n    displayIssues: boolean;\n  }) => {\n    const { filterLine, highlightedLocationMessage, selectedIssue, sources } = this.props;\n    const filtered = filterLine && filterLine(line);\n\n    const secondaryIssueLocations = this.getSecondaryIssueLocationsForLine(line);\n\n    const duplicationsCount = this.props.duplications ? this.props.duplications.length : 0;\n\n    const issuesForLine = this.getIssuesForLine(line);\n\n    // for the following properties pass null if the line for sure is not impacted\n    const symbolsForLine = this.props.symbolsByLine[line.line] || [];\n    const { highlightedSymbols } = this.props;\n    let optimizedHighlightedSymbols: string[] | undefined = intersection(\n      symbolsForLine,\n      highlightedSymbols\n    );\n    if (!optimizedHighlightedSymbols.length) {\n      optimizedHighlightedSymbols = undefined;\n    }\n\n    const optimizedSelectedIssue =\n      selectedIssue !== undefined && issuesForLine.find(issue => issue.key === selectedIssue)\n        ? selectedIssue\n        : undefined;\n\n    const optimizedSecondaryIssueLocations =\n      secondaryIssueLocations.length > 0 ? secondaryIssueLocations : EMPTY_ARRAY;\n\n    const optimizedLocationMessage =\n      highlightedLocationMessage != null &&\n      optimizedSecondaryIssueLocations.some(\n        location => location.index === highlightedLocationMessage.index\n      )\n        ? highlightedLocationMessage\n        : undefined;\n\n    return (\n      <Line\n        branchLike={this.props.branchLike}\n        componentKey={this.props.componentKey}\n        displayAllIssues={this.props.displayAllIssues}\n        displayCoverage={displayCoverage}\n        displayDuplications={displayDuplications}\n        displayIssueLocationsCount={this.props.displayIssueLocationsCount}\n        displayIssueLocationsLink={this.props.displayIssueLocationsLink}\n        displayIssues={displayIssues}\n        displayLocationMarkers={this.props.displayLocationMarkers}\n        duplications={this.getDuplicationsForLine(line)}\n        duplicationsCount={duplicationsCount}\n        filtered={filtered}\n        highlighted={line.line === this.props.highlightedLine}\n        highlightedLocationMessage={optimizedLocationMessage}\n        highlightedSymbols={optimizedHighlightedSymbols}\n        issueLocations={this.getIssueLocationsForLine(line)}\n        issuePopup={this.props.issuePopup}\n        issues={issuesForLine}\n        key={line.line}\n        last={index === this.props.sources.length - 1 && !this.props.hasSourcesAfter}\n        line={line}\n        linePopup={this.props.linePopup}\n        loadDuplications={this.props.loadDuplications}\n        onIssueChange={this.props.onIssueChange}\n        onIssuePopupToggle={this.props.onIssuePopupToggle}\n        onIssueSelect={this.props.onIssueSelect}\n        onIssueUnselect={this.props.onIssueUnselect}\n        onIssuesClose={this.props.onIssuesClose}\n        onIssuesOpen={this.props.onIssuesOpen}\n        onLinePopupToggle={this.props.onLinePopupToggle}\n        onLocationSelect={this.props.onLocationSelect}\n        onSymbolClick={this.props.onSymbolClick}\n        openIssues={this.props.openIssuesByLine[line.line] || false}\n        previousLine={index > 0 ? sources[index - 1] : undefined}\n        renderDuplicationPopup={this.props.renderDuplicationPopup}\n        scroll={this.props.scroll}\n        secondaryIssueLocations={optimizedSecondaryIssueLocations}\n        selectedIssue={optimizedSelectedIssue}\n      />\n    );\n  };\n\n  render() {\n    const { issues = [], sources } = this.props;\n\n    const displayCoverage = sources.some(s => s.coverageStatus != null);\n    const displayDuplications = sources.some(s => !!s.duplicated);\n    const displayIssues = issues.length > 0;\n\n    const hasFileIssues = displayIssues && issues.some(issue => !issue.textRange);\n\n    return (\n      <div>\n        {this.props.hasSourcesBefore && (\n          <div className=\"source-viewer-more-code\">\n            {this.props.loadingSourcesBefore ? (\n              <div className=\"js-component-viewer-loading-before\">\n                <i className=\"spinner\" />\n                <span className=\"note spacer-left\">\n                  {translate('source_viewer.loading_more_code')}\n                </span>\n              </div>\n            ) : (\n              <Button\n                className=\"js-component-viewer-source-before\"\n                onClick={this.props.loadSourcesBefore}>\n                {translate('source_viewer.load_more_code')}\n              </Button>\n            )}\n          </div>\n        )}\n\n        <table className=\"source-table\">\n          <tbody>\n            {hasFileIssues &&\n              this.renderLine({\n                line: ZERO_LINE,\n                index: -1,\n                displayCoverage,\n                displayDuplications,\n                displayIssues\n              })}\n            {sources.map((line, index) =>\n              this.renderLine({ line, index, displayCoverage, displayDuplications, displayIssues })\n            )}\n          </tbody>\n        </table>\n\n        {this.props.hasSourcesAfter && (\n          <div className=\"source-viewer-more-code\">\n            {this.props.loadingSourcesAfter ? (\n              <div className=\"js-component-viewer-loading-after\">\n                <i className=\"spinner\" />\n                <span className=\"note spacer-left\">\n                  {translate('source_viewer.loading_more_code')}\n                </span>\n              </div>\n            ) : (\n              <Button\n                className=\"js-component-viewer-source-after\"\n                onClick={this.props.loadSourcesAfter}>\n                {translate('source_viewer.load_more_code')}\n              </Button>\n            )}\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport * as PropTypes from 'prop-types';\nimport { groupBy, sortBy } from 'lodash';\nimport { BranchLike, DuplicatedFile, DuplicationBlock, SourceViewerFile } from '../../../app/types';\nimport BubblePopup from '../../common/BubblePopup';\nimport QualifierIcon from '../../shared/QualifierIcon';\nimport { WorkspaceContext } from '../../workspace/context';\nimport { translate } from '../../../helpers/l10n';\nimport { collapsedDirFromPath, fileFromPath } from '../../../helpers/path';\nimport { getProjectUrl } from '../../../helpers/urls';\n\ninterface Props {\n  blocks: DuplicationBlock[];\n  branchLike: BranchLike | undefined;\n  duplicatedFiles?: { [ref: string]: DuplicatedFile };\n  inRemovedComponent: boolean;\n  onClose: () => void;\n  popupPosition?: any;\n  sourceViewerFile: SourceViewerFile;\n}\n\nexport default class DuplicationPopup extends React.PureComponent<Props> {\n  context!: { workspace: WorkspaceContext };\n\n  static contextTypes = {\n    workspace: PropTypes.object.isRequired\n  };\n\n  isDifferentComponent = (\n    a: { project: string; subProject?: string },\n    b: { project: string; subProject?: string }\n  ) => {\n    return Boolean(a && b && (a.project !== b.project || a.subProject !== b.subProject));\n  };\n\n  handleFileClick = (event: React.MouseEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    const { key, line } = event.currentTarget.dataset;\n    if (key) {\n      this.context.workspace.openComponent({\n        branchLike: this.props.branchLike,\n        key,\n        line: line ? Number(line) : undefined\n      });\n    }\n    this.props.onClose();\n  };\n\n  render() {\n    const { duplicatedFiles = {}, sourceViewerFile } = this.props;\n\n    const groupedBlocks = groupBy(this.props.blocks, '_ref');\n    let duplications = Object.keys(groupedBlocks).map(fileRef => {\n      return {\n        blocks: groupedBlocks[fileRef],\n        file: duplicatedFiles[fileRef]\n      };\n    });\n\n    // first duplications in the same file\n    // then duplications in the same sub-project\n    // then duplications in the same project\n    // then duplications in other projects\n    duplications = sortBy(\n      duplications,\n      d => d.file.projectName !== sourceViewerFile.projectName,\n      d => d.file.subProjectName !== sourceViewerFile.subProjectName,\n      d => d.file.key !== sourceViewerFile.key\n    );\n\n    return (\n      <BubblePopup customClass=\"source-viewer-bubble-popup\" position={this.props.popupPosition}>\n        <div className=\"bubble-popup-container\">\n          {this.props.inRemovedComponent && (\n            <div className=\"alert alert-warning\">\n              {translate('duplications.dups_found_on_deleted_resource')}\n            </div>\n          )}\n          {duplications.length > 0 && (\n            <>\n              <div className=\"bubble-popup-title\">\n                {translate('component_viewer.transition.duplication')}\n              </div>\n              {duplications.map(duplication => (\n                <div className=\"bubble-popup-section\" key={duplication.file.key}>\n                  <div className=\"component-name\">\n                    {this.isDifferentComponent(duplication.file, this.props.sourceViewerFile) && (\n                      <>\n                        <div className=\"component-name-parent\">\n                          <QualifierIcon className=\"little-spacer-right\" qualifier=\"TRK\" />\n                          <Link to={getProjectUrl(duplication.file.project)}>\n                            {duplication.file.projectName}\n                          </Link>\n                        </div>\n                        {duplication.file.subProject &&\n                          duplication.file.subProjectName && (\n                            <div className=\"component-name-parent\">\n                              <QualifierIcon className=\"little-spacer-right\" qualifier=\"BRC\" />\n                              <Link to={getProjectUrl(duplication.file.subProject)}>\n                                {duplication.file.subProjectName}\n                              </Link>\n                            </div>\n                          )}\n                      </>\n                    )}\n\n                    {duplication.file.key !== this.props.sourceViewerFile.key && (\n                      <div className=\"component-name-path\">\n                        <a\n                          className=\"link-action\"\n                          data-key={duplication.file.key}\n                          href=\"#\"\n                          onClick={this.handleFileClick}\n                          title={duplication.file.name}>\n                          <span>{collapsedDirFromPath(duplication.file.name)}</span>\n                          <span className=\"component-name-file\">\n                            {fileFromPath(duplication.file.name)}\n                          </span>\n                        </a>\n                      </div>\n                    )}\n\n                    <div className=\"component-name-path\">\n                      {'Lines: '}\n                      {duplication.blocks.map((block, index) => (\n                        <React.Fragment key={index}>\n                          <a\n                            data-key={duplication.file.key}\n                            data-line={block.from}\n                            href=\"#\"\n                            onClick={this.handleFileClick}>\n                            {block.from}\n                            {' – '}\n                            {block.from + block.size - 1}\n                          </a>\n                          {index < duplication.blocks.length - 1 && ', '}\n                        </React.Fragment>\n                      ))}\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </>\n          )}\n        </div>\n      </BubblePopup>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { searchIssues } from '../../../api/issues';\nimport { BranchLike, Issue } from '../../../app/types';\nimport { getBranchLikeQuery } from '../../../helpers/branches';\nimport { parseIssueFromResponse } from '../../../helpers/issues';\nimport { RawQuery } from '../../../helpers/query';\n\n// maximum possible value\nconst PAGE_SIZE = 500;\n\nfunction buildQuery(component: string, branchLike: BranchLike | undefined) {\n  return {\n    additionalFields: '_all',\n    resolved: 'false',\n    componentKeys: component,\n    s: 'FILE_LINE',\n    ...getBranchLikeQuery(branchLike)\n  };\n}\n\nexport function loadPage(query: RawQuery, page: number, pageSize = PAGE_SIZE): Promise<Issue[]> {\n  return searchIssues({\n    ...query,\n    p: page,\n    ps: pageSize\n  }).then(r =>\n    r.issues.map(issue => parseIssueFromResponse(issue, r.components, r.users, r.rules))\n  );\n}\n\nexport function loadPageAndNext(\n  query: RawQuery,\n  toLine: number,\n  page: number,\n  pageSize = PAGE_SIZE\n): Promise<Issue[]> {\n  return loadPage(query, page).then(issues => {\n    if (issues.length === 0) {\n      return [];\n    }\n\n    const lastIssue = issues[issues.length - 1];\n\n    if (\n      (lastIssue.textRange != null && lastIssue.textRange.endLine > toLine) ||\n      issues.length < pageSize\n    ) {\n      return issues;\n    }\n\n    return loadPageAndNext(query, toLine, page + 1, pageSize).then(nextIssues => {\n      return [...issues, ...nextIssues];\n    });\n  });\n}\n\nexport default function loadIssues(\n  component: string,\n  _fromLine: number,\n  toLine: number,\n  branchLike: BranchLike | undefined\n): Promise<Issue[]> {\n  const query = buildQuery(component, branchLike);\n  return new Promise(resolve => {\n    loadPageAndNext(query, toLine, 1).then(issues => {\n      resolve(issues);\n    });\n  });\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { flatten } from 'lodash';\nimport { splitByTokens } from './highlight';\nimport { getLinearLocations } from './issueLocations';\nimport { Duplication, Issue, LinearIssueLocation, SourceLine } from '../../../app/types';\n\nexport function issuesByLine(issues: Issue[]) {\n  const index: { [line: number]: Issue[] } = {};\n  issues.forEach(issue => {\n    const line = issue.textRange ? issue.textRange.endLine : 0;\n    if (!(line in index)) {\n      index[line] = [];\n    }\n    index[line].push(issue);\n  });\n  return index;\n}\n\nexport function locationsByLine(issues: Issue[]) {\n  const index: { [line: number]: LinearIssueLocation[] } = {};\n  issues.forEach(issue => {\n    getLinearLocations(issue.textRange).forEach(location => {\n      if (!(location.line in index)) {\n        index[location.line] = [];\n      }\n      index[location.line].push(location);\n    });\n  });\n  return index;\n}\n\nexport function duplicationsByLine(duplications: Duplication[] | undefined) {\n  if (duplications == null) {\n    return {};\n  }\n\n  const duplicationsByLine: { [line: number]: number[] } = {};\n\n  duplications.forEach(({ blocks }, duplicationIndex) => {\n    blocks.forEach(block => {\n      // eslint-disable-next-line no-underscore-dangle\n      if (block._ref === '1') {\n        for (let line = block.from; line < block.from + block.size; line++) {\n          if (!(line in duplicationsByLine)) {\n            duplicationsByLine[line] = [];\n          }\n          duplicationsByLine[line].push(duplicationIndex);\n        }\n      }\n    });\n  });\n\n  return duplicationsByLine;\n}\n\nexport function symbolsByLine(sources: SourceLine[]) {\n  const index: { [line: number]: string[] } = {};\n  sources.forEach(line => {\n    const tokens = splitByTokens(line.code || '');\n    const symbols = flatten(\n      tokens.map(token => {\n        const keys = token.className.match(/sym-\\d+/g);\n        return keys != null ? keys : [];\n      })\n    );\n    index[line.line] = symbols.filter(key => key);\n  });\n  return index;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\nimport { intersection, uniqBy } from 'lodash';\nimport SourceViewerHeader from './SourceViewerHeader';\nimport SourceViewerCode from './SourceViewerCode';\nimport DuplicationPopup from './components/DuplicationPopup';\nimport defaultLoadIssues from './helpers/loadIssues';\nimport getCoverageStatus from './helpers/getCoverageStatus';\nimport {\n  duplicationsByLine,\n  issuesByLine,\n  locationsByLine,\n  symbolsByLine\n} from './helpers/indexing';\nimport {\n  getComponentData,\n  getComponentForSourceViewer,\n  getDuplications,\n  getSources\n} from '../../api/components';\nimport {\n  BranchLike,\n  DuplicatedFile,\n  Duplication,\n  FlowLocation,\n  Issue,\n  LinearIssueLocation,\n  SourceLine,\n  SourceViewerFile\n} from '../../app/types';\nimport { isSameBranchLike, getBranchLikeQuery } from '../../helpers/branches';\nimport { parseDate } from '../../helpers/dates';\nimport { translate } from '../../helpers/l10n';\nimport './styles.css';\n\n// TODO react-virtualized\n\ninterface Props {\n  aroundLine?: number;\n  branchLike: BranchLike | undefined;\n  component: string;\n  displayAllIssues?: boolean;\n  displayIssueLocationsCount?: boolean;\n  displayIssueLocationsLink?: boolean;\n  displayLocationMarkers?: boolean;\n  highlightedLine?: number;\n  // `undefined` elements mean they are located in a different file,\n  // but kept to maintaint the location indexes\n  highlightedLocations?: (FlowLocation | undefined)[];\n  highlightedLocationMessage?: { index: number; text: string | undefined };\n  loadComponent?: (\n    component: string,\n    branchLike: BranchLike | undefined\n  ) => Promise<SourceViewerFile>;\n  loadIssues?: (\n    component: string,\n    from: number,\n    to: number,\n    branchLike: BranchLike | undefined\n  ) => Promise<Issue[]>;\n  loadSources?: (\n    component: string,\n    from: number,\n    to: number,\n    branchLike: BranchLike | undefined\n  ) => Promise<SourceLine[]>;\n  onLoaded?: (component: SourceViewerFile, sources: SourceLine[], issues: Issue[]) => void;\n  onLocationSelect?: (index: number) => void;\n  onIssueChange?: (issue: Issue) => void;\n  onIssueSelect?: (issueKey: string) => void;\n  onIssueUnselect?: () => void;\n  onReceiveComponent: (component: SourceViewerFile) => void;\n  scroll?: (element: HTMLElement) => void;\n  selectedIssue?: string;\n}\n\ninterface State {\n  component?: SourceViewerFile;\n  displayDuplications: boolean;\n  duplicatedFiles?: { [ref: string]: DuplicatedFile };\n  duplications?: Duplication[];\n  duplicationsByLine: { [line: number]: number[] };\n  hasSourcesAfter: boolean;\n  highlightedSymbols: string[];\n  issueLocationsByLine: { [line: number]: LinearIssueLocation[] };\n  issuePopup?: { issue: string; name: string };\n  issues?: Issue[];\n  issuesByLine: { [line: number]: Issue[] };\n  linePopup?: { index?: number; line: number; name: string };\n  loading: boolean;\n  loadingSourcesAfter: boolean;\n  loadingSourcesBefore: boolean;\n  notAccessible: boolean;\n  notExist: boolean;\n  openIssuesByLine: { [line: number]: boolean };\n  selectedIssue?: string;\n  sourceRemoved: boolean;\n  sources?: SourceLine[];\n  symbolsByLine: { [line: number]: string[] };\n}\n\nconst LINES = 500;\n\nexport default class SourceViewerBase extends React.PureComponent<Props, State> {\n  node?: HTMLElement | null;\n  mounted = false;\n\n  static defaultProps = {\n    displayAllIssues: false,\n    displayIssueLocationsCount: true,\n    displayIssueLocationsLink: true,\n    displayLocationMarkers: true\n  };\n\n  constructor(props: Props) {\n    super(props);\n\n    this.state = {\n      displayDuplications: false,\n      duplicationsByLine: {},\n      hasSourcesAfter: false,\n      highlightedSymbols: [],\n      issuesByLine: {},\n      issueLocationsByLine: {},\n      loading: true,\n      loadingSourcesAfter: false,\n      loadingSourcesBefore: false,\n      notAccessible: false,\n      notExist: false,\n      openIssuesByLine: {},\n      selectedIssue: props.selectedIssue,\n      sourceRemoved: false,\n      symbolsByLine: {}\n    };\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n    this.fetchComponent();\n  }\n\n  componentWillReceiveProps(nextProps: Props) {\n    // if a component or a branch has changed,\n    // set `loading: true` immediately to avoid unwanted scrolling in `LineCode`\n    if (\n      nextProps.component !== this.props.component ||\n      !isSameBranchLike(nextProps.branchLike, this.props.branchLike)\n    ) {\n      this.setState({ loading: true });\n    }\n    if (\n      nextProps.onIssueSelect !== undefined &&\n      nextProps.selectedIssue !== this.props.selectedIssue\n    ) {\n      this.setState({ selectedIssue: nextProps.selectedIssue });\n    }\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (\n      prevProps.component !== this.props.component ||\n      !isSameBranchLike(prevProps.branchLike, this.props.branchLike)\n    ) {\n      this.fetchComponent();\n    } else if (\n      this.props.aroundLine !== undefined &&\n      prevProps.aroundLine !== this.props.aroundLine &&\n      this.isLineOutsideOfRange(this.props.aroundLine)\n    ) {\n      this.fetchSources();\n    } else {\n      const { selectedIssue } = this.props;\n      const { issues } = this.state;\n      if (\n        selectedIssue !== undefined &&\n        issues !== undefined &&\n        issues.find(issue => issue.key === selectedIssue) === undefined\n      ) {\n        this.reloadIssues();\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  // react typings do not take `defaultProps` into account,\n  // so use these getters to get type-safe methods\n\n  get safeLoadComponent() {\n    return this.props.loadComponent || defaultLoadComponent;\n  }\n\n  get safeLoadIssues() {\n    return this.props.loadIssues || defaultLoadIssues;\n  }\n\n  get safeLoadSources() {\n    return this.props.loadSources || defaultLoadSources;\n  }\n\n  computeCoverageStatus(lines: SourceLine[]) {\n    return lines.map(line => ({ ...line, coverageStatus: getCoverageStatus(line) }));\n  }\n\n  isLineOutsideOfRange(lineNumber: number) {\n    const { sources } = this.state;\n    if (sources && sources.length > 0) {\n      const firstLine = sources[0];\n      const lastList = sources[sources.length - 1];\n      return lineNumber < firstLine.line || lineNumber > lastList.line;\n    } else {\n      return true;\n    }\n  }\n\n  fetchComponent() {\n    this.setState({ loading: true });\n    const loadIssues = (component: SourceViewerFile, sources: SourceLine[]) => {\n      this.safeLoadIssues(this.props.component, 1, LINES, this.props.branchLike).then(\n        issues => {\n          if (this.mounted) {\n            const finalSources = sources.slice(0, LINES);\n\n            this.setState(\n              {\n                component,\n                displayDuplications: false,\n                duplicatedFiles: undefined,\n                duplications: undefined,\n                duplicationsByLine: {},\n                hasSourcesAfter: sources.length > LINES,\n                highlightedSymbols: [],\n                issueLocationsByLine: locationsByLine(issues),\n                issues,\n                issuesByLine: issuesByLine(issues),\n                linePopup: undefined,\n                loading: false,\n                notAccessible: false,\n                notExist: false,\n                openIssuesByLine: {},\n                issuePopup: undefined,\n                sourceRemoved: false,\n                sources: this.computeCoverageStatus(finalSources),\n                symbolsByLine: symbolsByLine(sources.slice(0, LINES))\n              },\n              () => {\n                if (this.props.onLoaded) {\n                  this.props.onLoaded(component, finalSources, issues);\n                }\n              }\n            );\n          }\n        },\n        () => {\n          // TODO\n        }\n      );\n    };\n\n    const onFailLoadComponent = ({ response }: { response: Response }) => {\n      // TODO handle other statuses\n      if (this.mounted) {\n        if (response.status === 403) {\n          this.setState({ loading: false, notAccessible: true });\n        } else if (response.status === 404) {\n          this.setState({ loading: false, notExist: true });\n        }\n      }\n    };\n\n    const onFailLoadSources = (response: Response, component: SourceViewerFile) => {\n      // TODO handle other statuses\n      if (this.mounted) {\n        if (response.status === 403) {\n          this.setState({ component, loading: false, notAccessible: true });\n        } else if (response.status === 404) {\n          this.setState({ component, loading: false, sourceRemoved: true });\n        }\n      }\n    };\n\n    const onResolve = (component: SourceViewerFile) => {\n      this.props.onReceiveComponent(component);\n      const sourcesRequest =\n        component.q === 'FIL' || component.q === 'UTS' ? this.loadSources() : Promise.resolve([]);\n      sourcesRequest.then(\n        sources => loadIssues(component, sources),\n        response => onFailLoadSources(response, component)\n      );\n    };\n\n    this.safeLoadComponent(this.props.component, this.props.branchLike).then(\n      onResolve,\n      onFailLoadComponent\n    );\n  }\n\n  fetchSources() {\n    this.loadSources().then(\n      sources => {\n        if (this.mounted) {\n          const finalSources = sources.slice(0, LINES);\n          this.setState(\n            {\n              sources: sources.slice(0, LINES),\n              hasSourcesAfter: sources.length > LINES\n            },\n            () => {\n              if (this.props.onLoaded && this.state.component && this.state.issues) {\n                this.props.onLoaded(this.state.component, finalSources, this.state.issues);\n              }\n            }\n          );\n        }\n      },\n      () => {\n        // TODO\n      }\n    );\n  }\n\n  reloadIssues() {\n    if (!this.state.sources) {\n      return;\n    }\n    const firstSourceLine = this.state.sources[0];\n    const lastSourceLine = this.state.sources[this.state.sources.length - 1];\n    this.safeLoadIssues(\n      this.props.component,\n      firstSourceLine && firstSourceLine.line,\n      lastSourceLine && lastSourceLine.line,\n      this.props.branchLike\n    ).then(\n      issues => {\n        if (this.mounted) {\n          this.setState({\n            issues,\n            issuesByLine: issuesByLine(issues),\n            issueLocationsByLine: locationsByLine(issues)\n          });\n        }\n      },\n      () => {\n        // TODO\n      }\n    );\n  }\n\n  loadSources = (): Promise<SourceLine[]> => {\n    return new Promise((resolve, reject) => {\n      const onFailLoadSources = ({ response }: { response: Response }) => {\n        // TODO handle other statuses\n        if (this.mounted) {\n          if ([403, 404].includes(response.status)) {\n            reject(response);\n          } else {\n            resolve([]);\n          }\n        }\n      };\n\n      const from = this.props.aroundLine ? Math.max(1, this.props.aroundLine - LINES / 2 + 1) : 1;\n\n      let to = this.props.aroundLine ? this.props.aroundLine + LINES / 2 + 1 : LINES + 1;\n      // make sure we try to download `LINES` lines\n      if (from === 1 && to < LINES) {\n        to = LINES;\n      }\n      // request one additional line to define `hasSourcesAfter`\n      to++;\n\n      return this.safeLoadSources(this.props.component, from, to, this.props.branchLike).then(\n        sources => resolve(sources),\n        onFailLoadSources\n      );\n    });\n  };\n\n  loadSourcesBefore = () => {\n    if (!this.state.sources) {\n      return;\n    }\n    const firstSourceLine = this.state.sources[0];\n    this.setState({ loadingSourcesBefore: true });\n    const from = Math.max(1, firstSourceLine.line - LINES);\n    this.safeLoadSources(\n      this.props.component,\n      from,\n      firstSourceLine.line - 1,\n      this.props.branchLike\n    ).then(\n      sources => {\n        this.safeLoadIssues(\n          this.props.component,\n          from,\n          firstSourceLine.line - 1,\n          this.props.branchLike\n        ).then(\n          issues => {\n            if (this.mounted) {\n              this.setState(prevState => {\n                const nextIssues = uniqBy(\n                  [...issues, ...(prevState.issues || [])],\n                  issue => issue.key\n                );\n                return {\n                  issues: nextIssues,\n                  issuesByLine: issuesByLine(nextIssues),\n                  issueLocationsByLine: locationsByLine(nextIssues),\n                  loadingSourcesBefore: false,\n                  sources: [...this.computeCoverageStatus(sources), ...(prevState.sources || [])],\n                  symbolsByLine: { ...prevState.symbolsByLine, ...symbolsByLine(sources) }\n                };\n              });\n            }\n          },\n          () => {\n            // TODO\n          }\n        );\n      },\n      () => {\n        // TODO\n      }\n    );\n  };\n\n  loadSourcesAfter = () => {\n    if (!this.state.sources) {\n      return;\n    }\n    const lastSourceLine = this.state.sources[this.state.sources.length - 1];\n    this.setState({ loadingSourcesAfter: true });\n    const fromLine = lastSourceLine.line + 1;\n    // request one additional line to define `hasSourcesAfter`\n    const toLine = lastSourceLine.line + LINES + 1;\n    this.safeLoadSources(this.props.component, fromLine, toLine, this.props.branchLike).then(\n      sources => {\n        this.safeLoadIssues(this.props.component, fromLine, toLine, this.props.branchLike).then(\n          issues => {\n            if (this.mounted) {\n              this.setState(prevState => {\n                const nextIssues = uniqBy(\n                  [...(prevState.issues || []), ...issues],\n                  issue => issue.key\n                );\n                return {\n                  issues: nextIssues,\n                  issuesByLine: issuesByLine(nextIssues),\n                  issueLocationsByLine: locationsByLine(nextIssues),\n                  hasSourcesAfter: sources.length > LINES,\n                  loadingSourcesAfter: false,\n                  sources: [\n                    ...(prevState.sources || []),\n                    ...this.computeCoverageStatus(sources.slice(0, LINES))\n                  ],\n                  symbolsByLine: {\n                    ...prevState.symbolsByLine,\n                    ...symbolsByLine(sources.slice(0, LINES))\n                  }\n                };\n              });\n            }\n          },\n          () => {\n            // TODO\n          }\n        );\n      },\n      () => {\n        // TODO\n      }\n    );\n  };\n\n  loadDuplications = (line: SourceLine) => {\n    getDuplications({\n      key: this.props.component,\n      ...getBranchLikeQuery(this.props.branchLike)\n    }).then(\n      r => {\n        if (this.mounted) {\n          this.setState(() => {\n            const changes: Partial<State> = {\n              displayDuplications: true,\n              duplications: r.duplications,\n              duplicationsByLine: duplicationsByLine(r.duplications),\n              duplicatedFiles: r.files\n            };\n            if (r.duplications.length === 1) {\n              changes.linePopup = { index: 0, line: line.line, name: 'duplications' };\n            }\n            return changes;\n          });\n        }\n      },\n      () => {\n        // TODO\n      }\n    );\n  };\n\n  handleLinePopupToggle = ({\n    index,\n    line,\n    name,\n    open\n  }: {\n    index?: number;\n    line: number;\n    name: string;\n    open?: boolean;\n  }) => {\n    this.setState((state: State) => {\n      const samePopup =\n        state.linePopup !== undefined &&\n        state.linePopup.name === name &&\n        state.linePopup.line === line &&\n        state.linePopup.index === index;\n      if (open !== false && !samePopup) {\n        return { linePopup: { index, line, name } };\n      } else if (open !== true && samePopup) {\n        return { linePopup: undefined };\n      }\n      return null;\n    });\n  };\n\n  closeLinePopup = () => {\n    this.setState({ linePopup: undefined });\n  };\n\n  handleIssuePopupToggle = (issue: string, popupName: string, open?: boolean) => {\n    this.setState((state: State) => {\n      const samePopup =\n        state.issuePopup && state.issuePopup.name === popupName && state.issuePopup.issue === issue;\n      if (open !== false && !samePopup) {\n        return { issuePopup: { issue, name: popupName } };\n      } else if (open !== true && samePopup) {\n        return { issuePopup: undefined };\n      }\n      return null;\n    });\n  };\n\n  handleSymbolClick = (symbols: string[]) => {\n    this.setState(state => {\n      const shouldDisable = intersection(state.highlightedSymbols, symbols).length > 0;\n      const highlightedSymbols = shouldDisable ? [] : symbols;\n      return { highlightedSymbols };\n    });\n  };\n\n  handleIssueSelect = (issue: string) => {\n    if (this.props.onIssueSelect) {\n      this.props.onIssueSelect(issue);\n    } else {\n      this.setState({ selectedIssue: issue });\n    }\n  };\n\n  handleIssueUnselect = () => {\n    if (this.props.onIssueUnselect) {\n      this.props.onIssueUnselect();\n    } else {\n      this.setState({ selectedIssue: undefined });\n    }\n  };\n\n  handleOpenIssues = (line: SourceLine) => {\n    this.setState(state => ({\n      openIssuesByLine: { ...state.openIssuesByLine, [line.line]: true }\n    }));\n  };\n\n  handleCloseIssues = (line: SourceLine) => {\n    this.setState(state => ({\n      openIssuesByLine: { ...state.openIssuesByLine, [line.line]: false }\n    }));\n  };\n\n  handleIssueChange = (issue: Issue) => {\n    this.setState(({ issues = [] }) => {\n      const newIssues = issues.map(candidate => (candidate.key === issue.key ? issue : candidate));\n      return { issues: newIssues, issuesByLine: issuesByLine(newIssues) };\n    });\n    if (this.props.onIssueChange) {\n      this.props.onIssueChange(issue);\n    }\n  };\n\n  handleFilterLine = (line: SourceLine) => {\n    const { component } = this.state;\n    const leakPeriodDate = component && component.leakPeriodDate;\n    return leakPeriodDate\n      ? line.scmDate !== undefined && parseDate(line.scmDate) > parseDate(leakPeriodDate)\n      : false;\n  };\n\n  renderDuplicationPopup = (index: number, line: number) => {\n    const { component, duplicatedFiles, duplications } = this.state;\n\n    if (!component || !duplicatedFiles) return <></>;\n\n    const duplication = duplications && duplications[index];\n    let blocks = (duplication && duplication.blocks) || [];\n    /* eslint-disable no-underscore-dangle */\n    const inRemovedComponent = blocks.some(b => b._ref === undefined);\n    let foundOne = false;\n    blocks = blocks.filter(b => {\n      const outOfBounds = b.from > line || b.from + b.size < line;\n      const currentFile = b._ref === '1';\n      const shouldDisplayForCurrentFile = outOfBounds || foundOne;\n      const shouldDisplay = !currentFile || shouldDisplayForCurrentFile;\n      const isOk = b._ref !== undefined && shouldDisplay;\n      if (b._ref === '1' && !outOfBounds) {\n        foundOne = true;\n      }\n      return isOk;\n    });\n    /* eslint-enable no-underscore-dangle */\n\n    return (\n      <DuplicationPopup\n        blocks={blocks}\n        branchLike={this.props.branchLike}\n        duplicatedFiles={duplicatedFiles}\n        inRemovedComponent={inRemovedComponent}\n        onClose={this.closeLinePopup}\n        sourceViewerFile={component}\n      />\n    );\n  };\n\n  renderCode(sources: SourceLine[]) {\n    const hasSourcesBefore = sources.length > 0 && sources[0].line > 1;\n    return (\n      <SourceViewerCode\n        branchLike={this.props.branchLike}\n        componentKey={this.props.component}\n        displayAllIssues={this.props.displayAllIssues}\n        displayIssueLocationsCount={this.props.displayIssueLocationsCount}\n        displayIssueLocationsLink={this.props.displayIssueLocationsLink}\n        displayLocationMarkers={this.props.displayLocationMarkers}\n        duplications={this.state.duplications}\n        duplicationsByLine={this.state.duplicationsByLine}\n        filterLine={this.handleFilterLine}\n        hasSourcesAfter={this.state.hasSourcesAfter}\n        hasSourcesBefore={hasSourcesBefore}\n        highlightedLine={this.props.highlightedLine}\n        highlightedLocationMessage={this.props.highlightedLocationMessage}\n        highlightedLocations={this.props.highlightedLocations}\n        highlightedSymbols={this.state.highlightedSymbols}\n        issueLocationsByLine={this.state.issueLocationsByLine}\n        issuePopup={this.state.issuePopup}\n        issues={this.state.issues}\n        issuesByLine={this.state.issuesByLine}\n        linePopup={this.state.linePopup}\n        loadDuplications={this.loadDuplications}\n        loadSourcesAfter={this.loadSourcesAfter}\n        loadSourcesBefore={this.loadSourcesBefore}\n        loadingSourcesAfter={this.state.loadingSourcesAfter}\n        loadingSourcesBefore={this.state.loadingSourcesBefore}\n        onIssueChange={this.handleIssueChange}\n        onIssuePopupToggle={this.handleIssuePopupToggle}\n        onIssueSelect={this.handleIssueSelect}\n        onIssueUnselect={this.handleIssueUnselect}\n        onIssuesClose={this.handleCloseIssues}\n        onIssuesOpen={this.handleOpenIssues}\n        onLinePopupToggle={this.handleLinePopupToggle}\n        onLocationSelect={this.props.onLocationSelect}\n        onSymbolClick={this.handleSymbolClick}\n        openIssuesByLine={this.state.openIssuesByLine}\n        renderDuplicationPopup={this.renderDuplicationPopup}\n        scroll={this.props.scroll}\n        selectedIssue={this.state.selectedIssue}\n        sources={sources}\n        symbolsByLine={this.state.symbolsByLine}\n      />\n    );\n  }\n\n  render() {\n    const { component, loading, sources, notAccessible, sourceRemoved } = this.state;\n\n    if (loading) {\n      return null;\n    }\n\n    if (this.state.notExist) {\n      return (\n        <div className=\"alert alert-warning spacer-top\">\n          {translate('component_viewer.no_component')}\n        </div>\n      );\n    }\n\n    if (notAccessible) {\n      return (\n        <div className=\"alert alert-warning spacer-top\">\n          {translate('code_viewer.no_source_code_displayed_due_to_security')}\n        </div>\n      );\n    }\n\n    if (!component) {\n      return null;\n    }\n\n    const className = classNames('source-viewer', {\n      'source-duplications-expanded': this.state.displayDuplications\n    });\n\n    return (\n      <div className={className} ref={node => (this.node = node)}>\n        {this.state.component && (\n          <SourceViewerHeader\n            branchLike={this.props.branchLike}\n            sourceViewerFile={this.state.component}\n          />\n        )}\n        {sourceRemoved && (\n          <div className=\"alert alert-warning spacer-top\">\n            {translate('code_viewer.no_source_code_displayed_due_to_source_removed')}\n          </div>\n        )}\n        {!sourceRemoved && sources !== undefined && this.renderCode(sources)}\n      </div>\n    );\n  }\n}\n\nfunction defaultLoadComponent(key: string, branchLike: BranchLike | undefined) {\n  return Promise.all([\n    getComponentForSourceViewer({ component: key, ...getBranchLikeQuery(branchLike) }),\n    getComponentData({ component: key, ...getBranchLikeQuery(branchLike) })\n  ]).then(([component, data]) => ({\n    ...component,\n    leakPeriodDate: data.leakPeriodDate && parseDate(data.leakPeriodDate)\n  }));\n}\n\nfunction defaultLoadSources(\n  key: string,\n  from: number | undefined,\n  to: number | undefined,\n  branchLike: BranchLike | undefined\n) {\n  return getSources({ key, from, to, ...getBranchLikeQuery(branchLike) });\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { SourceLine } from '../../../app/types';\n\nexport default function getCoverageStatus(s: SourceLine): string | undefined {\n  let status: string | undefined;\n  if (s.lineHits != null && s.lineHits > 0) {\n    status = 'partially-covered';\n  }\n  if (s.lineHits != null && s.lineHits > 0 && s.conditions === s.coveredConditions) {\n    status = 'covered';\n  }\n  if (s.lineHits === 0 || s.coveredConditions === 0) {\n    status = 'uncovered';\n  }\n  return status;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { Dispatch } from 'redux';\nimport { connect } from 'react-redux';\nimport SourceViewerBase from './SourceViewerBase';\nimport { SourceViewerFile } from '../../app/types';\nimport { receiveFavorites } from '../../store/favorites/duck';\n\nconst mapStateToProps = null;\n\ninterface DispatchProps {\n  onReceiveComponent: (component: SourceViewerFile) => void;\n}\n\nconst onReceiveComponent = (component: SourceViewerFile) => (dispatch: Dispatch<any>) => {\n  if (component.canMarkAsFavorite) {\n    const favorites = [];\n    const notFavorites = [];\n    if (component.fav) {\n      favorites.push({ key: component.key });\n    } else {\n      notFavorites.push({ key: component.key });\n    }\n    dispatch(receiveFavorites(favorites, notFavorites));\n  }\n};\n\nconst mapDispatchToProps: DispatchProps = { onReceiveComponent };\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SourceViewerBase);\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport classNames from 'classnames';\nimport './LocationIndex.css';\n\n/*::\ntype Props = {\n  children?: React.Element<*>,\n  leading?: boolean,\n  onClick?: () => void,\n  selected?: boolean\n};\n*/\n\nexport default function LocationIndex(props /*: Props */) {\n  const { children, leading, onClick, selected, ...other } = props;\n  const clickAttributes = onClick ? { onClick, role: 'button', tabIndex: 0 } : {};\n\n  // put {...others} because Tooltip sets some event handlers\n  return (\n    <div\n      className={classNames('location-index', { 'is-leading': leading, selected })}\n      {...clickAttributes}\n      {...other}>\n      {children}\n    </div>\n  );\n}\n\nLocationIndex.defaultProps = {\n  selected: false\n};\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport { formatMeasure } from '../../../helpers/measures';\nimport { translate, translateWithParameters } from '../../../helpers/l10n';\n\n/*::\nexport type ChangelogDiff = {\n  key: string,\n  oldValue?: string,\n  newValue?: string\n};\n*/\n\nexport default function IssueChangelogDiff(props /*: { diff: ChangelogDiff } */) {\n  const { diff } = props;\n  if (diff.key === 'file') {\n    return (\n      <p>\n        {translateWithParameters(\n          'issue.change.file_move',\n          diff.oldValue || '',\n          diff.newValue || ''\n        )}\n      </p>\n    );\n  }\n  if (diff.key === 'from_long_branch') {\n    return (\n      <p>\n        {translateWithParameters(\n          'issue.change.from_long_branch',\n          diff.oldValue || '',\n          diff.newValue || ''\n        )}\n      </p>\n    );\n  }\n  if (diff.key === 'from_short_branch') {\n    return (\n      <p>\n        {translateWithParameters(\n          'issue.change.from_short_branch',\n          diff.oldValue || '',\n          diff.newValue || ''\n        )}\n      </p>\n    );\n  }\n\n  let message;\n  if (diff.newValue != null) {\n    let newValue /*: string */ = diff.newValue;\n    if (diff.key === 'effort') {\n      newValue = formatMeasure(diff.newValue, 'WORK_DUR');\n    }\n    message = translateWithParameters(\n      'issue.changelog.changed_to',\n      translate('issue.changelog.field', diff.key),\n      newValue\n    );\n  } else {\n    message = translateWithParameters(\n      'issue.changelog.removed',\n      translate('issue.changelog.field', diff.key)\n    );\n  }\n\n  if (diff.oldValue != null) {\n    let oldValue /*: string */ = diff.oldValue;\n    if (diff.key === 'effort') {\n      oldValue = formatMeasure(diff.oldValue, 'WORK_DUR');\n    }\n    message += ` (${translateWithParameters('issue.changelog.was', oldValue)})`;\n  }\n  return <p>{message}</p>;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport { getIssueChangelog } from '../../../api/issues';\nimport { translate } from '../../../helpers/l10n';\nimport Avatar from '../../../components/ui/Avatar';\nimport BubblePopup from '../../../components/common/BubblePopup';\nimport DateTimeFormatter from '../../../components/intl/DateTimeFormatter';\nimport IssueChangelogDiff from '../components/IssueChangelogDiff';\n/*:: import type { ChangelogDiff } from '../components/IssueChangelogDiff'; */\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Changelog = {\n  avatar?: string,\n  creationDate: string,\n  diffs: Array<ChangelogDiff>,\n  user: string,\n  userName: string\n};\n*/\n\n/*::\ntype Props = {\n  issue: Issue,\n  onFail: Error => void,\n  popupPosition?: {}\n};\n*/\n\n/*::\ntype State = {\n  changelogs: Array<Changelog>\n};\n*/\n\nexport default class ChangelogPopup extends React.PureComponent {\n  /*:: mounted: boolean; */\n  /*:: props: Props; */\n  state /*: State */ = {\n    changelogs: []\n  };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.loadChangelog();\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  loadChangelog() {\n    getIssueChangelog(this.props.issue.key).then(changelogs => {\n      if (this.mounted) {\n        this.setState({ changelogs });\n      }\n    }, this.props.onFail);\n  }\n\n  render() {\n    const { issue } = this.props;\n    const { author } = issue;\n    return (\n      <BubblePopup position={this.props.popupPosition} customClass=\"bubble-popup-bottom-right\">\n        <div className=\"issue-changelog\">\n          <table className=\"spaced\">\n            <tbody>\n              <tr>\n                <td className=\"thin text-left text-top nowrap\">\n                  <DateTimeFormatter date={issue.creationDate} />\n                </td>\n                <td className=\"text-left text-top\">\n                  {author ? `${translate('created_by')} ${author}` : translate('created')}\n                </td>\n              </tr>\n\n              {this.state.changelogs.map((item, idx) => (\n                <tr key={idx}>\n                  <td className=\"thin text-left text-top nowrap\">\n                    <DateTimeFormatter date={item.creationDate} />\n                  </td>\n                  <td className=\"text-left text-top\">\n                    {item.userName && (\n                      <p>\n                        <Avatar\n                          className=\"little-spacer-right\"\n                          hash={item.avatar}\n                          name={item.userName}\n                          size={16}\n                        />\n                        {item.userName}\n                      </p>\n                    )}\n                    {item.diffs.map(diff => <IssueChangelogDiff key={diff.key} diff={diff} />)}\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </BubblePopup>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport BubblePopupHelper from '../../../components/common/BubblePopupHelper';\nimport ChangelogPopup from '../popups/ChangelogPopup';\nimport DateFromNow from '../../../components/intl/DateFromNow';\nimport DateTimeFormatter from '../../../components/intl/DateTimeFormatter';\nimport Tooltip from '../../../components/controls/Tooltip';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {\n  isOpen: boolean,\n  issue: Issue,\n  creationDate: string,\n  togglePopup: (string, boolean | void) => void,\n  onFail: Error => void\n};\n*/\n\nexport default class IssueChangelog extends React.PureComponent {\n  /*:: props: Props; */\n\n  handleClick = (evt /*: SyntheticInputEvent */) => {\n    evt.preventDefault();\n    this.toggleChangelog();\n  };\n\n  toggleChangelog = (open /*: boolean | void */) => {\n    this.props.togglePopup('changelog', open);\n  };\n\n  render() {\n    return (\n      <BubblePopupHelper\n        isOpen={this.props.isOpen}\n        position=\"bottomright\"\n        togglePopup={this.toggleChangelog}\n        popup={<ChangelogPopup issue={this.props.issue} onFail={this.props.onFail} />}>\n        <Tooltip\n          mouseEnterDelay={0.5}\n          overlay={<DateTimeFormatter date={this.props.creationDate} />}>\n          <button\n            className=\"button-link issue-action issue-action-with-options js-issue-show-changelog\"\n            onClick={this.handleClick}>\n            <span className=\"issue-meta-label\">\n              <DateFromNow date={this.props.creationDate} />\n            </span>\n            <i className=\"icon-dropdown little-spacer-left\" />\n          </button>\n        </Tooltip>\n      </BubblePopupHelper>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { translate } from '../../../helpers/l10n';\n\nexport default class IssueMessage extends React.PureComponent {\n  /*:: props: {\n    message: string,\n    rule: string,\n    organization: string\n  };\n  */\n\n  static contextTypes = {\n    workspace: PropTypes.object.isRequired\n  };\n\n  handleClick = (e /*: MouseEvent */) => {\n    e.preventDefault();\n    e.stopPropagation();\n    this.context.workspace.openRule({\n      key: this.props.rule,\n      organization: this.props.organization\n    });\n  };\n\n  render() {\n    return (\n      <div className=\"issue-message\">\n        {this.props.message}\n        <button\n          className=\"button-link issue-rule icon-ellipsis-h little-spacer-left\"\n          aria-label={translate('issue.rule_details')}\n          onClick={this.handleClick}\n        />\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport classNames from 'classnames';\nimport Tooltip from '../controls/Tooltip';\n\n/*::\ntype Props = {\n  active?: string,\n  children?: React.Element<*>,\n  item: string,\n  onSelect?: string => void,\n  onHover?: string => void,\n  title?: string\n};\n*/\n\nexport default class SelectListItem extends React.PureComponent {\n  /*:: props: Props; */\n\n  handleSelect = (evt /*: SyntheticInputEvent */) => {\n    evt.preventDefault();\n    if (this.props.onSelect) {\n      this.props.onSelect(this.props.item);\n    }\n  };\n\n  handleHover = () => {\n    if (this.props.onHover) {\n      this.props.onHover(this.props.item);\n    }\n  };\n\n  renderLink() {\n    let children = this.props.item;\n    if (this.props.children) {\n      children = this.props.children;\n    }\n    return (\n      <li>\n        <a\n          href=\"#\"\n          className={classNames({ active: this.props.active === this.props.item })}\n          onClick={this.handleSelect}\n          onMouseOver={this.handleHover}\n          onFocus={this.handleHover}>\n          {children}\n        </a>\n      </li>\n    );\n  }\n\n  render() {\n    return (\n      <Tooltip overlay={this.props.title || undefined} placement=\"right\">\n        {this.renderLink()}\n      </Tooltip>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport key from 'keymaster';\nimport { uniqueId } from 'lodash';\nimport classNames from 'classnames';\nimport SelectListItem from './SelectListItem';\n\n/*::\ntype Props = {\n  children?: SelectListItem,\n  className?: string,\n  items: Array<string>,\n  currentItem: string,\n  onSelect: string => void\n};\n*/\n\n/*::\ntype State = {\n  active: string\n};\n*/\n\nexport default class SelectList extends React.PureComponent {\n  /*:: currentKeyScope: string; */\n  /*:: previousFilter: Function; */\n  /*:: previousKeyScope: string; */\n  /*:: props: Props; */\n  /*:: state: State; */\n\n  constructor(props /*: Props */) {\n    super(props);\n    this.state = {\n      active: props.currentItem\n    };\n  }\n\n  componentDidMount() {\n    this.attachShortcuts();\n  }\n\n  componentWillReceiveProps(nextProps /*: Props */) {\n    if (\n      nextProps.currentItem !== this.props.currentItem &&\n      !nextProps.items.includes(this.state.active)\n    ) {\n      this.setState({ active: nextProps.currentItem });\n    }\n  }\n\n  componentWillUnmount() {\n    this.detachShortcuts();\n  }\n\n  attachShortcuts = () => {\n    this.previousKeyScope = key.getScope();\n    this.previousFilter = key.filter;\n    this.currentKeyScope = uniqueId('key-scope');\n    key.setScope(this.currentKeyScope);\n\n    // sometimes there is a *focused* search field next to the SelectList component\n    // we need to allow shortcuts in this case, but only for the used keys\n    key.filter = (event /*: KeyboardEvent & { target: HTMLElement } */) => {\n      const tagName = (event.target || event.srcElement).tagName;\n      const isInput = tagName === 'INPUT' || tagName === 'SELECT' || tagName === 'TEXTAREA';\n      return [13, 38, 40].includes(event.keyCode) || !isInput;\n    };\n\n    key('down', this.currentKeyScope, () => {\n      this.setState(this.selectNextElement);\n      return false;\n    });\n\n    key('up', this.currentKeyScope, () => {\n      this.setState(this.selectPreviousElement);\n      return false;\n    });\n\n    key('return', this.currentKeyScope, () => {\n      if (this.state.active != null) {\n        this.handleSelect(this.state.active);\n      }\n      return false;\n    });\n  };\n\n  detachShortcuts = () => {\n    key.setScope(this.previousKeyScope);\n    key.deleteScope(this.currentKeyScope);\n    key.filter = this.previousFilter;\n  };\n\n  handleSelect = (item /*: string */) => {\n    this.props.onSelect(item);\n  };\n\n  handleHover = (item /*: string */) => {\n    this.setState({ active: item });\n  };\n\n  selectNextElement = (state /*: State */, props /*: Props */) => {\n    const idx = props.items.indexOf(state.active);\n    if (idx < 0) {\n      return { active: props.items[0] };\n    }\n    return { active: props.items[(idx + 1) % props.items.length] };\n  };\n\n  selectPreviousElement = (state /*: State */, props /*: Props */) => {\n    const idx = props.items.indexOf(state.active);\n    if (idx <= 0) {\n      return { active: props.items[props.items.length - 1] };\n    }\n    return { active: props.items[idx - 1] };\n  };\n\n  renderChild = (child /*: Object */) => {\n    if (child == null) {\n      return null;\n    }\n    // do not pass extra props to children like `<li className=\"divider\" />`\n    if (child.type !== SelectListItem) {\n      return child;\n    }\n    return React.cloneElement(child, {\n      active: this.state.active,\n      onHover: this.handleHover,\n      onSelect: this.handleSelect\n    });\n  };\n\n  render() {\n    const { children } = this.props;\n    const hasChildren = React.Children.count(children) > 0;\n    return (\n      <ul className={classNames('menu', this.props.className)}>\n        {hasChildren && React.Children.map(children, this.renderChild)}\n        {!hasChildren &&\n          this.props.items.map(item => (\n            <SelectListItem\n              active={this.state.active}\n              item={item}\n              key={item}\n              onHover={this.handleHover}\n              onSelect={this.handleSelect}\n            />\n          ))}\n      </ul>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n//@flow\nimport React from 'react';\nimport classNames from 'classnames';\n\nexport default function StatusIcon(props /*: { status: string, className?: string } */) {\n  const className = classNames('icon-status-' + props.status.toLowerCase(), props.className);\n  return <i className={className} />;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n//@flow\nimport React from 'react';\nimport StatusIcon from './StatusIcon';\nimport { translate } from '../../helpers/l10n';\n\nexport default function StatusHelper(\n  props /*: {\n  resolution?: string,\n  status: string,\n  className?: string\n} */\n) {\n  const resolution =\n    props.resolution != null && ` (${translate('issue.resolution', props.resolution)})`;\n  return (\n    <span className={props.className}>\n      <StatusIcon className=\"little-spacer-right\" status={props.status} />\n      {translate('issue.status', props.status)}\n      {resolution}\n    </span>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport BubblePopup from '../../../components/common/BubblePopup';\nimport SelectList from '../../../components/common/SelectList';\nimport SelectListItem from '../../../components/common/SelectListItem';\nimport SeverityHelper from '../../../components/shared/SeverityHelper';\nimport StatusHelper from '../../../components/shared/StatusHelper';\nimport QualifierIcon from '../../../components/shared/QualifierIcon';\nimport IssueTypeIcon from '../../../components/ui/IssueTypeIcon';\nimport Avatar from '../../../components/ui/Avatar';\nimport { translate } from '../../../helpers/l10n';\nimport { fileFromPath, limitComponentName } from '../../../helpers/path';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {|\n  issue: Issue,\n  onFilter: (property: string, issue: Issue) => void,\n  popupPosition?: {}\n|};\n*/\n\nexport default class SimilarIssuesPopup extends React.PureComponent {\n  /*:: props: Props; */\n\n  handleSelect = (property /*: string */) => {\n    this.props.onFilter(property, this.props.issue);\n  };\n\n  render() {\n    const { issue } = this.props;\n\n    const items = [\n      'type',\n      'severity',\n      'status',\n      'resolution',\n      'assignee',\n      'rule',\n      ...(issue.tags || []).map(tag => `tag###${tag}`),\n      'project',\n      // $FlowFixMe items are filtered later\n      issue.subProject ? 'module' : undefined,\n      'file'\n    ].filter(item => item);\n\n    return (\n      <BubblePopup\n        position={this.props.popupPosition}\n        customClass=\"bubble-popup-menu bubble-popup-bottom-right\">\n        <header className=\"menu-search\">\n          <h6>{translate('issue.filter_similar_issues')}</h6>\n        </header>\n\n        <SelectList\n          className=\"issues-similar-issues-menu\"\n          currentItem={items[0]}\n          items={items}\n          onSelect={this.handleSelect}>\n          <SelectListItem item=\"type\">\n            <IssueTypeIcon className=\"little-spacer-right\" query={issue.type} />\n            {translate('issue.type', issue.type)}\n          </SelectListItem>\n\n          <SelectListItem item=\"severity\">\n            <SeverityHelper severity={issue.severity} />\n          </SelectListItem>\n\n          <SelectListItem item=\"status\">\n            <StatusHelper status={issue.status} />\n          </SelectListItem>\n\n          <SelectListItem item=\"resolution\">\n            {issue.resolution != null\n              ? translate('issue.resolution', issue.resolution)\n              : translate('unresolved')}\n          </SelectListItem>\n\n          <SelectListItem item=\"assignee\">\n            {issue.assignee != null ? (\n              <span>\n                {translate('assigned_to')}\n                <Avatar\n                  className=\"little-spacer-left little-spacer-right\"\n                  hash={issue.assigneeAvatar}\n                  name={issue.assigneeName}\n                  size={16}\n                />\n                {issue.assigneeName}\n              </span>\n            ) : (\n              translate('unassigned')\n            )}\n          </SelectListItem>\n\n          <li className=\"divider\" />\n\n          <SelectListItem item=\"rule\">{limitComponentName(issue.ruleName)}</SelectListItem>\n\n          {issue.tags != null &&\n            issue.tags.map(tag => (\n              <SelectListItem key={`tag###${tag}`} item={`tag###${tag}`}>\n                <i className=\"icon-tags icon-half-transparent little-spacer-right\" />\n                {tag}\n              </SelectListItem>\n            ))}\n\n          <li className=\"divider\" />\n\n          <SelectListItem item=\"project\">\n            <QualifierIcon className=\"little-spacer-right\" qualifier=\"TRK\" />\n            {issue.projectName}\n          </SelectListItem>\n\n          {issue.subProject != null && (\n            <SelectListItem item=\"module\">\n              <QualifierIcon className=\"little-spacer-right\" qualifier=\"BRC\" />\n              {issue.subProjectName}\n            </SelectListItem>\n          )}\n\n          <SelectListItem item=\"file\">\n            <QualifierIcon className=\"little-spacer-right\" qualifier={issue.componentQualifier} />\n            {fileFromPath(issue.componentLongName)}\n          </SelectListItem>\n        </SelectList>\n      </BubblePopup>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport BubblePopupHelper from '../../../components/common/BubblePopupHelper';\nimport SimilarIssuesPopup from '../popups/SimilarIssuesPopup';\nimport { translate } from '../../../helpers/l10n';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {|\n  isOpen: boolean,\n  issue: Issue,\n  togglePopup: (string, boolean | void) => void,\n  onFail: Error => void,\n  onFilter: (property: string, issue: Issue) => void\n|};\n*/\n\nexport default class SimilarIssuesFilter extends React.PureComponent {\n  /*:: props: Props; */\n\n  handleClick = (evt /*: SyntheticInputEvent */) => {\n    evt.preventDefault();\n    this.togglePopup();\n  };\n\n  handleFilter = (property /*: string */, issue /*: Issue */) => {\n    this.togglePopup(false);\n    this.props.onFilter(property, issue);\n  };\n\n  togglePopup = (open /*: boolean | void */) => {\n    this.props.togglePopup('similarIssues', open);\n  };\n\n  render() {\n    return (\n      <BubblePopupHelper\n        isOpen={this.props.isOpen}\n        position=\"bottomright\"\n        togglePopup={this.togglePopup}\n        popup={<SimilarIssuesPopup issue={this.props.issue} onFilter={this.handleFilter} />}>\n        <button\n          className=\"js-issue-filter button-link issue-action issue-action-with-options\"\n          aria-label={translate('issue.filter_similar_issues')}\n          onClick={this.handleClick}>\n          <i className=\"icon-filter icon-half-transparent\" /> <i className=\"icon-dropdown\" />\n        </button>\n      </BubblePopupHelper>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport { Link } from 'react-router';\nimport IssueChangelog from './IssueChangelog';\nimport IssueMessage from './IssueMessage';\nimport SimilarIssuesFilter from './SimilarIssuesFilter';\nimport LinkIcon from '../../../components/icons-components/LinkIcon';\nimport LocationIndex from '../../common/LocationIndex';\nimport Tooltip from '../../controls/Tooltip';\nimport { getBranchLikeQuery } from '../../../helpers/branches';\nimport { getComponentIssuesUrl } from '../../../helpers/urls';\nimport { formatMeasure } from '../../../helpers/measures';\nimport { translate, translateWithParameters } from '../../../helpers/l10n';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {|\n  branchLike?: { id?: string; name: string },\n  currentPopup: ?string,\n  displayLocationsCount?: boolean;\n  displayLocationsLink?: boolean;\n  issue: Issue,\n  onFail: Error => void,\n  onFilter?: (property: string, issue: Issue) => void,\n  togglePopup: (string, boolean | void) => void\n|};\n*/\n\nconst stopPropagation = (event /*: Event */) => event.stopPropagation();\n\nexport default function IssueTitleBar(props /*: Props */) {\n  const { issue } = props;\n  const hasSimilarIssuesFilter = props.onFilter != null;\n\n  const locationsCount =\n    issue.secondaryLocations.length +\n    issue.flows.reduce((sum, locations) => sum + locations.length, 0);\n\n  const locationsBadge = (\n    <Tooltip\n      overlay={translateWithParameters(\n        'issue.this_issue_involves_x_code_locations',\n        formatMeasure(locationsCount)\n      )}>\n      <LocationIndex>{locationsCount}</LocationIndex>\n    </Tooltip>\n  );\n\n  const displayLocations = props.displayLocationsCount && locationsCount > 0;\n\n  const issueUrl = getComponentIssuesUrl(issue.project, {\n    ...getBranchLikeQuery(props.branchLike),\n    issues: issue.key,\n    open: issue.key\n  });\n\n  return (\n    <div className=\"issue-row\">\n      <IssueMessage message={issue.message} rule={issue.rule} organization={issue.organization} />\n\n      <div className=\"issue-row-meta\">\n        <ul className=\"list-inline issue-meta-list\">\n          <li className=\"issue-meta\">\n            <IssueChangelog\n              creationDate={issue.creationDate}\n              isOpen={props.currentPopup === 'changelog'}\n              issue={issue}\n              togglePopup={props.togglePopup}\n              onFail={props.onFail}\n            />\n          </li>\n          {issue.textRange != null && (\n            <li className=\"issue-meta\">\n              <span className=\"issue-meta-label\" title={translate('line_number')}>\n                L{issue.textRange.endLine}\n              </span>\n            </li>\n          )}\n          {displayLocations && (\n            <li className=\"issue-meta\">\n              {props.displayLocationsLink ? (\n                <Link onClick={stopPropagation} target=\"_blank\" to={issueUrl}>\n                  {locationsBadge}\n                </Link>\n              ) : (\n                locationsBadge\n              )}\n            </li>\n          )}\n          <li className=\"issue-meta\">\n            <Link\n              className=\"js-issue-permalink link-no-underline\"\n              onClick={stopPropagation}\n              target=\"_blank\"\n              to={issueUrl}>\n              <LinkIcon />\n            </Link>\n          </li>\n          {hasSimilarIssuesFilter && (\n            <li className=\"issue-meta\">\n              <SimilarIssuesFilter\n                isOpen={props.currentPopup === 'similarIssues'}\n                issue={issue}\n                togglePopup={props.togglePopup}\n                onFail={props.onFail}\n                onFilter={props.onFilter}\n              />\n            </li>\n          )}\n        </ul>\n      </div>\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport { map } from 'lodash';\nimport { connect } from 'react-redux';\nimport * as PropTypes from 'prop-types';\nimport Avatar from '../../../components/ui/Avatar';\nimport BubblePopup from '../../../components/common/BubblePopup';\nimport SelectList from '../../../components/common/SelectList';\nimport SelectListItem from '../../../components/common/SelectListItem';\nimport SearchBox from '../../../components/controls/SearchBox';\nimport { searchMembers } from '../../../api/organizations';\nimport { searchUsers } from '../../../api/users';\nimport { translate } from '../../../helpers/l10n';\nimport { getCurrentUser } from '../../../store/rootReducer';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype User = {\n  avatar?: string,\n  email?: string,\n  login: string,\n  name: string\n};\n*/\n\n/*::\ntype Props = {\n  currentUser: User,\n  issue: Issue,\n  onFail: Error => void,\n  onSelect: string => void,\n  popupPosition?: {}\n};\n*/\n\n/*::\ntype State = {\n  query: string,\n  users: Array<User>,\n  currentUser: string\n};\n*/\n\nconst LIST_SIZE = 10;\n\nclass SetAssigneePopup extends React.PureComponent {\n  /*:: defaultUsersArray: Array<User>; */\n  /*:: props: Props; */\n  /*:: state: State; */\n\n  static contextTypes = {\n    organizationsEnabled: PropTypes.bool\n  };\n\n  constructor(props /*: Props */) {\n    super(props);\n    this.defaultUsersArray = [{ login: '', name: translate('unassigned') }];\n\n    if (props.currentUser.isLoggedIn) {\n      this.defaultUsersArray = [props.currentUser, ...this.defaultUsersArray];\n    }\n\n    this.state = {\n      query: '',\n      users: this.defaultUsersArray,\n      currentUser: this.defaultUsersArray.length > 0 ? this.defaultUsersArray[0].login : ''\n    };\n  }\n\n  searchMembers = (query /*: string */) => {\n    searchMembers({\n      organization: this.props.issue.projectOrganization,\n      q: query,\n      ps: LIST_SIZE\n    }).then(this.handleSearchResult, this.props.onFail);\n  };\n\n  searchUsers = (query /*: string */) =>\n    searchUsers({ q: query, ps: LIST_SIZE }).then(this.handleSearchResult, this.props.onFail);\n\n  handleSearchResult = (data /*: Object */) => {\n    this.setState({\n      users: data.users,\n      currentUser: data.users.length > 0 ? data.users[0].login : ''\n    });\n  };\n\n  handleSearchChange = (query /*: string */) => {\n    if (query.length === 0) {\n      this.setState({\n        query,\n        users: this.defaultUsersArray,\n        currentUser: this.defaultUsersArray[0].login\n      });\n    } else {\n      this.setState({ query });\n      if (this.context.organizationsEnabled) {\n        this.searchMembers(query);\n      } else {\n        this.searchUsers(query);\n      }\n    }\n  };\n\n  render() {\n    return (\n      <BubblePopup\n        customClass=\"bubble-popup-menu bubble-popup-bottom\"\n        position={this.props.popupPosition}>\n        <div className=\"multi-select\">\n          <div className=\"menu-search\">\n            <SearchBox\n              autoFocus={true}\n              className=\"little-spacer-top\"\n              minLength={2}\n              onChange={this.handleSearchChange}\n              placeholder={translate('search.search_for_users')}\n              value={this.state.query}\n            />\n          </div>\n          <SelectList\n            currentItem={this.state.currentUser}\n            items={map(this.state.users, 'login')}\n            onSelect={this.props.onSelect}>\n            {this.state.users.map(user => (\n              <SelectListItem key={user.login} item={user.login}>\n                {!!user.login && (\n                  <Avatar className=\"spacer-right\" hash={user.avatar} name={user.name} size={16} />\n                )}\n                <span\n                  className=\"vertical-middle\"\n                  style={{ marginLeft: !user.login ? 24 : undefined }}>\n                  {user.name}\n                </span>\n              </SelectListItem>\n            ))}\n          </SelectList>\n        </div>\n      </BubblePopup>\n    );\n  }\n}\n\nconst mapStateToProps = state => ({\n  currentUser: getCurrentUser(state)\n});\n\nexport default connect(mapStateToProps)(SetAssigneePopup);\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport Avatar from '../../../components/ui/Avatar';\nimport BubblePopupHelper from '../../../components/common/BubblePopupHelper';\nimport SetAssigneePopup from '../popups/SetAssigneePopup';\nimport { translate } from '../../../helpers/l10n';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {\n  isOpen: boolean,\n  issue: Issue,\n  canAssign: boolean,\n  onAssign: string => void,\n  onFail: Error => void,\n  togglePopup: (string, boolean | void) => void\n};\n*/\n\nexport default class IssueAssign extends React.PureComponent {\n  /*:: props: Props; */\n\n  toggleAssign = (open /*: boolean | void */) => {\n    this.props.togglePopup('assign', open);\n  };\n\n  renderAssignee() {\n    const { issue } = this.props;\n    return (\n      <span>\n        {issue.assignee && (\n          <span className=\"text-top\">\n            <Avatar\n              className=\"little-spacer-right\"\n              hash={issue.assigneeAvatar}\n              name={issue.assigneeName}\n              size={16}\n            />\n          </span>\n        )}\n        <span className=\"issue-meta-label\">\n          {issue.assignee ? issue.assigneeName : translate('unassigned')}\n        </span>\n      </span>\n    );\n  }\n\n  render() {\n    if (this.props.canAssign) {\n      return (\n        <BubblePopupHelper\n          isOpen={this.props.isOpen && this.props.canAssign}\n          position=\"bottomleft\"\n          togglePopup={this.toggleAssign}\n          popup={\n            <SetAssigneePopup\n              issue={this.props.issue}\n              onFail={this.props.onFail}\n              onSelect={this.props.onAssign}\n            />\n          }>\n          <button\n            className=\"button-link issue-action issue-action-with-options js-issue-assign\"\n            onClick={this.toggleAssign}>\n            {this.renderAssignee()}\n            <i className=\"little-spacer-left icon-dropdown\" />\n          </button>\n        </BubblePopupHelper>\n      );\n    } else {\n      return this.renderAssignee();\n    }\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport { parseIssueFromResponse } from '../../helpers/issues';\n/*:: import type { Issue } from './types'; */\n\nexport const updateIssue = (\n  onChange /*: Issue => void */,\n  onFail /*: Error => void */,\n  resultPromise /*: Promise<*> */,\n  oldIssue /*: ?Issue */,\n  newIssue /*: ?Issue */\n) => {\n  const optimisticUpdate = oldIssue != null && newIssue != null;\n  if (optimisticUpdate) {\n    // $FlowFixMe `newIssue` is not null, because `optimisticUpdate` is true\n    onChange(newIssue);\n  }\n\n  resultPromise.then(\n    response => {\n      if (!optimisticUpdate) {\n        const issue = parseIssueFromResponse(\n          response.issue,\n          response.components,\n          response.users,\n          response.rules\n        );\n        onChange(issue);\n      }\n    },\n    error => {\n      onFail(error);\n      if (optimisticUpdate) {\n        // $FlowFixMe `oldIssue` is not null, because `optimisticUpdate` is true\n        onChange(oldIssue);\n      }\n    }\n  );\n};\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport classNames from 'classnames';\nimport BubblePopup from '../../../components/common/BubblePopup';\nimport MarkdownTips from '../../../components/common/MarkdownTips';\nimport { translate } from '../../../helpers/l10n';\n/*:: import type { IssueComment } from '../types'; */\n\n/*::\ntype Props = {\n  comment?: IssueComment,\n  customClass?: string,\n  onComment: string => void,\n  toggleComment: boolean => void,\n  placeholder: string,\n  popupPosition?: {}\n};\n*/\n\n/*::\ntype State = {\n  textComment: string\n};\n*/\n\nexport default class CommentPopup extends React.PureComponent {\n  /*:: props: Props; */\n  /*:: state: State; */\n\n  constructor(props /*: Props */) {\n    super(props);\n    this.state = {\n      textComment: props.comment ? props.comment.markdown : ''\n    };\n  }\n\n  handleCommentChange = (evt /*: SyntheticInputEvent */) => {\n    this.setState({ textComment: evt.target.value });\n  };\n\n  handleCommentClick = () => {\n    if (this.state.textComment.trim().length > 0) {\n      this.props.onComment(this.state.textComment);\n    }\n  };\n\n  handleCancelClick = (evt /*: MouseEvent */) => {\n    evt.preventDefault();\n    this.props.toggleComment(false);\n  };\n\n  handleKeyboard = (evt /*: KeyboardEvent */) => {\n    if (evt.keyCode === 13 && (evt.metaKey || evt.ctrlKey)) {\n      // Ctrl + Enter\n      this.handleCommentClick();\n    } else if ([37, 38, 39, 40].includes(evt.keyCode)) {\n      // Arrow keys\n      evt.stopPropagation();\n    }\n  };\n\n  render() {\n    const { comment } = this.props;\n    return (\n      <BubblePopup\n        position={this.props.popupPosition}\n        customClass={classNames(this.props.customClass, 'bubble-popup-bottom-right')}>\n        <div className=\"issue-comment-form-text\">\n          <textarea\n            autoFocus={true}\n            placeholder={this.props.placeholder}\n            onChange={this.handleCommentChange}\n            onKeyDown={this.handleKeyboard}\n            value={this.state.textComment}\n            rows=\"2\"\n          />\n        </div>\n        <div className=\"issue-comment-form-footer\">\n          <div className=\"issue-comment-form-actions\">\n            <button\n              className=\"js-issue-comment-submit little-spacer-right\"\n              disabled={this.state.textComment.trim().length < 1}\n              onClick={this.handleCommentClick}>\n              {comment && translate('save')}\n              {!comment && translate('issue.comment.submit')}\n            </button>\n            <a href=\"#\" className=\"js-issue-comment-cancel\" onClick={this.handleCancelClick}>\n              {translate('cancel')}\n            </a>\n          </div>\n          <div className=\"issue-comment-form-tips\">\n            <MarkdownTips />\n          </div>\n        </div>\n      </BubblePopup>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport { updateIssue } from '../actions';\nimport BubblePopupHelper from '../../../components/common/BubblePopupHelper';\nimport CommentPopup from '../popups/CommentPopup';\nimport { addIssueComment } from '../../../api/issues';\nimport { translate } from '../../../helpers/l10n';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {|\n  commentPlaceholder: string,\n  currentPopup: ?string,\n  issueKey: string,\n  onChange: Issue => void,\n  onFail: Error => void,\n  toggleComment: (open?: boolean, placeholder?: string) => void\n|};\n*/\n\nexport default class IssueCommentAction extends React.PureComponent {\n  /*:: props: Props; */\n\n  addComment = (text /*: string */) => {\n    updateIssue(\n      this.props.onChange,\n      this.props.onFail,\n      addIssueComment({ issue: this.props.issueKey, text })\n    );\n    this.props.toggleComment(false);\n  };\n\n  handleCommentClick = () => this.props.toggleComment();\n\n  render() {\n    return (\n      <li className=\"issue-meta\">\n        <BubblePopupHelper\n          isOpen={this.props.currentPopup === 'comment'}\n          position=\"bottomleft\"\n          togglePopup={this.props.toggleComment}\n          popup={\n            <CommentPopup\n              customClass=\"issue-comment-bubble-popup\"\n              placeholder={this.props.commentPlaceholder}\n              onComment={this.addComment}\n              toggleComment={this.props.toggleComment}\n            />\n          }>\n          <button\n            className=\"button-link issue-action js-issue-comment\"\n            onClick={this.handleCommentClick}>\n            <span className=\"issue-meta-label\">{translate('issue.comment.formlink')}</span>\n          </button>\n        </BubblePopupHelper>\n      </li>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport { translate } from '../../../helpers/l10n';\nimport BubblePopup from '../../../components/common/BubblePopup';\nimport SelectList from '../../../components/common/SelectList';\nimport SelectListItem from '../../../components/common/SelectListItem';\nimport SeverityIcon from '../../../components/shared/SeverityIcon';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {\n  issue: Issue,\n  onSelect: string => void,\n  popupPosition?: {}\n};\n*/\n\nconst SEVERITY = ['BLOCKER', 'CRITICAL', 'MAJOR', 'MINOR', 'INFO'];\n\nexport default class SetSeverityPopup extends React.PureComponent {\n  /*:: props: Props; */\n\n  render() {\n    return (\n      <BubblePopup\n        position={this.props.popupPosition}\n        customClass=\"bubble-popup-menu bubble-popup-bottom\">\n        <SelectList\n          items={SEVERITY}\n          currentItem={this.props.issue.severity}\n          onSelect={this.props.onSelect}>\n          {SEVERITY.map(severity => (\n            <SelectListItem key={severity} item={severity}>\n              <SeverityIcon className=\"little-spacer-right\" severity={severity} />\n              {translate('severity', severity)}\n            </SelectListItem>\n          ))}\n        </SelectList>\n      </BubblePopup>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport BubblePopupHelper from '../../../components/common/BubblePopupHelper';\nimport SetSeverityPopup from '../popups/SetSeverityPopup';\nimport SeverityHelper from '../../../components/shared/SeverityHelper';\nimport { setIssueSeverity } from '../../../api/issues';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {\n  canSetSeverity: boolean,\n  isOpen: boolean,\n  issue: Issue,\n  setIssueProperty: (string, string, apiCall: (Object) => Promise<*>, string) => void,\n  togglePopup: (string, boolean | void) => void\n};\n*/\n\nexport default class IssueSeverity extends React.PureComponent {\n  /*:: props: Props; */\n\n  toggleSetSeverity = (open /*: boolean | void */) => {\n    this.props.togglePopup('set-severity', open);\n  };\n\n  setSeverity = (severity /*: string */) =>\n    this.props.setIssueProperty('severity', 'set-severity', setIssueSeverity, severity);\n\n  render() {\n    const { issue } = this.props;\n    if (this.props.canSetSeverity) {\n      return (\n        <BubblePopupHelper\n          isOpen={this.props.isOpen && this.props.canSetSeverity}\n          position=\"bottomleft\"\n          togglePopup={this.toggleSetSeverity}\n          popup={<SetSeverityPopup issue={issue} onSelect={this.setSeverity} />}>\n          <button\n            className=\"button-link issue-action issue-action-with-options js-issue-set-severity\"\n            onClick={this.toggleSetSeverity}>\n            <SeverityHelper\n              className=\"issue-meta-label little-spacer-right\"\n              severity={issue.severity}\n            />\n            <i className=\"little-spacer-left icon-dropdown\" />\n          </button>\n        </BubblePopupHelper>\n      );\n    } else {\n      return <SeverityHelper className=\"issue-meta-label\" severity={issue.severity} />;\n    }\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { difference, without } from 'lodash';\nimport { BubblePopupPosition } from '../../../components/common/BubblePopup';\nimport TagsSelector from '../../../components/tags/TagsSelector';\nimport { searchIssueTags } from '../../../api/issues';\n\ninterface Props {\n  popupPosition: BubblePopupPosition;\n  organization: string;\n  selectedTags: string[];\n  setTags: (tags: string[]) => void;\n}\n\ninterface State {\n  searchResult: string[];\n}\n\nconst LIST_SIZE = 10;\n\nexport default class SetIssueTagsPopup extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { searchResult: [] };\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  onSearch = (query: string) => {\n    return searchIssueTags({\n      q: query,\n      ps: Math.min(this.props.selectedTags.length - 1 + LIST_SIZE, 100),\n      organization: this.props.organization\n    }).then(\n      (tags: string[]) => {\n        if (this.mounted) {\n          this.setState({ searchResult: tags });\n        }\n      },\n      () => {}\n    );\n  };\n\n  onSelect = (tag: string) => {\n    this.props.setTags([...this.props.selectedTags, tag]);\n  };\n\n  onUnselect = (tag: string) => {\n    this.props.setTags(without(this.props.selectedTags, tag));\n  };\n\n  render() {\n    const availableTags = difference(this.state.searchResult, this.props.selectedTags);\n    return (\n      <TagsSelector\n        listSize={LIST_SIZE}\n        onSearch={this.onSearch}\n        onSelect={this.onSelect}\n        onUnselect={this.onUnselect}\n        position={this.props.popupPosition}\n        selectedTags={this.props.selectedTags}\n        tags={availableTags}\n      />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport { updateIssue } from '../actions';\nimport BubblePopupHelper from '../../../components/common/BubblePopupHelper';\nimport SetIssueTagsPopup from '../popups/SetIssueTagsPopup';\nimport TagsList from '../../../components/tags/TagsList';\nimport { setIssueTags } from '../../../api/issues';\nimport { translate } from '../../../helpers/l10n';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {|\n  canSetTags: boolean,\n  isOpen: boolean,\n  issue: Issue,\n  onChange: Issue => void,\n  onFail: Error => void,\n  togglePopup: (string, boolean | void) => void\n|};\n*/\n\nexport default class IssueTags extends React.PureComponent {\n  /*:: props: Props; */\n\n  toggleSetTags = (open /*: boolean | void */) => {\n    this.props.togglePopup('edit-tags', open);\n  };\n\n  setTags = (tags /*: Array<string> */) => {\n    const { issue } = this.props;\n    const newIssue = { ...issue, tags };\n    updateIssue(\n      this.props.onChange,\n      this.props.onFail,\n      setIssueTags({ issue: issue.key, tags: tags.join(',') }),\n      issue,\n      newIssue\n    );\n  };\n\n  render() {\n    const { issue } = this.props;\n    const { tags = [] } = issue;\n\n    if (this.props.canSetTags) {\n      return (\n        <BubblePopupHelper\n          isOpen={this.props.isOpen}\n          popup={\n            <SetIssueTagsPopup\n              organization={issue.projectOrganization}\n              selectedTags={tags}\n              setTags={this.setTags}\n            />\n          }\n          position=\"bottomright\"\n          togglePopup={this.toggleSetTags}>\n          <button\n            className={'js-issue-edit-tags button-link issue-action issue-action-with-options'}\n            onClick={this.toggleSetTags}>\n            <TagsList\n              allowUpdate={this.props.canSetTags}\n              tags={issue.tags && issue.tags.length > 0 ? issue.tags : [translate('issue.no_tag')]}\n            />\n          </button>\n        </BubblePopupHelper>\n      );\n    } else {\n      return (\n        <TagsList\n          allowUpdate={this.props.canSetTags}\n          className=\"note\"\n          tags={issue.tags && issue.tags.length > 0 ? issue.tags : [translate('issue.no_tag')]}\n        />\n      );\n    }\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport BubblePopup from '../../../components/common/BubblePopup';\nimport SelectList from '../../../components/common/SelectList';\nimport SelectListItem from '../../../components/common/SelectListItem';\nimport { translate } from '../../../helpers/l10n';\n\n/*::\ntype Props = {\n  transitions: Array<string>,\n  onSelect: string => void,\n  popupPosition?: {}\n};\n*/\n\nexport default class SetTransitionPopup extends React.PureComponent {\n  /*:: props: Props; */\n\n  render() {\n    const { transitions } = this.props;\n    return (\n      <BubblePopup\n        position={this.props.popupPosition}\n        customClass=\"bubble-popup-menu bubble-popup-bottom\">\n        <SelectList items={transitions} currentItem={transitions[0]} onSelect={this.props.onSelect}>\n          {transitions.map(transition => {\n            return (\n              <SelectListItem\n                key={transition}\n                item={transition}\n                title={translate('issue.transition', transition, 'description')}>\n                {translate('issue.transition', transition)}\n              </SelectListItem>\n            );\n          })}\n        </SelectList>\n      </BubblePopup>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport { updateIssue } from '../actions';\nimport BubblePopupHelper from '../../../components/common/BubblePopupHelper';\nimport SetTransitionPopup from '../popups/SetTransitionPopup';\nimport StatusHelper from '../../../components/shared/StatusHelper';\nimport { setIssueTransition } from '../../../api/issues';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {\n  hasTransitions: boolean,\n  isOpen: boolean,\n  issue: Issue,\n  onChange: Issue => void,\n  onFail: Error => void,\n  togglePopup: (string, boolean | void) => void\n};\n*/\n\nexport default class IssueTransition extends React.PureComponent {\n  /*:: props: Props; */\n\n  setTransition = (transition /*: string */) => {\n    updateIssue(\n      this.props.onChange,\n      this.props.onFail,\n      setIssueTransition({ issue: this.props.issue.key, transition })\n    );\n    this.toggleSetTransition();\n  };\n\n  toggleSetTransition = (open /*: boolean | void */) => {\n    this.props.togglePopup('transition', open);\n  };\n\n  render() {\n    const { issue } = this.props;\n\n    if (this.props.hasTransitions) {\n      return (\n        <BubblePopupHelper\n          isOpen={this.props.isOpen && this.props.hasTransitions}\n          position=\"bottomleft\"\n          togglePopup={this.toggleSetTransition}\n          popup={\n            <SetTransitionPopup transitions={issue.transitions} onSelect={this.setTransition} />\n          }>\n          <button\n            className=\"button-link issue-action issue-action-with-options js-issue-transition\"\n            onClick={this.toggleSetTransition}>\n            <StatusHelper\n              className=\"issue-meta-label little-spacer-right\"\n              status={issue.status}\n              resolution={issue.resolution}\n            />\n            <i className=\"little-spacer-left icon-dropdown\" />\n          </button>\n        </BubblePopupHelper>\n      );\n    } else {\n      return (\n        <StatusHelper\n          className=\"issue-meta-label\"\n          status={issue.status}\n          resolution={issue.resolution}\n        />\n      );\n    }\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport { translate } from '../../../helpers/l10n';\nimport BubblePopup from '../../../components/common/BubblePopup';\nimport IssueTypeIcon from '../../../components/ui/IssueTypeIcon';\nimport SelectList from '../../../components/common/SelectList';\nimport SelectListItem from '../../../components/common/SelectListItem';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {\n  issue: Issue,\n  onSelect: string => void,\n  popupPosition?: {}\n};\n*/\n\nconst TYPES = ['BUG', 'VULNERABILITY', 'CODE_SMELL'];\n\nexport default class SetTypePopup extends React.PureComponent {\n  /*:: props: Props; */\n\n  render() {\n    return (\n      <BubblePopup\n        position={this.props.popupPosition}\n        customClass=\"bubble-popup-menu bubble-popup-bottom\">\n        <SelectList\n          items={TYPES}\n          currentItem={this.props.issue.type}\n          onSelect={this.props.onSelect}>\n          {TYPES.map(type => (\n            <SelectListItem key={type} item={type}>\n              <IssueTypeIcon className=\"little-spacer-right\" query={type} />\n              {translate('issue.type', type)}\n            </SelectListItem>\n          ))}\n        </SelectList>\n      </BubblePopup>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport BubblePopupHelper from '../../../components/common/BubblePopupHelper';\nimport IssueTypeIcon from '../../../components/ui/IssueTypeIcon';\nimport SetTypePopup from '../popups/SetTypePopup';\nimport { setIssueType } from '../../../api/issues';\nimport { translate } from '../../../helpers/l10n';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {\n  canSetSeverity: boolean,\n  isOpen: boolean,\n  issue: Issue,\n  setIssueProperty: (string, string, apiCall: (Object) => Promise<*>, string) => void,\n  togglePopup: (string, boolean | void) => void\n};\n*/\n\nexport default class IssueType extends React.PureComponent {\n  /*:: props: Props; */\n\n  toggleSetType = (open /*: boolean | void */) => {\n    this.props.togglePopup('set-type', open);\n  };\n\n  setType = (type /*: string */) =>\n    this.props.setIssueProperty('type', 'set-type', setIssueType, type);\n\n  render() {\n    const { issue } = this.props;\n    if (this.props.canSetSeverity) {\n      return (\n        <BubblePopupHelper\n          isOpen={this.props.isOpen && this.props.canSetSeverity}\n          position=\"bottomleft\"\n          togglePopup={this.toggleSetType}\n          popup={<SetTypePopup issue={issue} onSelect={this.setType} />}>\n          <button\n            className=\"button-link issue-action issue-action-with-options js-issue-set-type\"\n            onClick={this.toggleSetType}>\n            <IssueTypeIcon className=\"little-spacer-right\" query={issue.type} />\n            {translate('issue.type', issue.type)}\n            <i className=\"little-spacer-left icon-dropdown\" />\n          </button>\n        </BubblePopupHelper>\n      );\n    } else {\n      return (\n        <span>\n          <IssueTypeIcon className=\"little-spacer-right\" query={issue.type} />\n          {translate('issue.type', issue.type)}\n        </span>\n      );\n    }\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport IssueAssign from './IssueAssign';\nimport IssueCommentAction from './IssueCommentAction';\nimport IssueSeverity from './IssueSeverity';\nimport IssueTags from './IssueTags';\nimport IssueTransition from './IssueTransition';\nimport IssueType from './IssueType';\nimport { updateIssue } from '../actions';\nimport { translate, translateWithParameters } from '../../../helpers/l10n';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {\n  issue: Issue,\n  currentPopup: ?string,\n  onAssign: string => void,\n  onChange: Issue => void,\n  onFail: Error => void,\n  togglePopup: (string, boolean | void) => void\n};\n*/\n\n/*::\ntype State = {\n  commentPlaceholder: string\n};\n*/\n\nexport default class IssueActionsBar extends React.PureComponent {\n  /*:: props: Props; */\n  state /*: State */ = {\n    commentPlaceholder: ''\n  };\n\n  setIssueProperty = (\n    property /*: string */,\n    popup /*: string */,\n    apiCall /*: Object => Promise<*> */,\n    value /*: string */\n  ) => {\n    const { issue } = this.props;\n    if (issue[property] !== value) {\n      const newIssue = { ...issue, [property]: value };\n      updateIssue(\n        this.props.onChange,\n        this.props.onFail,\n        apiCall({ issue: issue.key, [property]: value }),\n        issue,\n        newIssue\n      );\n    }\n    this.props.togglePopup(popup, false);\n  };\n\n  toggleComment = (open /*: boolean | void */, placeholder /*: string | void */) => {\n    this.setState({ commentPlaceholder: placeholder || '' });\n    this.props.togglePopup('comment', open);\n  };\n\n  handleTransition = (issue /*: Issue */) => {\n    this.props.onChange(issue);\n    if (['FALSE-POSITIVE', 'WONTFIX'].includes(issue.resolution)) {\n      this.toggleComment(true, translate('issue.comment.tell_why'));\n    }\n  };\n\n  render() {\n    const { issue } = this.props;\n    const canAssign = issue.actions.includes('assign');\n    const canComment = issue.actions.includes('comment');\n    const canSetSeverity = issue.actions.includes('set_severity');\n    const canSetTags = issue.actions.includes('set_tags');\n    const hasTransitions = issue.transitions && issue.transitions.length > 0;\n\n    return (\n      <table className=\"issue-table\">\n        <tbody>\n          <tr>\n            <td>\n              <ul className=\"list-inline issue-meta-list\">\n                <li className=\"issue-meta\">\n                  <IssueType\n                    isOpen={this.props.currentPopup === 'set-type' && canSetSeverity}\n                    issue={issue}\n                    canSetSeverity={canSetSeverity}\n                    togglePopup={this.props.togglePopup}\n                    setIssueProperty={this.setIssueProperty}\n                  />\n                </li>\n                <li className=\"issue-meta\">\n                  <IssueSeverity\n                    isOpen={this.props.currentPopup === 'set-severity' && canSetSeverity}\n                    issue={issue}\n                    canSetSeverity={canSetSeverity}\n                    togglePopup={this.props.togglePopup}\n                    setIssueProperty={this.setIssueProperty}\n                  />\n                </li>\n                <li className=\"issue-meta\">\n                  <IssueTransition\n                    isOpen={this.props.currentPopup === 'transition' && hasTransitions}\n                    issue={issue}\n                    hasTransitions={hasTransitions}\n                    onChange={this.handleTransition}\n                    onFail={this.props.onFail}\n                    togglePopup={this.props.togglePopup}\n                  />\n                </li>\n                <li className=\"issue-meta\">\n                  <IssueAssign\n                    isOpen={this.props.currentPopup === 'assign' && canAssign}\n                    issue={issue}\n                    canAssign={canAssign}\n                    onAssign={this.props.onAssign}\n                    onFail={this.props.onFail}\n                    togglePopup={this.props.togglePopup}\n                  />\n                </li>\n                {issue.effort && (\n                  <li className=\"issue-meta\">\n                    <span className=\"issue-meta-label\">\n                      {translateWithParameters('issue.x_effort', issue.effort)}\n                    </span>\n                  </li>\n                )}\n                {canComment && (\n                  <IssueCommentAction\n                    commentPlaceholder={this.state.commentPlaceholder}\n                    currentPopup={this.props.currentPopup}\n                    issueKey={issue.key}\n                    onChange={this.props.onChange}\n                    onFail={this.props.onFail}\n                    toggleComment={this.toggleComment}\n                  />\n                )}\n              </ul>\n            </td>\n            <td className=\"issue-table-meta-cell\">\n              <ul className=\"list-inline\">\n                <li className=\"issue-meta js-issue-tags\">\n                  <IssueTags\n                    isOpen={this.props.currentPopup === 'edit-tags' && canSetTags}\n                    canSetTags={canSetTags}\n                    issue={issue}\n                    onChange={this.props.onChange}\n                    onFail={this.props.onFail}\n                    togglePopup={this.props.togglePopup}\n                  />\n                </li>\n              </ul>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport { translate } from '../../../helpers/l10n';\nimport BubblePopup from '../../../components/common/BubblePopup';\n\n/*::\ntype Props = {\n  onDelete: () => void,\n  popupPosition?: {}\n};\n*/\n\nexport default function CommentDeletePopup(props /*: Props */) {\n  return (\n    <BubblePopup position={props.popupPosition} customClass=\"bubble-popup-bottom-right\">\n      <div className=\"text-right\">\n        <div className=\"spacer-bottom\">{translate('issue.comment.delete_confirm_message')}</div>\n        <button className=\"button-red\" onClick={props.onDelete}>\n          {translate('delete')}\n        </button>\n      </div>\n    </BubblePopup>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport Avatar from '../../../components/ui/Avatar';\nimport BubblePopupHelper from '../../../components/common/BubblePopupHelper';\nimport EditIcon from '../../../components/icons-components/EditIcon';\nimport { EditButton, DeleteButton } from '../../../components/ui/buttons';\nimport CommentDeletePopup from '../popups/CommentDeletePopup';\nimport CommentPopup from '../popups/CommentPopup';\nimport DateFromNow from '../../../components/intl/DateFromNow';\n/*:: import type { IssueComment } from '../types'; */\n\n/*::\ntype Props = {\n  comment: IssueComment,\n  onDelete: string => void,\n  onEdit: (string, string) => void\n};\n*/\n\n/*::\ntype State = {\n  openPopup: string\n};\n*/\n\nexport default class IssueCommentLine extends React.PureComponent {\n  /*:: props: Props; */\n  state /*: State */ = {\n    openPopup: ''\n  };\n\n  handleCommentClick = (event /*: Event & {target: HTMLElement}*/) => {\n    if (event.target.tagName === 'A') {\n      event.stopPropagation();\n    }\n  };\n\n  handleEdit = (text /*: string */) => {\n    this.props.onEdit(this.props.comment.key, text);\n    this.toggleEditPopup(false);\n  };\n\n  handleDelete = () => {\n    this.props.onDelete(this.props.comment.key);\n    this.toggleDeletePopup(false);\n  };\n\n  togglePopup = (popupName /*: string */, force /*: ?boolean */) => {\n    this.setState((prevState /*: State */) => {\n      if (prevState.openPopup !== popupName && force !== false) {\n        return { openPopup: popupName };\n      } else if (prevState.openPopup === popupName && force !== true) {\n        return { openPopup: '' };\n      }\n      return prevState;\n    });\n  };\n\n  toggleDeletePopup = (force /*: ?boolean */) => this.togglePopup('delete', force);\n\n  toggleEditPopup = (force /*: ?boolean */) => this.togglePopup('edit', force);\n\n  render() {\n    const { comment } = this.props;\n    return (\n      <div className=\"issue-comment\">\n        <div className=\"issue-comment-author\" title={comment.authorName}>\n          <Avatar\n            className=\"little-spacer-right\"\n            hash={comment.authorAvatar}\n            name={comment.authorName}\n            size={16}\n          />\n          {comment.authorName}\n        </div>\n        <div\n          className=\"issue-comment-text markdown\"\n          dangerouslySetInnerHTML={{ __html: comment.htmlText }}\n          onClick={this.handleCommentClick}\n          role=\"Listitem\"\n          tabIndex={0}\n        />\n        <div className=\"issue-comment-age\">\n          <DateFromNow date={comment.createdAt} />\n        </div>\n        <div className=\"issue-comment-actions\">\n          {comment.updatable && (\n            <BubblePopupHelper\n              className=\"bubble-popup-helper-inline\"\n              isOpen={this.state.openPopup === 'edit'}\n              offset={{ vertical: 0, horizontal: -6 }}\n              position=\"bottomright\"\n              togglePopup={this.toggleDeletePopup}\n              popup={\n                <CommentPopup\n                  comment={comment}\n                  customClass=\"issue-edit-comment-bubble-popup\"\n                  onComment={this.handleEdit}\n                  placeholder=\"\"\n                  toggleComment={this.toggleEditPopup}\n                />\n              }>\n              <EditButton\n                className=\"js-issue-comment-edit button-small\"\n                onClick={this.toggleEditPopup}\n              />\n            </BubblePopupHelper>\n          )}\n          {comment.updatable && (\n            <BubblePopupHelper\n              className=\"bubble-popup-helper-inline\"\n              isOpen={this.state.openPopup === 'delete'}\n              offset={{ vertical: 0, horizontal: -10 }}\n              position=\"bottomright\"\n              togglePopup={this.toggleDeletePopup}\n              popup={<CommentDeletePopup onDelete={this.handleDelete} />}>\n              <DeleteButton\n                className=\"js-issue-comment-delete button-small\"\n                onClick={this.toggleDeletePopup}\n              />\n            </BubblePopupHelper>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport classNames from 'classnames';\nimport IssueTitleBar from './components/IssueTitleBar';\nimport IssueActionsBar from './components/IssueActionsBar';\nimport IssueCommentLine from './components/IssueCommentLine';\nimport { updateIssue } from './actions';\nimport { deleteIssueComment, editIssueComment } from '../../api/issues';\n/*:: import type { Issue } from './types'; */\n\n/*::\ntype Props = {|\n  branchLike?: { id?: string; name: string },\n  checked?: boolean,\n  currentPopup: ?string,\n  displayLocationsCount?: boolean;\n  displayLocationsLink?: boolean;\n  issue: Issue,\n  onAssign: string => void,\n  onChange: Issue => void,\n  onCheck?: (issue: string, event: Event) => void,\n  onClick: string => void,\n  onFail: Error => void,\n  onFilter?: (property: string, issue: Issue) => void,\n  selected: boolean,\n  togglePopup: (string, boolean | void) => void\n|};\n*/\n\nexport default class IssueView extends React.PureComponent {\n  /*:: props: Props; */\n\n  handleCheck = (event /*: Event */) => {\n    event.preventDefault();\n    event.stopPropagation();\n    if (this.props.onCheck) {\n      this.props.onCheck(this.props.issue.key, event);\n    }\n  };\n\n  handleClick = (event /*: Event & { target: HTMLElement } */) => {\n    event.preventDefault();\n    if (this.props.onClick) {\n      this.props.onClick(this.props.issue.key);\n    }\n  };\n\n  editComment = (comment /*: string */, text /*: string */) => {\n    updateIssue(this.props.onChange, this.props.onFail, editIssueComment({ comment, text }));\n  };\n\n  deleteComment = (comment /*: string */) => {\n    updateIssue(this.props.onChange, this.props.onFail, deleteIssueComment({ comment }));\n  };\n\n  render() {\n    const { issue } = this.props;\n\n    const hasCheckbox = this.props.onCheck != null;\n\n    const issueClass = classNames('issue', {\n      'issue-with-checkbox': hasCheckbox,\n      selected: this.props.selected\n    });\n\n    return (\n      <div\n        className={issueClass}\n        data-issue={issue.key}\n        onClick={this.handleClick}\n        role=\"listitem\"\n        tabIndex={0}>\n        <IssueTitleBar\n          branchLike={this.props.branchLike}\n          currentPopup={this.props.currentPopup}\n          displayLocationsCount={this.props.displayLocationsCount}\n          displayLocationsLink={this.props.displayLocationsLink}\n          issue={issue}\n          onFail={this.props.onFail}\n          onFilter={this.props.onFilter}\n          togglePopup={this.props.togglePopup}\n        />\n        <IssueActionsBar\n          issue={issue}\n          currentPopup={this.props.currentPopup}\n          onAssign={this.props.onAssign}\n          onFail={this.props.onFail}\n          togglePopup={this.props.togglePopup}\n          onChange={this.props.onChange}\n        />\n        {issue.comments &&\n          issue.comments.length > 0 && (\n            <div className=\"issue-comments\">\n              {issue.comments.map(comment => (\n                <IssueCommentLine\n                  comment={comment}\n                  key={comment.key}\n                  onEdit={this.editComment}\n                  onDelete={this.deleteComment}\n                />\n              ))}\n            </div>\n          )}\n        <a className=\"issue-navigate js-issue-navigate\">\n          <i className=\"issue-navigate-to-left icon-chevron-left\" />\n          <i className=\"issue-navigate-to-right icon-chevron-right\" />\n        </a>\n        {hasCheckbox && (\n          <a className=\"js-toggle issue-checkbox-container\" href=\"#\" onClick={this.handleCheck}>\n            <i\n              className={classNames('issue-checkbox', 'icon-checkbox', {\n                'icon-checkbox-checked': this.props.checked\n              })}\n            />\n          </a>\n        )}\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport key from 'keymaster';\nimport PropTypes from 'prop-types';\nimport IssueView from './IssueView';\nimport { updateIssue } from './actions';\nimport { onFail } from '../../store/rootActions';\nimport { setIssueAssignee } from '../../api/issues';\n/*:: import type { Issue as IssueType } from './types'; */\n\n/*::\ntype Props = {|\n  branchLike?: { id?: string; name: string },\n  checked?: boolean,\n  displayLocationsCount?: boolean;\n  displayLocationsLink?: boolean;\n  issue: IssueType,\n  onChange: IssueType => void,\n  onCheck?: (issue: string, event: Event) => void,\n  onClick: string => void,\n  onFilter?: (property: string, issue: IssueType) => void,\n  onPopupToggle: (issue: string, popupName: string, open: ?boolean) => void,\n  openPopup: ?string,\n  selected: boolean\n|};\n*/\n\nexport default class Issue extends React.PureComponent {\n  /*:: props: Props; */\n\n  static contextTypes = {\n    store: PropTypes.object\n  };\n\n  static defaultProps = {\n    displayLocationsCount: true,\n    displayLocationsLink: true,\n    selected: false\n  };\n\n  componentDidMount() {\n    if (this.props.selected) {\n      this.bindShortcuts();\n    }\n  }\n\n  componentWillUpdate(nextProps /*: Props */) {\n    if (!nextProps.selected && this.props.selected) {\n      this.unbindShortcuts();\n    }\n  }\n\n  componentDidUpdate(prevProps /*: Props */) {\n    if (!prevProps.selected && this.props.selected) {\n      this.bindShortcuts();\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.props.selected) {\n      this.unbindShortcuts();\n    }\n  }\n\n  bindShortcuts() {\n    key('f', 'issues', () => {\n      this.togglePopup('transition');\n      return false;\n    });\n    key('a', 'issues', () => {\n      this.togglePopup('assign');\n      return false;\n    });\n    key('m', 'issues', () => {\n      if (this.props.issue.actions.includes('assign')) {\n        this.handleAssignement('_me');\n      }\n      return false;\n    });\n    key('i', 'issues', () => {\n      this.togglePopup('set-severity');\n      return false;\n    });\n    key('c', 'issues', () => {\n      this.togglePopup('comment');\n      return false;\n    });\n    key('t', 'issues', () => {\n      this.togglePopup('edit-tags');\n      return false;\n    });\n    key('space', 'issues', (event /*: Event*/) => {\n      if (this.props.onCheck) {\n        this.props.onCheck(this.props.issue.key, event);\n        return false;\n      }\n      return undefined;\n    });\n  }\n\n  unbindShortcuts() {\n    key.unbind('f', 'issues');\n    key.unbind('a', 'issues');\n    key.unbind('m', 'issues');\n    key.unbind('i', 'issues');\n    key.unbind('c', 'issues');\n    key.unbind('space', 'issues');\n    key.unbind('t', 'issues');\n  }\n\n  togglePopup = (popupName /*: string */, open /*: ?boolean */) => {\n    this.props.onPopupToggle(this.props.issue.key, popupName, open);\n  };\n\n  handleAssignement = (login /*: string */) => {\n    const { issue } = this.props;\n    if (issue.assignee !== login) {\n      updateIssue(\n        this.props.onChange,\n        this.handleFail,\n        setIssueAssignee({ issue: issue.key, assignee: login })\n      );\n    }\n    this.togglePopup('assign', false);\n  };\n\n  handleFail = (error /*: Error */) => {\n    onFail(this.context.store.dispatch)(error);\n  };\n\n  render() {\n    return (\n      <IssueView\n        branchLike={this.props.branchLike}\n        checked={this.props.checked}\n        currentPopup={this.props.openPopup}\n        displayLocationsCount={this.props.displayLocationsCount}\n        displayLocationsLink={this.props.displayLocationsLink}\n        issue={this.props.issue}\n        onAssign={this.handleAssignement}\n        onCheck={this.props.onCheck}\n        onClick={this.props.onClick}\n        onFail={this.handleFail}\n        onFilter={this.props.onFilter}\n        onChange={this.props.onChange}\n        selected={this.props.selected}\n        togglePopup={this.togglePopup}\n      />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport classNames from 'classnames';\nimport './LocationMessage.css';\n\n/*::\ntype Props = {\n  children?: React.Element<*>,\n  selected: boolean\n};\n*/\n\nexport default function LocationMessage(props /*: Props */) {\n  return (\n    <div className={classNames('location-message', { selected: props.selected })}>\n      {props.children}\n    </div>\n  );\n}\n"],"sourceRoot":""}
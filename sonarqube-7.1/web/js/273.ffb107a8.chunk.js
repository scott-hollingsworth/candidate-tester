(window.webpackJsonp=window.webpackJsonp||[]).push([[273],{1012:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1020);function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a(r).default}}),Object.defineProperty(t,"AutoSizer",{enumerable:!0,get:function(){return a(r).default}})},1016:function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},1017:function(e,t,n){"use strict";var r=n(60),a=n(71),o=n(1016);e.exports=function(){function e(e,t,n,r,s,i){i!==o&&a(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return n.checkPropTypes=r,n.PropTypes=n,n}},1018:function(e,t,n){"use strict";Object.defineProperty(t,"babelPluginFlowReactPropTypes_proptype_Size",{value:{height:n(992).number.isRequired,width:n(992).number.isRequired},configurable:!0})},1019:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t;t="undefined"!=typeof window?window:"undefined"!=typeof self?self:this;var n="undefined"!=typeof document&&document.attachEvent;if(!n){var r=(b=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||function(e){return t.setTimeout(e,20)},function(e){return b(e)}),a=(v=t.cancelAnimationFrame||t.mozCancelAnimationFrame||t.webkitCancelAnimationFrame||t.clearTimeout,function(e){return v(e)}),o=function(e){var t=e.__resizeTriggers__,n=t.firstElementChild,r=t.lastElementChild,a=n.firstElementChild;r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight,a.style.width=n.offsetWidth+1+"px",a.style.height=n.offsetHeight+1+"px",n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight},s=function(e){if(!(e.target.className.indexOf("contract-trigger")<0&&e.target.className.indexOf("expand-trigger")<0)){var t=this;o(this),this.__resizeRAF__&&a(this.__resizeRAF__),this.__resizeRAF__=r(function(){(function(e){return e.offsetWidth!=e.__resizeLast__.width||e.offsetHeight!=e.__resizeLast__.height})(t)&&(t.__resizeLast__.width=t.offsetWidth,t.__resizeLast__.height=t.offsetHeight,t.__resizeListeners__.forEach(function(n){n.call(t,e)}))})}},i=!1,c="",l="animationstart",p="Webkit Moz O ms".split(" "),u="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),d="",m=document.createElement("fakeelement");if(void 0!==m.style.animationName&&(i=!0),!1===i)for(var h=0;h<p.length;h++)if(void 0!==m.style[p[h]+"AnimationName"]){d=p[h],c="-"+d.toLowerCase()+"-",l=u[h],i=!0;break}var f="resizeanim",y="@"+c+"keyframes "+f+" { from { opacity: 0; } to { opacity: 0; } } ",g=c+"animation: 1ms "+f+"; "}var v;var b;return{addResizeListener:function(r,a){if(n)r.attachEvent("onresize",a);else{if(!r.__resizeTriggers__){var i=t.getComputedStyle(r);i&&"static"==i.position&&(r.style.position="relative"),function(){if(!document.getElementById("detectElementResize")){var t=(y||"")+".resize-triggers { "+(g||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.id="detectElementResize",r.type="text/css",null!=e&&r.setAttribute("nonce",e),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t)),n.appendChild(r)}}(),r.__resizeLast__={},r.__resizeListeners__=[],(r.__resizeTriggers__=document.createElement("div")).className="resize-triggers",r.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',r.appendChild(r.__resizeTriggers__),o(r),r.addEventListener("scroll",s,!0),l&&(r.__resizeTriggers__.__animationListener__=function(e){e.animationName==f&&o(r)},r.__resizeTriggers__.addEventListener(l,r.__resizeTriggers__.__animationListener__))}r.__resizeListeners__.push(a)}},removeResizeListener:function(e,t){if(n)e.detachEvent("onresize",t);else if(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(t),1),!e.__resizeListeners__.length){e.removeEventListener("scroll",s,!0),e.__resizeTriggers__.__animationListener__&&(e.__resizeTriggers__.removeEventListener(l,e.__resizeTriggers__.__animationListener__),e.__resizeTriggers__.__animationListener__=null);try{e.__resizeTriggers__=!e.removeChild(e.__resizeTriggers__)}catch(e){}}}}}},1020:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=s(n(0)),o=s(n(1019));function s(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}n(1018).babelPluginFlowReactPropTypes_proptype_Size||n(992).any;var c=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=Array(a),s=0;s<a;s++)o[s]=arguments[s];return n=r=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),r.state={height:r.props.defaultHeight||0,width:r.props.defaultWidth||0},r._onResize=function(){var e=r.props,t=e.disableHeight,n=e.disableWidth,a=e.onResize;if(r._parentNode){var o=r._parentNode.offsetHeight||0,s=r._parentNode.offsetWidth||0,i=window.getComputedStyle(r._parentNode)||{},c=parseInt(i.paddingLeft,10)||0,l=parseInt(i.paddingRight,10)||0,p=parseInt(i.paddingTop,10)||0,u=parseInt(i.paddingBottom,10)||0,d=o-p-u,m=s-c-l;(!t&&r.state.height!==d||!n&&r.state.width!==m)&&(r.setState({height:o-p-u,width:s-c-l}),a({height:o,width:s}))}},r._setRef=function(e){r._autoSizer=e},i(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default.PureComponent),r(t,[{key:"componentDidMount",value:function(){var e=this.props.nonce;this._autoSizer&&this._autoSizer.parentNode instanceof HTMLElement&&(this._parentNode=this._autoSizer.parentNode,this._detectElementResize=(0,o.default)(e),this._detectElementResize.addResizeListener(this._parentNode,this._onResize),this._onResize())}},{key:"componentWillUnmount",value:function(){this._detectElementResize&&this._parentNode&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize)}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.disableHeight,r=e.disableWidth,o=this.state,s=o.height,i=o.width,c={overflow:"visible"},l={};return n||(c.height=0,l.height=s),r||(c.width=0,l.width=i),a.default.createElement("div",{ref:this._setRef,style:c},t(l))}}]),t}();c.defaultProps={onResize:function(){},disableHeight:!1,disableWidth:!1},c.propTypes={children:n(992).func.isRequired,defaultHeight:n(992).number,defaultWidth:n(992).number,disableHeight:n(992).bool.isRequired,disableWidth:n(992).bool.isRequired,nonce:n(992).string,onResize:n(992).func.isRequired},t.default=c},1025:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(0),a=n(27),o=n(28),s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},i={hour:"numeric",minute:"numeric"},c={hour:"numeric",minute:"numeric",second:"numeric"};function l(e){var t=e.children,n=e.date,l=e.long;return r.createElement(a.d,s({value:Object(o.e)(n)},l?c:i),t)}},1026:function(e,t,n){"use strict";var r,a=n(0),o=n(6),s=n(250),i=n(1),c=(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleFromChange=function(e){t.props.onChange({from:e,to:t.to}),setTimeout(function(){e&&!t.to&&t.toDateInput&&t.toDateInput.focus()},0)},t.handleToChange=function(e){t.setState({to:e}),t.props.onChange({from:t.from,to:e})},t}return c(t,e),Object.defineProperty(t.prototype,"from",{get:function(){return this.props.value&&this.props.value.from},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"to",{get:function(){return this.props.value&&this.props.value.to},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this;return a.createElement("div",{className:o("display-inline-flex-center",this.props.className)},a.createElement(s.a,{currentMonth:this.to,"data-test":"from",highlightTo:this.to,maxDate:this.to,onChange:this.handleFromChange,placeholder:Object(i.l)("start_date"),value:this.from}),a.createElement("span",{className:"note little-spacer-left little-spacer-right"},Object(i.l)("to_")),a.createElement(s.a,{currentMonth:this.from,"data-test":"to",highlightFrom:this.from,minDate:this.from,onChange:this.handleToChange,placeholder:Object(i.l)("end_date"),ref:function(t){return e.toDateInput=t},value:this.to}))},t}(a.PureComponent);t.a=l},1043:function(e,t,n){"use strict";var r,a=n(0),o=n(6),s=n(4),i=(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSelect=function(e){e.stopPropagation(),e.preventDefault(),e.currentTarget.blur(),t.props.disabled||t.props.onSelectChange(t.props.element,!t.props.selected)},t.handleHover=function(){return t.props.onHover(t.props.element)},t}return i(t,e),t.prototype.render=function(){var e=this.props,t=e.selected,n=e.disabled,r=o("icon-checkbox",{"icon-checkbox-checked":t,"icon-checkbox-invisible":n}),s=o({active:this.props.active,disabled:n});return a.createElement("li",null,a.createElement("a",{className:s,href:"#",onClick:this.handleSelect,onFocus:this.handleHover,onMouseOver:this.handleHover},a.createElement("i",{className:r})," ",this.props.custom&&"+ ",this.props.renderLabel(this.props.element)))},t}(a.PureComponent),l=n(47),p=n(1),u=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),d=function(e){function t(t){var n=e.call(this,t)||this;return n.mounted=!1,n.handleSelectChange=function(e,t){t?n.onSelectItem(e):n.onUnselectItem(e)},n.handleSearchChange=function(e){n.onSearchQuery(n.props.validateSearchInput(e))},n.handleElementHover=function(e){n.setState(function(t,r){return{activeIdx:n.getAllElements(r,t).indexOf(e)}})},n.handleKeyboard=function(e){switch(e.keyCode){case 40:e.stopPropagation(),e.preventDefault(),n.setState(n.selectNextElement);break;case 38:e.stopPropagation(),e.preventDefault(),n.setState(n.selectPreviousElement);break;case 37:case 39:e.stopPropagation();break;case 13:n.state.activeIdx>=0&&n.toggleSelect(n.getAllElements(n.props,n.state)[n.state.activeIdx])}},n.onSearchQuery=function(e){n.setState({activeIdx:0,loading:!0,query:e}),n.props.onSearch(e).then(n.stopLoading,n.stopLoading)},n.onSelectItem=function(e){n.isNewElement(e,n.props)&&n.onSearchQuery(""),n.props.onSelect(e)},n.onUnselectItem=function(e){return n.props.onUnselect(e)},n.isNewElement=function(e,t){var n=t.selectedElements,r=t.elements;return e.length>0&&-1===n.indexOf(e)&&-1===r.indexOf(e)},n.updateSelectedElements=function(e){n.setState(function(t){return t.query?{selectedElements:e.filterSelected(t.query,e.selectedElements)}:{selectedElements:e.selectedElements.slice()}})},n.updateUnselectedElements=function(e){n.setState(function(t){return 0===e.listSize?{unselectedElements:Object(s.difference)(e.elements,e.selectedElements)}:e.listSize<t.selectedElements.length?{unselectedElements:[]}:{unselectedElements:Object(s.difference)(e.elements,e.selectedElements).slice(0,e.listSize-t.selectedElements.length)}})},n.getAllElements=function(e,t){return n.isNewElement(t.query,e)?t.selectedElements.concat(t.unselectedElements,[t.query]):t.selectedElements.concat(t.unselectedElements)},n.setElementActive=function(e){return n.setState({activeIdx:e})},n.selectNextElement=function(e,t){var r=e.activeIdx,a=n.getAllElements(t,e);return r<0||r>=a.length-1?{activeIdx:0}:{activeIdx:r+1}},n.selectPreviousElement=function(e,t){var r=e.activeIdx,a=n.getAllElements(t,e);return r<=0?{activeIdx:a.length-1}:{activeIdx:r-1}},n.stopLoading=function(){n.mounted&&n.setState({loading:!1})},n.toggleSelect=function(e){-1===n.props.selectedElements.indexOf(e)?n.onSelectItem(e):n.onUnselectItem(e)},n.state={activeIdx:0,loading:!0,query:"",selectedElements:[],unselectedElements:[]},n}return u(t,e),t.prototype.componentDidMount=function(){this.mounted=!0,this.onSearchQuery(""),this.updateSelectedElements(this.props),this.updateUnselectedElements(this.props),this.container&&this.container.addEventListener("keydown",this.handleKeyboard,!0)},t.prototype.componentWillReceiveProps=function(e){if(this.props.elements!==e.elements||this.props.selectedElements!==e.selectedElements){this.updateSelectedElements(e),this.updateUnselectedElements(e);var t=this.getAllElements(e,this.state).length;this.state.activeIdx>=t&&this.setState({activeIdx:t-1})}},t.prototype.componentDidUpdate=function(){this.searchInput&&this.searchInput.focus()},t.prototype.componentWillUnmount=function(){this.mounted=!1,this.container&&this.container.removeEventListener("keydown",this.handleKeyboard)},t.prototype.render=function(){var e=this,t=this.props,n=t.allowSelection,r=void 0===n||n,s=t.allowNewElements,i=void 0===s||s,u=t.footerNode,d=void 0===u?"":u,m=this.props.renderLabel,h=this.state,f=h.query,y=h.activeIdx,g=h.selectedElements,v=h.unselectedElements,b=this.getAllElements(this.props,this.state)[y],_=i&&this.isNewElement(f,this.props),E=0===this.props.listSize,O=o("menu",{"menu-vertically-limited":E,"spacer-top":E,"with-top-separator":E,"with-bottom-separator":Boolean(d)});return a.createElement("div",{className:"multi-select",ref:function(t){return e.container=t}},a.createElement("div",{className:"menu-search"},a.createElement(l.a,{autoFocus:!0,className:"little-spacer-top",loading:this.state.loading,onChange:this.handleSearchChange,placeholder:this.props.placeholder,value:f})),a.createElement("ul",{className:O},g.length>0&&g.map(function(t){return a.createElement(c,{active:b===t,element:t,key:t,onHover:e.handleElementHover,onSelectChange:e.handleSelectChange,renderLabel:m,selected:!0})}),v.length>0&&v.map(function(t){return a.createElement(c,{active:b===t,disabled:!r,element:t,key:t,onHover:e.handleElementHover,onSelectChange:e.handleSelectChange,renderLabel:m})}),_&&a.createElement(c,{active:b===f,custom:!0,element:f,key:f,onHover:this.handleElementHover,onSelectChange:this.handleSelectChange,renderLabel:m}),!_&&g.length<1&&v.length<1&&a.createElement("li",{className:"spacer-left"},Object(p.m)("no_results_for_x",f))),d)},t.defaultProps={filterSelected:function(e,t){return t.filter(function(t){return t.includes(e)})},listSize:0,renderLabel:function(e){return e},validateSearchInput:function(e){return e}},t}(a.PureComponent);t.a=d},1075:function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"b",function(){return s}),n.d(t,"d",function(){return i}),n.d(t,"a",function(){return c}),n.d(t,"c",function(){return l});var r=n(3),a=n(13);function o(e){return Object(r.getJSON)("/api/project_analyses/search",e).catch(a.a)}function s(e,t,n,o){var s={analysis:e,name:t};return n&&(s.category=n),o&&(s.description=o),Object(r.postJSON)("/api/project_analyses/create_event",s).then(function(e){return e.event},a.a)}function i(e){return Object(r.post)("/api/project_analyses/delete_event",{event:e}).catch(a.a)}function c(e,t,n){var o={event:e};return t&&(o.name=t),n&&(o.description=n),Object(r.postJSON)("/api/project_analyses/update_event",o).then(function(e){return e.event},a.a)}function l(e){return Object(r.post)("/api/project_analyses/delete",{analysis:e}).catch(a.a)}},1107:function(e,t,n){},1182:function(e,t,n){"use strict";n.r(t);var r,a=n(0),o=n.n(a),s=n(5),i=n.n(s),c=n(22),l=n.n(c),p=n(251),u=(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleMouseDown=function(e){e.preventDefault(),e.stopPropagation(),t.props.onSelect(t.props.option,e)},t.handleMouseEnter=function(e){t.props.onFocus(t.props.option,e)},t.handleMouseMove=function(e){t.props.isFocused||t.props.onFocus(t.props.option,e)},t}return u(t,e),t.prototype.render=function(){var e=this.props.option;return o.a.createElement("div",{className:this.props.className,onMouseDown:this.handleMouseDown,onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,title:e.label},o.a.createElement(p.a,{className:"project-activity-event-icon "+e.value}),o.a.createElement("span",{className:"little-spacer-left"},this.props.children))},t}(o.a.PureComponent);function m(e){var t=e.value;return o.a.createElement("div",{className:"Select-value",title:t.label},o.a.createElement("div",{className:"Select-value-label"},o.a.createElement(p.a,{className:"project-activity-event-icon "+t.value}),o.a.createElement("span",{className:"little-spacer-left"},e.children)))}var h=n(1026),f=n(1),y=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleChange=function(e){var n=e.from,r=e.to;t.props.onChange({from:n,to:r})},t.handleResetClick=function(){t.props.onChange({from:null,to:null})},t}return y(t,e),t.prototype.render=function(){return o.a.createElement("div",null,o.a.createElement(h.a,{onChange:this.handleChange,value:{from:this.props.from,to:this.props.to}}),o.a.createElement("button",{className:"spacer-left",onClick:this.handleResetClick,disabled:null==this.props.from&&null==this.props.to},Object(f.l)("project_activity.reset_dates")))},t}(o.a.PureComponent),v=n(1009),b=n(51),_=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleCategoryChange=function(e){return t.props.updateQuery({category:e?e.value:""})},t}return _(t,e),t.prototype.render=function(){var e="APP"===this.props.project.qualifier?v.a:v.c;return this.options=e.map(function(e){return{label:Object(f.l)("event.category",e),value:e}}),o.a.createElement("header",{className:"page-header"},!["VW","SVW"].includes(this.props.project.qualifier)&&o.a.createElement(b.c,{className:"input-medium pull-left big-spacer-right",placeholder:Object(f.l)("project_activity.filter_events")+"...",clearable:!0,searchable:!1,value:this.props.category,optionComponent:d,valueComponent:m,options:this.options,onChange:this.handleCategoryChange}),o.a.createElement(g,{className:"pull-left",from:this.props.from,to:this.props.to,onChange:this.props.updateQuery}))},t}(o.a.PureComponent),O=n(6),j=n.n(O),S=n(4),N=n(25);function P(e){var t=e.event;return o.a.createElement("div",{className:"project-activity-event-inner"},o.a.createElement("div",{className:"project-activity-event-inner-icon little-spacer-right"},o.a.createElement(p.a,{className:"project-activity-event-icon margin-align "+t.category})),o.a.createElement(N.a,{mouseEnterDelay:.5,overlay:t.name},o.a.createElement("span",{className:"project-activity-event-inner-text"},o.a.createElement("span",{className:"note"},Object(f.l)("event.category",t.category),":")," ",o.a.createElement("strong",{title:t.description},t.name))))}var C=n(20),D=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),w=function(e){function t(t){var n=e.call(this,t)||this;return n.closeForm=function(){n.mounted&&n.setState({name:n.props.event.name}),n.props.onClose()},n.changeInput=function(e){n.mounted&&n.setState({name:e.target.value})},n.stopProcessing=function(){n.mounted&&n.setState({processing:!1})},n.stopProcessingAndClose=function(){n.mounted&&n.setState({processing:!1}),n.props.onClose()},n.handleSubmit=function(e){e.preventDefault(),n.setState({processing:!0}),n.props.changeEvent(n.props.event.key,n.state.name).then(n.stopProcessingAndClose,n.stopProcessing)},n.state={processing:!1,name:t.event.name},n}return D(t,e),t.prototype.componentDidMount=function(){this.mounted=!0},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){var e=Object(f.l)(this.props.changeEventButtonText);return o.a.createElement(C.a,{contentLabel:e,onRequestClose:this.closeForm},o.a.createElement("header",{className:"modal-head"},o.a.createElement("h2",null,e)),o.a.createElement("form",{onSubmit:this.handleSubmit},o.a.createElement("div",{className:"modal-body"},o.a.createElement("div",{className:"modal-field"},o.a.createElement("label",null,Object(f.l)("name")),o.a.createElement("input",{value:this.state.name,autoFocus:!0,disabled:this.state.processing,type:"text",onChange:this.changeInput}))),o.a.createElement("footer",{className:"modal-foot"},this.state.processing?o.a.createElement("i",{className:"spinner"}):o.a.createElement("div",null,o.a.createElement("button",{type:"submit"},Object(f.l)("change_verb")),o.a.createElement("button",{type:"reset",className:"button-link",onClick:this.closeForm},Object(f.l)("cancel"))))))},t}(o.a.PureComponent),k=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={processing:!1},t.closeForm=function(){t.props.onClose()},t.stopProcessing=function(){t.mounted&&t.setState({processing:!1})},t.stopProcessingAndClose=function(){t.mounted&&t.setState({processing:!1}),t.props.onClose()},t.handleSubmit=function(e){e.preventDefault(),t.setState({processing:!0}),t.props.deleteEvent(t.props.analysis,t.props.event.key).then(t.stopProcessingAndClose,t.stopProcessing)},t}return k(t,e),t.prototype.componentDidMount=function(){this.mounted=!0},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){var e=Object(f.l)(this.props.removeEventButtonText);return o.a.createElement(C.a,{contentLabel:e,onRequestClose:this.closeForm},o.a.createElement("header",{className:"modal-head"},o.a.createElement("h2",null,e)),o.a.createElement("form",{onSubmit:this.handleSubmit},o.a.createElement("div",{className:"modal-body"},Object(f.l)(this.props.removeEventQuestion)),o.a.createElement("footer",{className:"modal-foot"},this.state.processing?o.a.createElement("i",{className:"spinner"}):o.a.createElement("div",null,o.a.createElement("button",{type:"submit",className:"button-red",autoFocus:!0},Object(f.l)("delete")),o.a.createElement("button",{type:"reset",className:"button-link",onClick:this.closeForm},Object(f.l)("cancel"))))))},t}(o.a.PureComponent),M=n(11),T=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={changing:!1,deleting:!1},t.startChanging=function(){t.setState({changing:!0})},t.stopChanging=function(){t.mounted&&t.setState({changing:!1})},t.startDeleting=function(){t.setState({deleting:!0})},t.stopDeleting=function(){t.mounted&&t.setState({deleting:!1})},t}return T(t,e),t.prototype.componentDidMount=function(){this.mounted=!0},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){var e=this.props,t=e.event,n=e.canAdmin,r="OTHER"===t.category,a=!r&&"VERSION"===t.category,s=r||a,i=r||a&&!this.props.isFirst,c=n&&(s||i);return o.a.createElement("div",{className:"project-activity-event"},o.a.createElement(P,{event:this.props.event}),c&&o.a.createElement("div",{className:"project-activity-event-actions spacer-left"},s&&o.a.createElement(M.d,{className:"js-change-event button-small",onClick:this.startChanging}),i&&o.a.createElement(M.c,{className:"js-delete-event button-small",onClick:this.startDeleting})),this.state.changing&&o.a.createElement(w,{changeEventButtonText:"project_activity."+(a?"change_version":"change_custom_event"),changeEvent:this.props.changeEvent,event:this.props.event,onClose:this.stopChanging}),this.state.deleting&&o.a.createElement(x,{analysis:this.props.analysis,deleteEvent:this.props.deleteEvent,event:this.props.event,onClose:this.stopDeleting,removeEventButtonText:"project_activity."+(a?"remove_version":"remove_custom_event"),removeEventQuestion:"project_activity."+(a?"remove_version":"remove_custom_event")+".question"}))},t}(o.a.PureComponent);function A(e){var t=Object(S.sortBy)(e.events,function(e){return"VERSION"===e.category?1:0},"category");return o.a.createElement("div",{className:"project-activity-events"},t.map(function(t){return o.a.createElement(L,{analysis:e.analysis,canAdmin:e.canAdmin,changeEvent:e.changeEvent,deleteEvent:e.deleteEvent,event:t,isFirst:e.isFirst,key:t.key})}))}var z=n(31),q=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={open:!1,processing:!1,name:""},t.openForm=function(){t.setState({open:!0})},t.closeForm=function(){t.mounted&&t.setState({open:!1,name:""})},t.changeInput=function(e){t.mounted&&t.setState({name:e.target.value})},t.stopProcessing=function(){t.mounted&&t.setState({processing:!1})},t.stopProcessingAndClose=function(){t.mounted&&t.setState({open:!1,processing:!1,name:""})},t.handleSubmit=function(e){e.preventDefault(),t.setState({processing:!0}),t.props.addEvent(t.props.analysis.key,t.state.name).then(t.stopProcessingAndClose,t.stopProcessing)},t}return q(t,e),t.prototype.componentDidMount=function(){this.mounted=!0},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.renderModal=function(){var e=Object(f.l)(this.props.addEventButtonText);return o.a.createElement(C.a,{key:"add-event-modal",contentLabel:e,onRequestClose:this.closeForm},o.a.createElement("header",{className:"modal-head"},o.a.createElement("h2",null,e)),o.a.createElement("form",{onSubmit:this.handleSubmit},o.a.createElement("div",{className:"modal-body"},o.a.createElement("div",{className:"modal-field"},o.a.createElement("label",null,Object(f.l)("name")),o.a.createElement("input",{value:this.state.name,autoFocus:!0,disabled:this.state.processing,type:"text",onChange:this.changeInput}))),o.a.createElement("footer",{className:"modal-foot"},this.state.processing?o.a.createElement("i",{className:"spinner"}):o.a.createElement("div",null,o.a.createElement("button",{type:"submit"},Object(f.l)("save")),o.a.createElement("button",{type:"reset",className:"button-link",onClick:this.closeForm},Object(f.l)("cancel"))))))},t.prototype.render=function(){var e=o.a.createElement(z.b,{className:"js-add-event",onClick:this.openForm},Object(f.l)(this.props.addEventButtonText));return this.state.open?[e,this.renderModal()]:e},t}(o.a.PureComponent),H=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={open:!1,processing:!1},t.openForm=function(){t.setState({open:!0})},t.closeForm=function(){t.mounted&&t.setState({open:!1})},t.stopProcessing=function(){t.mounted&&t.setState({processing:!1})},t.stopProcessingAndClose=function(){t.mounted&&t.setState({open:!1,processing:!1})},t.handleSubmit=function(e){e.preventDefault(),t.setState({processing:!0}),t.props.deleteAnalysis(t.props.analysis.key).then(t.stopProcessingAndClose,t.stopProcessing)},t}return H(t,e),t.prototype.componentDidMount=function(){this.mounted=!0},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.renderModal=function(){var e=Object(f.l)("project_activity.delete_analysis");return o.a.createElement(C.a,{key:"delete-analysis-modal",contentLabel:e,onRequestClose:this.closeForm},o.a.createElement("header",{className:"modal-head"},o.a.createElement("h2",null,e)),o.a.createElement("form",{onSubmit:this.handleSubmit},o.a.createElement("div",{className:"modal-body"},Object(f.l)("project_activity.delete_analysis.question")),o.a.createElement("footer",{className:"modal-foot"},this.state.processing?o.a.createElement("i",{className:"spinner"}):o.a.createElement("div",null,o.a.createElement("button",{type:"submit",className:"button-red",autoFocus:!0},Object(f.l)("delete")),o.a.createElement("button",{type:"reset",className:"button-link",onClick:this.closeForm},Object(f.l)("cancel"))))))},t.prototype.render=function(){var e=o.a.createElement(z.b,{className:"js-delete-analysis",destructive:!0,onClick:this.openForm},Object(f.l)("project_activity.delete_analysis"));return this.state.open?[e,this.renderModal()]:e},t}(o.a.PureComponent),F=n(1025),Z=n(28);function B(e){var t=e.className,n=e.date,r=Object(Z.e)(n);return a.createElement(F.a,{date:r,long:!1},function(e){return a.createElement(N.a,{mouseEnterDelay:.5,overlay:a.createElement(F.a,{date:r,long:!0})},a.createElement("time",{className:t,dateTime:r.toISOString()},e))})}var W=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(){return t.props.updateSelectedDate(t.props.analysis.date)},t.stopPropagation=function(e){return e.stopPropagation()},t}return W(t,e),t.prototype.render=function(){var e=this.props,t=e.analysis,n=e.isFirst,r=e.canAdmin,a=t.date,s=t.events,i=Object(f.l)("project_activity.analysis"),c=null!=s.find(function(e){return"VERSION"===e.category}),l=r&&!c&&this.props.canCreateVersion,p=r,u=this.props.canDeleteAnalyses&&!n;return o.a.createElement("li",{className:j()("project-activity-analysis clearfix",{selected:this.props.selected}),"data-date":a.valueOf(),onClick:this.handleClick,role:"listitem",tabIndex:"0"},o.a.createElement("div",{className:"project-activity-time spacer-right"},o.a.createElement(B,{className:"text-middle",date:a})),o.a.createElement("div",{className:"project-activity-analysis-icon spacer-right",title:i}),(l||p||u)&&o.a.createElement("div",{className:"project-activity-analysis-actions big-spacer-right"},o.a.createElement(z.c,{menuPosition:"left",small:!0,toggleClassName:"js-analysis-actions"},l&&o.a.createElement(R,{addEvent:this.props.addVersion,analysis:t,addEventButtonText:"project_activity.add_version"}),p&&o.a.createElement(R,{addEvent:this.props.addCustomEvent,analysis:t,addEventButtonText:"project_activity.add_custom_event"}),(l||p)&&u&&o.a.createElement(z.a,null),u&&o.a.createElement(I,{analysis:t,deleteAnalysis:this.props.deleteAnalysis}))),s.length>0&&o.a.createElement(A,{analysis:t.key,canAdmin:r,canDeleteAnalyses:this.props.canDeleteAnalyses,changeEvent:this.props.changeEvent,deleteEvent:this.props.deleteEvent,events:s,isFirst:this.props.isFirst}))},t}(o.a.PureComponent),Q=n(147),V=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),G=function(e){function t(t){var n=e.call(this,t)||this;return n.handleScroll=function(){return n.updateStickyBadges(!0)},n.resetScrollTop=function(e,t){n.scrollContainer.scrollTop=e;for(var r=1;r<n.badges.length;r++)n.badges[r].removeAttribute("originOffsetTop"),n.badges[r].classList.remove("sticky");n.updateStickyBadges(t)},n.scrollToDate=function(e){if(n.scrollContainer&&e)for(var t=e.valueOf(),r=1;r<n.analyses.length;r++)if(Number(n.analyses[r].getAttribute("data-date"))===t){var a=n.scrollContainer.offsetHeight-100,o=Math.abs(n.scrollContainer.scrollTop-n.analyses[r].offsetTop);(o>a||o<100)&&n.resetScrollTop(n.analyses[r].offsetTop-a/2);break}},n.updateStickyBadges=function(e){if(n.scrollContainer&&n.badges){var t=n.scrollContainer.scrollTop;if(null!=t){for(var r,a=1;a<n.badges.length;a++){var o=n.badges[a],s=o.getAttribute("originOffsetTop");null==s&&(s=o.offsetTop,o.setAttribute("originOffsetTop",s.toString())),Number(s)<t+18+2*a?(e&&!o.classList.contains("sticky")&&(r=s),o.classList.add("sticky")):o.classList.remove("sticky")}e&&null!=r&&(n.scrollContainer.scrollTop=r-6)}}},n.updateSelectedDate=function(e){return n.props.updateQuery({selectedDate:e})},n.handleScroll=Object(S.throttle)(n.handleScroll,20),n}return V(t,e),t.prototype.componentDidMount=function(){this.badges=document.getElementsByClassName("project-activity-version-badge"),this.analyses=document.getElementsByClassName("project-activity-analysis")},t.prototype.componentDidUpdate=function(e){this.scrollContainer&&(this.props.query.selectedDate&&(Object(v.s)(e.query,this.props.query)||e.analyses!==this.props.analyses)?this.scrollToDate(this.props.query.selectedDate):Object(v.e)(e.query,this.props.query)&&this.resetScrollTop(0,!0))},t.prototype.render=function(){var e=this,t=Object(v.i)(this.props.analyses,this.props.query),n=t.length>1||1===t.length&&Object.keys(t[0].byDay).length>0;if(0===this.props.analyses.length||!n)return o.a.createElement("div",{className:this.props.className},this.props.initializing?o.a.createElement("div",{className:"text-center"},o.a.createElement("i",{className:"spinner"})):o.a.createElement("span",{className:"note"},Object(f.l)("no_results")));var r=this.props.analyses[0].key,a=this.props.query.selectedDate?this.props.query.selectedDate.valueOf():null;return o.a.createElement("ul",{className:j()("project-activity-versions-list",this.props.className),onScroll:this.handleScroll,ref:function(t){return e.scrollContainer=t},style:{paddingTop:"TRK"===this.props.project.qualifier?52:void 0}},t.map(function(t,n){var s=Object.keys(t.byDay);return s.length<=0?null:o.a.createElement("li",{key:t.key||"noversion"},t.version&&o.a.createElement("div",{className:j()("project-activity-version-badge",{first:0===n})},o.a.createElement(N.a,{overlay:Object(f.l)("version")+" "+t.version,mouseEnterDelay:.5},o.a.createElement("span",{className:"badge"},t.version))),o.a.createElement("ul",{className:"project-activity-days-list"},s.map(function(n){return o.a.createElement("li",{key:n,className:"project-activity-day","data-day":Object(Z.h)(Number(n))},o.a.createElement("div",{className:"project-activity-date"},o.a.createElement(Q.a,{date:Number(n),long:!0})),o.a.createElement("ul",{className:"project-activity-analyses-list"},null!=t.byDay[n]&&t.byDay[n].map(function(t){return o.a.createElement(U,{addCustomEvent:e.props.addCustomEvent,addVersion:e.props.addVersion,analysis:t,canAdmin:e.props.canAdmin,canDeleteAnalyses:e.props.canDeleteAnalyses,canCreateVersion:"TRK"===e.props.project.qualifier,changeEvent:e.props.changeEvent,deleteAnalysis:e.props.deleteAnalysis,deleteEvent:e.props.deleteEvent,isFirst:t.key===r,key:t.key,selected:t.date.valueOf()===a,updateSelectedDate:e.updateSelectedDate})})))})))}),this.props.analysesLoading&&o.a.createElement("li",{className:"text-center"},o.a.createElement("i",{className:"spinner"})))},t}(o.a.PureComponent),K=n(994),X=n(1043),J=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&(n[r[a]]=e[r[a]])}return n};function Y(e){var t=e.elements,n=e.metricsTypeFilter,r=J(e,["elements","metricsTypeFilter"]),o="";return r.selectedElements.length>=6?o=a.createElement("span",{className:"alert alert-info spacer-left spacer-right spacer-top"},Object(f.l)("project_activity.graphs.custom.add_metric_info")):null!=n&&n.length>0&&(o=a.createElement("span",{className:"alert alert-info spacer-left spacer-right spacer-top"},Object(f.m)("project_activity.graphs.custom.type_x_message",n.map(function(e){return Object(f.l)("metric.type",e)}).sort().join(", ")))),a.createElement(K.a,{customClass:"bubble-popup-bottom-right  bubble-popup-menu abs-width-300",position:r.popupPosition},a.createElement(X.a,{allowNewElements:!1,allowSelection:r.selectedElements.length<6,elements:t,filterSelected:r.filterSelected,footerNode:o,onSearch:r.onSearch,onSelect:r.onSelect,onUnselect:r.onUnselect,placeholder:Object(f.l)("search.search_for_tags"),renderLabel:r.renderLabel,selectedElements:r.selectedElements}))}var $=n(152),ee=n(996),te=n(50),ne=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),re=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={open:!1,metrics:[],query:"",selectedMetrics:[]},t.filterSelected=function(e,n){return n.filter(function(n){return t.getLocalizedMetricNameFromKey(n).toLowerCase().includes(e.toLowerCase())})},t.getPopupPos=function(e){return{top:e.height,right:e.width-240}},t.filterMetricsElements=function(e,t){var n=e.metricsTypeFilter,r=e.metrics,a=e.selectedMetrics;return r.filter(function(e){return!(e.hidden||Object(te.isDiffMetric)(e.key)||["DATA","DISTRIB"].includes(e.type)||a.includes(e.key)||!Object(f.e)(e).toLowerCase().includes(t.toLowerCase()))&&(!(n&&n.length>0)||n.includes(e.type))}).map(function(e){return e.key})},t.getSelectedMetricsElements=function(e,n,r){var a=null===n?t.props.selectedMetrics:n;return e.filter(function(e){return a.includes(e.key)}).map(function(e){return e.key})},t.getLocalizedMetricNameFromKey=function(e){var n=Object(S.find)(t.props.metrics,{key:e});return void 0===n?e:Object(f.e)(n)},t.toggleForm=function(){t.setState(function(e){return{open:!e.open}})},t.onSearch=function(e){return t.setState({query:e}),Promise.resolve()},t.onSelect=function(e){t.props.addMetric(e),t.setState(function(n){return{selectedMetrics:Object(S.sortBy)(n.selectedMetrics.concat([e])),metrics:t.filterMetricsElements(t.props,n.query)}})},t.onUnselect=function(e){t.props.removeMetric(e),t.setState(function(t){return{metrics:Object(S.sortBy)(t.metrics.concat([e])),selectedMetrics:t.selectedMetrics.filter(function(t){return t!==e})}})},t.togglePopup=function(e){t.setState({open:e})},t}return ne(t,e),t.prototype.render=function(){var e=this,t=this.state.query,n=this.filterMetricsElements(this.props,t),r=this.getSelectedMetricsElements(this.props.metrics,this.props.selectedMetrics,t);return o.a.createElement("div",{className:"display-inline-block"},o.a.createElement(ee.a,{isOpen:this.state.open,offset:{horizontal:16,vertical:0},popup:o.a.createElement(Y,{elements:n,filterSelected:this.filterSelected,metricsTypeFilter:this.props.metricsTypeFilter,onSearch:this.onSearch,onSelect:this.onSelect,onUnselect:this.onUnselect,renderLabel:function(t){return e.getLocalizedMetricNameFromKey(t)},selectedElements:r}),position:"bottomright",togglePopup:this.togglePopup},o.a.createElement("button",{className:"spacer-left",onClick:this.toggleForm,type:"button"},o.a.createElement("span",null,o.a.createElement("span",{className:"text-ellipsis spacer-right"},Object(f.l)("project_activity.graphs.custom.add")),o.a.createElement($.a,{className:"vertical-text-top"})))))},t}(o.a.PureComponent),ae=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),oe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleGraphChange=function(e){e.value!==t.props.graph&&t.props.updateGraph(e.value)},t}return ae(t,e),t.prototype.render=function(){var e=v.d.map(function(e){return{label:Object(f.l)("project_activity.graphs",e),value:e}});return o.a.createElement("header",{className:"page-header"},o.a.createElement(b.c,{className:"pull-left input-medium",clearable:!1,onChange:this.handleGraphChange,options:e,searchable:!1,value:this.props.graph}),Object(v.q)(this.props.graph)&&o.a.createElement(re,{addMetric:this.props.addCustomMetric,className:"pull-left spacer-left",metrics:this.props.metrics,metricsTypeFilter:this.props.metricsTypeFilter,removeMetric:this.props.removeCustomMetric,selectedMetrics:this.props.selectedMetrics}))},t}(o.a.PureComponent),se=n(1012),ie=n.n(se),ce=n(1e3),le=n(1011),pe=n(189),ue=n(1083),de=n.n(ue),me=n(15),he=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fe=function(e){function t(t){var n=e.call(this,t)||this;return n.getRatingScale=function(e){return Object(le.d)().domain([5,4,3,2,1]).range([e,0])},n.getLevelScale=function(e){return Object(le.d)().domain(["ERROR","WARN","OK"]).range([e,0])},n.getYScale=function(e,t){return"RATING"===n.props.metricType?n.getRatingScale(e):"LEVEL"===n.props.metricType?n.getLevelScale(e):Object(le.b)().range([e,0]).domain([0,Object(ce.e)(t,function(e){return e.y})]).nice()},n.getXScale=function(e,t){return Object(le.e)().domain(Object(ce.d)(t,function(e){return e.x})).range([0,e]).clamp(!0)},n.getScales=function(){var e=n.props.width-n.props.padding[1]-n.props.padding[3],t=n.props.height-n.props.padding[0]-n.props.padding[2],r=Object(S.flatten)(n.props.series.map(function(e){return e.data}));return{xScale:n.getXScale(e,r),yScale:n.getYScale(t,r)}},n.getEventMarker=function(e){var t=e/2;return"M"+t+" 0 L"+e+" "+t+" L "+t+" "+e+" L0 "+t+" L"+t+" 0 L"+e+" "+t},n.handleDoubleClick=function(e,t){return function(){n.handleZoomUpdate(e,t)}},n.handleSelectionDrag=function(e,t,r,a){return function(o,s){if(!a||s.deltaX){var i=Math.max(r[0],Math.min(s.x,r[1]-t));n.handleZoomUpdate(e,[i,t+i])}}},n.handleSelectionHandleDrag=function(e,t,r,a,o){return function(s,i){if(!o||i.deltaX){var c=Math.max(r[0],Math.min(i.x,r[1]));n.handleZoomUpdate(e,"right"===a?[t,c]:[c,t])}}},n.handleNewZoomDragStart=function(e){return function(t,r){var a=r.node.getBoundingClientRect().left;n.setState({overlayLeftPos:a,newZoomStart:Math.round(Math.max(e[0],Math.min(r.x-a,e[1])))})}},n.handleNewZoomDrag=function(e,t){return function(r,a){var o=n.state,s=o.newZoomStart,i=o.overlayLeftPos;null!=s&&null!=i&&a.deltaX&&n.handleZoomUpdate(e,Object(S.sortBy)([s,Math.max(t[0],Math.min(a.x-i,t[1]))]))}},n.handleNewZoomDragEnd=function(e,t){return function(r,a){var o=n.state,s=o.newZoomStart,i=o.overlayLeftPos;if(null!=s&&null!=i){var c=Math.round(Math.max(t[0],Math.min(a.x-i,t[1])));n.handleZoomUpdate(e,s===c?t:Object(S.sortBy)([s,c])),n.setState({newZoomStart:null,overlayLeftPos:null})}}},n.handleZoomUpdate=function(e,t){var r=e.range(),a=t[0]>r[0]&&t[0]<r[r.length-1]?e.invert(t[0]):null,o=t[1]>r[0]&&t[1]<r[r.length-1]?e.invert(t[1]):null;n.props.startDate===a&&n.props.endDate===o||n.props.updateZoom(a,o)},n.renderBaseLine=function(e,t){return o.a.createElement("line",{className:"line-chart-grid",x1:e.range()[0],x2:e.range()[1],y1:t.range()[0],y2:t.range()[0]})},n.renderTicks=function(e,t){var n=e.tickFormat(7),r=e.ticks(7),a=t.range()[0];return o.a.createElement("g",null,r.slice(0,-1).map(function(t,s){var i=s+1<r.length?r[s+1]:e.domain()[1],c=(e(t)+e(i))/2;return o.a.createElement("text",{key:s,className:"chart-zoom-tick",x:c,y:a,dy:"1.3em"},n(t))}))},n.renderLeak=function(e,t){if(!n.props.leakPeriodDate)return null;var r=t.range();return o.a.createElement("rect",{x:e(n.props.leakPeriodDate),y:r[r.length-1],width:e.range()[1]-e(n.props.leakPeriodDate),height:r[0]-r[r.length-1],fill:me.leakColor})},n.renderLines=function(e,t){var r=Object(pe.d)().defined(function(e){return e.y||0===e.y}).x(function(t){return e(t.x)}).y(function(e){return t(e.y)});return n.props.basisCurve&&r.curve(pe.c),o.a.createElement("g",null,n.props.series.map(function(e,t){return o.a.createElement("path",{key:e.name,className:j()("line-chart-path","line-chart-path-"+t),d:r(e.data)})}))},n.renderAreas=function(e,t){var r=Object(pe.b)().defined(function(e){return e.y||0===e.y}).x(function(t){return e(t.x)}).y1(function(e){return t(e.y)}).y0(t(0));return n.props.basisCurve&&r.curve(pe.c),o.a.createElement("g",null,n.props.series.map(function(e,t){return o.a.createElement("path",{key:e.name,className:j()("line-chart-area","line-chart-area-"+t),d:r(e.data)})}))},n.renderZoomHandle=function(e){return o.a.createElement(de.a,{axis:"x",bounds:{left:e.xDim[0],right:e.xDim[1]},position:{x:e.xPos,y:0},onDrag:n.handleSelectionHandleDrag(e.xScale,e.fixedPos,e.xDim,e.direction,!0),onStop:n.handleSelectionHandleDrag(e.xScale,e.fixedPos,e.xDim,e.direction)},o.a.createElement("rect",{className:"zoom-selection-handle",x:-3,y:e.yDim[1],height:e.yDim[0]-e.yDim[1]+1,width:6}))},n.renderZoom=function(e,t){var r=e.range(),a=t.range(),s=[r[0],r[r.length-1]],i=[a[0],a[a.length-1]],c=Math.round(n.props.startDate?e(n.props.startDate):s[0]),l=Math.round(n.props.endDate?e(n.props.endDate):s[1]),p=Object(S.sortBy)([c,l]),u=p[1]-p[0],d=null==n.state.newZoomStart||n.state.newZoomStart===c||n.state.newZoomStart===l;return o.a.createElement("g",{className:"chart-zoom"},o.a.createElement(ue.DraggableCore,{onStart:n.handleNewZoomDragStart(s),onDrag:n.handleNewZoomDrag(e,s),onStop:n.handleNewZoomDragEnd(e,s)},o.a.createElement("rect",{className:"zoom-overlay",x:s[0],y:i[1],height:i[0]-i[1],width:s[1]-s[0]})),d&&o.a.createElement(de.a,{axis:"x",bounds:{left:s[0],right:Math.floor(s[1]-u)},position:{x:p[0],y:0},onDrag:n.handleSelectionDrag(e,u,s,!0),onStop:n.handleSelectionDrag(e,u,s)},o.a.createElement("rect",{className:"zoom-selection",x:0,y:i[1],height:i[0]-i[1]+1,width:u,onDoubleClick:n.handleDoubleClick(e,s)})),d&&n.renderZoomHandle({xScale:e,xPos:c,fixedPos:l,xDim:s,yDim:i,direction:"left"}),d&&n.renderZoomHandle({xScale:e,xPos:l,fixedPos:c,xDim:s,yDim:i,direction:"right"}))},n.state={overlayLeftPos:null,newZoomStart:null},n.handleZoomUpdate=Object(S.throttle)(n.handleZoomUpdate,40),n}return he(t,e),t.prototype.render=function(){if(!this.props.width||!this.props.height)return o.a.createElement("div",null);var e=this.getScales(),t=e.xScale,n=e.yScale;return o.a.createElement("svg",{className:"line-chart ",width:this.props.width,height:this.props.height},o.a.createElement("g",{transform:"translate("+this.props.padding[3]+", "+(this.props.padding[0]+2)+")"},this.renderLeak(t,n),this.renderBaseLine(t,n),this.props.showXTicks&&this.renderTicks(t,n),this.props.showAreas&&this.renderAreas(t,n),this.renderLines(t,n),this.renderZoom(t,n)))},t.defaultProps={padding:[0,0,18,0],showXTicks:!0},t}(o.a.PureComponent);function ye(e){return e.loading||!Object(v.n)(e.series)?null:o.a.createElement("div",{className:"project-activity-graph-zoom"},o.a.createElement(ie.a,{disableHeight:!0},function(t){var n=t.width;return o.a.createElement(fe,{endDate:e.graphEndDate,height:64,width:n,interpolate:"linear",leakPeriodDate:e.leakPeriodDate,metricType:e.metricsType,padding:[0,10,18,60],series:e.series,showAreas:e.showAreas,startDate:e.graphStartDate,updateZoom:e.updateGraphZoom})}))}var ge=n(248);function ve(e){var t=e.name,n=e.style,r=e.translatedName,a=e.value;return o.a.createElement("tr",{key:t,className:"project-activity-graph-tooltip-line"},o.a.createElement("td",{className:"thin"},o.a.createElement(ge.a,{className:j()("spacer-right line-chart-legend","line-chart-legend-"+n)})),o.a.createElement("td",{className:"project-activity-graph-tooltip-value text-right spacer-right thin"},a),o.a.createElement("td",null,r))}function be(e){var t=e.addSeparator,n=e.events;return o.a.createElement("tbody",null,t&&o.a.createElement("tr",null,o.a.createElement("td",{className:"project-activity-graph-tooltip-separator",colSpan:"3"},o.a.createElement("hr",null))),o.a.createElement("tr",{className:"project-activity-graph-tooltip-line"},o.a.createElement("td",{colSpan:"3"},o.a.createElement("span",null,Object(f.l)("events"),":"),n.map(function(e){return o.a.createElement("span",{key:e.key,className:"spacer-left"},o.a.createElement(p.a,{className:"project-activity-event-icon "+e.category}))}))))}function _e(e){var t=e.addSeparator,n=e.measuresHistory,r=e.tooltipIdx,a=n.find(function(e){return"uncovered_lines"===e.metric}),s=n.find(function(e){return"coverage"===e.metric});if(!(a&&a.history[r]&&s&&s.history[r]))return null;var i=a.history[r].value,c=s.history[r].value;return o.a.createElement("tbody",null,t&&o.a.createElement("tr",null,o.a.createElement("td",{className:"project-activity-graph-tooltip-separator",colSpan:"3"},o.a.createElement("hr",null))),i&&o.a.createElement("tr",{className:"project-activity-graph-tooltip-line"},o.a.createElement("td",{colSpan:"2",className:"project-activity-graph-tooltip-value text-right spacer-right thin"},Object(te.formatMeasure)(i,"SHORT_INT")),o.a.createElement("td",null,Object(f.l)("metric.uncovered_lines.name"))),c&&o.a.createElement("tr",{className:"project-activity-graph-tooltip-line"},o.a.createElement("td",{colSpan:"2",className:"project-activity-graph-tooltip-value text-right spacer-right thin"},Object(te.formatMeasure)(c,"PERCENT")),o.a.createElement("td",null,Object(f.l)("metric.coverage.name"))))}function Ee(e){var t=e.addSeparator,n=e.measuresHistory,r=e.tooltipIdx,a=n.find(function(e){return"duplicated_lines_density"===e.metric});if(!a||!a.history[r])return null;var s=a.history[r].value;return s?o.a.createElement("tbody",null,t&&o.a.createElement("tr",null,o.a.createElement("td",{className:"project-activity-graph-tooltip-separator",colSpan:"3"},o.a.createElement("hr",null))),o.a.createElement("tr",{className:"project-activity-graph-tooltip-line"},o.a.createElement("td",{colSpan:"2",className:"project-activity-graph-tooltip-value text-right spacer-right thin"},Object(te.formatMeasure)(s,"PERCENT")),o.a.createElement("td",null,Object(f.l)("metric.duplicated_lines_density.name")))):null}var Oe=n(1006),je={bugs:"reliability_rating",vulnerabilities:"security_rating",code_smells:"sqale_rating"};function Se(e){var t=e.measuresHistory.find(function(t){return t.metric===je[e.name]});if(!t||!t.history[e.tooltipIdx])return null;var n=t.history[e.tooltipIdx].value;return o.a.createElement("tr",{key:e.name,className:"project-activity-graph-tooltip-issues-line"},o.a.createElement("td",{className:"thin"},o.a.createElement(ge.a,{className:j()("spacer-right line-chart-legend","line-chart-legend-"+e.style)})),o.a.createElement("td",{className:"text-right spacer-right"},o.a.createElement("span",{className:"project-activity-graph-tooltip-value"},e.value),n&&o.a.createElement(Oe.a,{className:"spacer-left",small:!0,value:n})),o.a.createElement("td",null,e.translatedName))}var Ne=n(148),Pe=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Pe(t,e),t.prototype.renderContent=function(){var e=this,t=this.props.tooltipIdx;return this.props.series.map(function(n,r){var a=n.data[t];return!a||!a.y&&0!==a.y?null:e.props.graph===v.b?o.a.createElement(Se,{key:n.name,measuresHistory:e.props.measuresHistory,name:n.name,style:r.toString(),tooltipIdx:t,translatedName:n.translatedName,value:e.props.formatValue(a.y)}):o.a.createElement(ve,{key:n.name,name:n.name,style:r.toString(),translatedName:n.translatedName,value:e.props.formatValue(a.y)})})},t.prototype.render=function(){var e,t=this.props,n=t.events,r=t.measuresHistory,a=t.tooltipIdx,s=this.props.tooltipPos+60;s>this.props.graphWidth-250-50&&(s-=250,e="bubble-popup-right");var i=this.renderContent().filter(Boolean),c=i.length>0;return o.a.createElement(K.a,{customClass:j()(e,"disabled-pointer-events"),position:{top:30,left:s,width:250}},o.a.createElement("div",{className:"project-activity-graph-tooltip"},o.a.createElement("div",{className:"project-activity-graph-tooltip-title spacer-bottom"},o.a.createElement(Ne.a,{date:this.props.selectedDate})),o.a.createElement("table",{className:"width-100"},o.a.createElement("tbody",null,i),"coverage"===this.props.graph&&o.a.createElement(_e,{addSeparator:c,measuresHistory:r,tooltipIdx:a}),"duplications"===this.props.graph&&o.a.createElement(Ee,{addSeparator:c,measuresHistory:r,tooltipIdx:a}),n&&n.length>0&&o.a.createElement(be,{addSeparator:c,events:n}))))},t}(o.a.PureComponent),De=n(105),we=n(49),ke=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(){t.props.removeMetric&&t.props.removeMetric(t.props.metric)},t}return ke(t,e),t.prototype.render=function(){var e=null!=this.props.removeMetric,t=O({"project-activity-graph-legend-actionable":e},this.props.className);return a.createElement("span",{className:t},this.props.showWarning?a.createElement(De.a,{className:"spacer-right"}):a.createElement(ge.a,{className:O("text-middle spacer-right line-chart-legend","line-chart-legend-"+this.props.style)}),a.createElement("span",{className:"text-middle"},this.props.name),e&&a.createElement(M.b,{className:"button-tiny spacer-left text-middle",color:me.gray60,onClick:this.handleClick},a.createElement(we.a,{size:12})))},t}(a.PureComponent);function Me(e){var t=e.removeMetric,n=e.series;return o.a.createElement("div",{className:"project-activity-graph-legends"},n.map(function(e,n){var r=Object(v.m)(e),a=o.a.createElement(xe,{metric:e.name,name:e.translatedName,showWarning:!r,style:n.toString(),removeMetric:t});return r?o.a.createElement("span",{className:"spacer-left spacer-right",key:e.name},a):o.a.createElement(N.a,{key:e.name,overlay:Object(f.l)("project_activity.graphs.custom.metric_no_history")},o.a.createElement("span",{className:"spacer-left spacer-right"},a))}))}function Te(e){var t=e.series;return o.a.createElement("div",{className:"project-activity-graph-legends"},t.map(function(e,t){return o.a.createElement(xe,{className:"big-spacer-left big-spacer-right",key:e.name,metric:e.name,name:e.translatedName,style:t.toString()})}))}var Le=n(1074),Ae=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ze=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={tooltipIdx:null,tooltipXPos:null},t.formatValue=function(e){return Object(te.formatMeasure)(e,Object(te.getShortType)(t.props.metricsType))},t.formatTooltipValue=function(e){return Object(te.formatMeasure)(e,t.props.metricsType)},t.updateTooltip=function(e,n,r){t.props.updateTooltip(e),t.setState({tooltipXPos:n,tooltipIdx:r})},t}return Ae(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.graph,r=t.selectedDate,a=t.series,s=this.state,i=s.tooltipIdx,c=s.tooltipXPos;return o.a.createElement("div",{className:"project-activity-graph-container"},this.props.isCustom?o.a.createElement(Me,{series:a,removeMetric:this.props.removeCustomMetric}):o.a.createElement(Te,{series:a}),o.a.createElement("div",{className:"project-activity-graph"},o.a.createElement(ie.a,null,function(t){var s=t.height,l=t.width;return o.a.createElement("div",null,o.a.createElement(Le.a,{endDate:e.props.graphEndDate,height:s,width:l,interpolate:"linear",formatYTick:e.formatValue,leakPeriodDate:e.props.leakPeriodDate,metricType:e.props.metricsType,selectedDate:r,series:a,showAreas:e.props.showAreas,startDate:e.props.graphStartDate,updateSelectedDate:e.props.updateSelectedDate,updateTooltip:e.updateTooltip,updateZoom:e.props.updateGraphZoom}),null!=r&&null!=c&&o.a.createElement(Ce,{events:e.props.events,formatValue:e.formatTooltipValue,graph:n,graphWidth:l,measuresHistory:e.props.measuresHistory,selectedDate:r,series:a,tooltipIdx:i,tooltipPos:c}))})))},t}(o.a.PureComponent),qe=n(32),Re=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),He=function(e){function t(t){var n=e.call(this,t)||this;return n.getEvents=function(){var e=n.props,t=e.analyses,r=e.eventFilter,a=t.reduce(function(e,t){return t.events.length<=0?e:(n=r?t.events.filter(function(e){return e.category===r})[0]:Object(S.sortBy)(t.events,function(e){return v.c.indexOf(e.category)})[0])?e.concat({className:n.category,name:n.name,date:Object(Z.e)(t.date)}):e;var n},[]);return Object(S.sortBy)(a,"date")},n.getSelectedDateEvents=function(){var e=n.state.selectedDate,t=n.props.analyses;if(t&&e){var r=t.find(function(t){return t.date.valueOf()===e.valueOf()});if(r)return r.events}return[]},n.updateTooltip=function(e){return n.setState({selectedDate:e})},n.state={selectedDate:t.selectedDate},n}return Re(t,e),t.prototype.componentWillReceiveProps=function(e){Object(S.isEqual)(e.selectedDate,this.props.selectedDate)||this.setState({selectedDate:e.selectedDate})},t.prototype.render=function(){var e=this,t=this.props,n=t.graph,r=t.loading,a=t.series,s=Object(v.q)(n);if(r)return o.a.createElement("div",{className:"project-activity-graph-container"},o.a.createElement("div",{className:"text-center"},o.a.createElement(qe.a,{className:"",loading:r})));if(!Object(v.n)(a))return o.a.createElement("div",{className:"project-activity-graph-container"},o.a.createElement("div",{className:"note text-center"},Object(f.l)(s?"project_activity.graphs.custom.no_history":"component_measures.no_history")));var i=this.getSelectedDateEvents(),c=["coverage","duplications"].includes(n);return o.a.createElement("div",{className:"project-activity-graphs"},this.props.graphs.map(function(t,r){return o.a.createElement(ze,{key:r,events:i,graph:n,graphEndDate:e.props.graphEndDate,graphStartDate:e.props.graphStartDate,isCustom:s,leakPeriodDate:e.props.leakPeriodDate,measuresHistory:e.props.measuresHistory,metricsType:Object(v.l)(t),removeCustomMetric:e.props.removeCustomMetric,selectedDate:e.state.selectedDate,series:t,showAreas:c,updateGraphZoom:e.props.updateGraphZoom,updateSelectedDate:e.props.updateSelectedDate,updateTooltip:e.updateTooltip})}))},t}(o.a.PureComponent),Ie=n(130),Fe=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ze=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Be=2,We=3,Ue=function(e){function t(t){var n=e.call(this,t)||this;n.getStateZoomDates=function(e,t,r){var a={from:t.query.from||null,to:t.query.to||null};if(!e||Object(v.g)(e.query,t.query))return{graphEndDate:a.to,graphStartDate:a.from};if(null==a.to&&null==a.from&&null!=r){var o=r||n.state.series,s=Object(S.minBy)(o.map(function(e){return e.data.find(function(e){return e.y||0===e.y})}),"x"),i=Object(S.maxBy)(o.map(function(e){return Object(S.findLast)(e.data,function(e){return e.y||0===e.y})}),"x");return{graphEndDate:i?i.x:a.to,graphStartDate:s?s.x:a.from}}return null},n.getMetricsTypeFilter=function(){return n.state.graphs.length<Be?null:n.state.graphs.filter(function(e){return e.length<We}).map(function(e){return e[0].type})},n.addCustomMetric=function(e){var t=n.props.query.customMetrics.concat([e]);Object(Ie.i)(t),n.props.updateQuery({customMetrics:t})},n.removeCustomMetric=function(e){var t=n.props.query.customMetrics.filter(function(t){return t!==e});Object(Ie.i)(t),n.props.updateQuery({customMetrics:t})},n.updateGraph=function(e){Object(Ie.k)(e),Object(v.q)(e)&&n.props.query.customMetrics.length<=0?n.props.updateQuery({graph:e,customMetrics:Object(Ie.a)()}):n.props.updateQuery({graph:e,customMetrics:[]})},n.updateGraphZoom=function(e,t){if(null!=t&&null!=e&&Math.abs(t.valueOf()-e.valueOf())<432e5)return;n.setState({graphStartDate:e,graphEndDate:t}),n.updateQueryDateRange([e,t])},n.updateSelectedDate=function(e){return n.props.updateQuery({selectedDate:e})},n.updateQueryDateRange=function(e){if(null==e[0]||null==e[1])n.props.updateQuery({from:e[0],to:e[1]});else{var t=Object(S.sortBy)(e);n.props.updateQuery({from:t[0],to:t[1]})}};var r=Object(v.h)(t.measuresHistory,t.query.graph,t.metrics,Object(v.j)(t.query.graph,t.query.customMetrics));return n.state=Ze({series:r,graphs:Object(v.v)(r,Be,We)},n.getStateZoomDates(null,t,r)),n.updateQueryDateRange=Object(S.debounce)(n.updateQueryDateRange,500),n}return Fe(t,e),t.prototype.componentWillReceiveProps=function(e){var t,n;(e.measuresHistory!==this.props.measuresHistory||Object(v.p)(this.props.query,e.query))&&(t=Object(v.h)(e.measuresHistory,e.query.graph,e.metrics,Object(v.j)(e.query.graph,e.query.customMetrics)),n=Object(v.v)(t,Be,We));var r=this.getStateZoomDates(this.props,e,t);if(t||r){var a={};t&&(a.series=t,a.graphs=n),r&&(a=Ze({},a,r)),this.setState(a)}},t.prototype.render=function(){var e=this.props,t=e.leakPeriodDate,n=e.loading,r=e.metrics,a=e.query,s=this.state,i=s.graphEndDate,c=s.graphStartDate,l=s.series;return o.a.createElement("div",{className:"project-activity-layout-page-main-inner boxed-group boxed-group-inner"},o.a.createElement(oe,{addCustomMetric:this.addCustomMetric,graph:a.graph,metrics:r,metricsTypeFilter:this.getMetricsTypeFilter(),removeCustomMetric:this.removeCustomMetric,selectedMetrics:this.props.query.customMetrics,updateGraph:this.updateGraph}),o.a.createElement(He,{analyses:this.props.analyses,eventFilter:a.category,graph:a.graph,graphs:this.state.graphs,graphEndDate:i,graphStartDate:c,leakPeriodDate:t,loading:n,measuresHistory:this.props.measuresHistory,removeCustomMetric:this.removeCustomMetric,selectedDate:this.props.query.selectedDate,series:l,updateGraphZoom:this.updateGraphZoom,updateSelectedDate:this.updateSelectedDate}),o.a.createElement(ye,{graphEndDate:i,graphStartDate:c,leakPeriodDate:t,loading:n,metricsType:Object(v.l)(l),series:l,showAreas:["coverage","duplications"].includes(a.graph),updateGraphZoom:this.updateGraphZoom}))},t}(o.a.PureComponent);n(1107);function Qe(e){var t=e.analyses,n=e.measuresHistory,r=e.query,a=e.project.configuration,s=("TRK"===e.project.qualifier||"APP"===e.project.qualifier)&&!!a&&a.showHistory,i=!!a&&a.showHistory;return o.a.createElement("div",{id:"project-activity",className:"page page-limited"},o.a.createElement(l.a,{title:Object(f.l)("project_activity.page")}),o.a.createElement(E,{category:r.category,from:r.from,project:e.project,to:r.to,updateQuery:e.updateQuery}),o.a.createElement("div",{className:"layout-page project-activity-page"},o.a.createElement("div",{className:"layout-page-side-outer project-activity-page-side-outer boxed-group"},o.a.createElement(G,{addCustomEvent:e.addCustomEvent,addVersion:e.addVersion,analysesLoading:e.analysesLoading,analyses:t,canAdmin:s,canDeleteAnalyses:i,className:"boxed-group-inner",changeEvent:e.changeEvent,deleteAnalysis:e.deleteAnalysis,deleteEvent:e.deleteEvent,initializing:e.initializing,project:e.project,query:e.query,updateQuery:e.updateQuery})),o.a.createElement("div",{className:"project-activity-layout-page-main"},o.a.createElement(Ue,{analyses:t,leakPeriodDate:e.project.leakPeriodDate?Object(Z.e)(e.project.leakPeriodDate):void 0,loading:e.graphLoading,measuresHistory:n,metrics:e.metrics,query:r,updateQuery:e.updateQuery}))))}var Ve=n(1073),Ge=n(256),Ke=n(1075),Xe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Je=function(e,t){return function(n){return{analyses:n.analyses.map(function(n){return n.key!==e?n:Xe({},n,{events:n.events.concat([t])})})}}},Ye=function(e,t){return function(n){return{analyses:n.analyses.map(function(n){return n.key!==e?n:Xe({},n,{events:n.events.filter(function(e){return e.key!==t})})})}}},$e=function(e,t){return function(n){return{analyses:n.analyses.map(function(n){return n.key!==e?n:Xe({},n,{events:n.events.map(function(e){return e.key===t.key?Xe({},e,t):e})})})}}},et=function(e){return function(t){return{analyses:t.analyses.filter(function(t){return t.key!==e})}}},tt=n(59),nt=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),rt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},at=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&(n[r[a]]=e[r[a]])}return n},ot=function(e){function t(t){var n=e.call(this,t)||this;return n.addCustomEvent=function(e,t,r){return Ke.b(e,t,r).then(function(e){var t=e.analysis,r=at(e,["analysis"]);return n.mounted&&n.setState(Je(t,r))})},n.addVersion=function(e,t){return n.addCustomEvent(e,t,"VERSION")},n.changeEvent=function(e,t){return Ke.a(e,t).then(function(e){var t=e.analysis,r=at(e,["analysis"]);return n.mounted&&n.setState($e(t,r))})},n.deleteAnalysis=function(e){return Ke.c(e).then(function(){n.mounted&&(n.updateGraphData(n.state.query.graph,n.state.query.customMetrics),n.setState(et(e)))})},n.deleteEvent=function(e,t){return Ke.d(t).then(function(){return n.mounted&&n.setState(Ye(e,t))})},n.fetchActivity=function(e,t,r,a){var o=rt({project:e,p:t,ps:r},Object(tt.c)(n.props.branchLike));return Ke.e(rt({},a,o)).then(function(e){var t=e.analyses,n=e.paging;return{analyses:t.map(function(e){return rt({},e,{date:Object(Z.e)(e.date)})}),paging:n}})},n.fetchMeasuresHistory=function(e){return e.length<=0?Promise.resolve([]):Object(Ve.a)(rt({component:n.props.component.key,metrics:e.join()},Object(tt.c)(n.props.branchLike))).then(function(e){return e.measures.map(function(e){return{metric:e.metric,history:e.history.map(function(e){return{date:Object(Z.e)(e.date),value:e.value}})}})},function(){})},n.loadAllActivities=function(e,t){if(t&&t.paging.pageIndex*t.paging.pageSize>=t.paging.total)return Promise.resolve(t);var r=t?t.paging.pageIndex+1:1;return n.fetchActivity(e,r,500).then(function(r){return t?n.loadAllActivities(e,{analyses:t.analyses.concat(r.analyses),paging:r.paging}):n.loadAllActivities(e,r)})},n.getTopLevelComponent=function(e){for(var t=e.breadcrumbs.length-1;t>0&&!["TRK","VW","APP"].includes(e.breadcrumbs[t].qualifier);)t--;return e.breadcrumbs[t].key},n.updateGraphData=function(e,t){var r=Object(v.k)(e,t);n.setState({graphLoading:!0}),n.fetchMeasuresHistory(r).then(function(e){n.mounted&&n.setState({graphLoading:!1,measuresHistory:e})},function(){n.mounted&&n.setState({graphLoading:!1,measuresHistory:[]})})},n.updateQuery=function(e){var t=Object(v.u)(rt({},n.state.query,e));n.context.router.push({pathname:n.props.location.pathname,query:rt({},t,Object(tt.c)(n.props.branchLike),{id:n.props.component.key})})},n.shouldRedirect=function(){var e=n.props.location.query;if(!e)return!1;var t=Object.keys(e).some(function(t){return"id"!==t&&""!==e[t]}),r=Object(Ie.b)(),a=Object(v.q)(r)&&Object(Ie.a)().length<=0;return!t&&null!=r&&r!==v.b&&!a},n.state={analyses:[],analysesLoading:!1,graphLoading:!0,initialized:!1,measuresHistory:[],metrics:[],query:Object(v.r)(t.location.query)},n}return nt(t,e),t.prototype.componentDidMount=function(){if(this.mounted=!0,this.shouldRedirect()){var e=rt({},this.state.query,{graph:Object(Ie.b)()});Object(v.q)(e.graph)&&(e.customMetrics=Object(Ie.a)()),this.context.router.replace({pathname:this.props.location.pathname,query:rt({},Object(v.u)(e),Object(tt.c)(this.props.branchLike))})}else this.firstLoadData(this.state.query,this.props.component)},t.prototype.componentWillReceiveProps=function(e){if(e.location.query!==this.props.location.query){var t=Object(v.r)(e.location.query);(t.graph!==this.state.query.graph||Object(v.f)(this.state.query,t))&&(this.state.initialized?this.updateGraphData(t.graph,t.customMetrics):this.firstLoadData(t,e.component)),this.setState({query:t})}},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.firstLoadData=function(e,t){var n=this,r=Object(v.k)(e.graph,e.customMetrics),a=this.getTopLevelComponent(t);Promise.all([this.fetchActivity(a,1,100,Object(v.t)(e)),Object(Ge.c)(),this.fetchMeasuresHistory(r)]).then(function(e){n.mounted&&(n.setState({analyses:e[0].analyses,analysesLoading:!0,graphLoading:!1,initialized:!0,measuresHistory:e[2],metrics:e[1],paging:e[0].paging}),n.loadAllActivities(a).then(function(e){var t=e.analyses,r=e.paging;n.mounted&&n.setState({analyses:t,analysesLoading:!1,paging:r})}))},function(){n.mounted&&n.setState({initialized:!0,analysesLoading:!1,graphLoading:!1})})},t.prototype.render=function(){return this.shouldRedirect()?null:o.a.createElement(Qe,{addCustomEvent:this.addCustomEvent,addVersion:this.addVersion,analyses:this.state.analyses,analysesLoading:this.state.analysesLoading,changeEvent:this.changeEvent,deleteAnalysis:this.deleteAnalysis,deleteEvent:this.deleteEvent,graphLoading:!this.state.initialized||this.state.graphLoading,initializing:!this.state.initialized,metrics:this.state.metrics,measuresHistory:this.state.measuresHistory,project:this.props.component,query:this.state.query,updateQuery:this.updateQuery})},t.contextTypes={router:i.a.object.isRequired},t}(o.a.PureComponent);t.default=ot},992:function(e,t,n){e.exports=n(1017)()},996:function(e,t,n){"use strict";var r,a=n(0),o=n(6),s=(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={position:{top:0,right:0}},t.handleKey=function(e){27===e.keyCode&&t.props.togglePopup(!1)},t.handleOutsideClick=function(e){t.popupContainer&&t.popupContainer.contains(e.target)||t.props.togglePopup(!1)},t}return s(t,e),t.prototype.componentDidMount=function(){this.setState({position:this.getPosition(this.props)})},t.prototype.componentWillReceiveProps=function(e){!this.props.isOpen&&e.isOpen?(window.addEventListener("keydown",this.handleKey,!1),window.addEventListener("click",this.handleOutsideClick,!1)):this.props.isOpen&&!e.isOpen&&(window.removeEventListener("keydown",this.handleKey),window.removeEventListener("click",this.handleOutsideClick))},t.prototype.handleClick=function(e){e.stopPropagation()},t.prototype.getPosition=function(e){if(this.container){var t=this.container.getBoundingClientRect(),n=e.position,r=e.offset||{vertical:0,horizontal:0};return"bottomleft"===n?{top:t.height+r.vertical,left:r.horizontal}:{top:t.height+r.vertical,right:r.horizontal}}return{top:0,right:0}},t.prototype.render=function(){var e=this;return a.createElement("div",{className:o(this.props.className,"bubble-popup-helper"),onClick:this.handleClick,ref:function(t){return e.container=t},role:"tooltip",tabIndex:0},this.props.children,this.props.isOpen&&a.createElement("div",{ref:function(t){return e.popupContainer=t}},a.cloneElement(this.props.popup,{popupPosition:this.state.position})))},t}(a.PureComponent);t.a=i}}]);
//# sourceMappingURL=273.ffb107a8.chunk.js.map
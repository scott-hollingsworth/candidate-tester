{"version":3,"sources":["webpack:///./src/main/js/apps/background-tasks/constants.js","webpack:///./src/main/js/api/ce.ts","webpack:///./src/main/js/components/intl/TimeFormatter.tsx","webpack:///./src/main/js/components/controls/DateRangeInput.tsx","webpack:///./src/main/js/components/shared/Organization.tsx","webpack:///./src/main/js/apps/background-tasks/components/WorkersForm.tsx","webpack:///./src/main/js/apps/background-tasks/components/NoWorkersSupportPopup.tsx","webpack:///./src/main/js/apps/background-tasks/components/Workers.tsx","webpack:///./src/main/js/apps/background-tasks/components/Header.tsx","webpack:///./src/main/js/apps/background-tasks/components/Footer.js","webpack:///./src/main/js/apps/background-tasks/components/Stats.js","webpack:///./src/main/js/apps/background-tasks/components/StatsContainer.tsx","webpack:///./src/main/js/apps/background-tasks/components/StatusFilter.js","webpack:///./src/main/js/apps/background-tasks/components/TypesFilter.js","webpack:///./src/main/js/apps/background-tasks/components/CurrentsFilter.tsx","webpack:///./src/main/js/apps/background-tasks/components/DateFilter.tsx","webpack:///./src/main/js/apps/background-tasks/components/Search.js","webpack:///./src/main/js/apps/background-tasks/components/TaskStatus.tsx","webpack:///./src/main/js/apps/background-tasks/components/TaskType.tsx","webpack:///./src/main/js/apps/background-tasks/components/TaskComponent.tsx","webpack:///./src/main/js/apps/background-tasks/components/TaskId.tsx","webpack:///./src/main/js/apps/background-tasks/components/TaskDay.tsx","webpack:///./src/main/js/apps/background-tasks/components/TaskDate.tsx","webpack:///./src/main/js/apps/background-tasks/utils.js","webpack:///./src/main/js/apps/background-tasks/components/TaskExecutionTime.tsx","webpack:///./src/main/js/apps/background-tasks/components/ScannerContext.tsx","webpack:///./src/main/js/apps/background-tasks/components/Stacktrace.tsx","webpack:///./src/main/js/apps/background-tasks/components/TaskActions.tsx","webpack:///./src/main/js/apps/background-tasks/components/Task.tsx","webpack:///./src/main/js/apps/background-tasks/components/Tasks.js","webpack:///./src/main/js/apps/background-tasks/components/BackgroundTasksApp.js","webpack:///./src/main/js/components/common/BubblePopup.tsx","webpack:///./src/main/js/components/common/BubblePopupHelper.tsx"],"names":["__webpack_require__","d","__webpack_exports__","DEBOUNCE_DELAY","STATUSES","ALL","ALL_EXCEPT_PENDING","PENDING","IN_PROGRESS","SUCCESS","FAILED","CANCELED","ALL_TYPES","CURRENTS","ONLY_CURRENTS","DEFAULT_FILTERS","status","taskType","currents","minSubmittedAt","undefined","maxExecutedAt","query","_app_utils_throwGlobalError__WEBPACK_IMPORTED_MODULE_1__","getActivity","data","Object","_helpers_request__WEBPACK_IMPORTED_MODULE_0__","getStatus","componentId","assign","getTask","id","additionalFields","then","r","task","cancelTask","cancelAllTasks","getTasksForComponent","componentKey","catch","getTypes","taskTypes","getWorkers","setWorkerCount","count","formatterOption","hour","minute","longFormatterOption","second","TimeFormatter","_a","children","date","long","react__WEBPACK_IMPORTED_MODULE_0__","react_intl__WEBPACK_IMPORTED_MODULE_1__","__assign","value","_helpers_dates__WEBPACK_IMPORTED_MODULE_2__","DateRangeInput","_super","_this","apply","this","arguments","handleFromChange","from","props","onChange","to","setTimeout","toDateInput","focus","handleToChange","setState","__extends","defineProperty","prototype","render","className","classnames__WEBPACK_IMPORTED_MODULE_1__","_DateInput__WEBPACK_IMPORTED_MODULE_2__","currentMonth","data-test","highlightTo","maxDate","placeholder","_helpers_l10n__WEBPACK_IMPORTED_MODULE_3__","highlightFrom","minDate","ref","element","_ui_OrganizationLink__WEBPACK_IMPORTED_MODULE_3__","Organization","link","organization","shouldBeDisplayed","linkClassName","name","react_redux__WEBPACK_IMPORTED_MODULE_1__","state","ownProps","_store_rootReducer__WEBPACK_IMPORTED_MODULE_2__","organizationKey","WorkersForm","call","mounted","handleClose","onClose","handleWorkerCountChange","option","newWorkerCount","handleSubmit","event","preventDefault","submitting","ce","workerCount","WorkersForm_extends","componentDidMount","componentWillUnmount","options","lodash_js_exposed","map","_","i","label","String","index_js_exposed","Modal","contentLabel","l10n","onRequestClose","onSubmit","Select","clearable","searchable","buttons","disabled","onClick","NoWorkersSupportPopup_NoWorkersSupportPopup","BubblePopup","position","popupPosition","customClass","href","target","Workers","canSetWorkerCount","formOpen","loading","noSupportPopup","loadWorkers","closeForm","handleChangeClick","handleHelpClick","stopPropagation","toggleNoSupportPopup","show","Workers_extends","Tooltip","overlay","AlertWarnIcon","fill","HelpIcon","theme","BubblePopupHelper","isOpen","popup","togglePopup","components_WorkersForm","Header_Header","component","components_Workers","components_Footer","tasks","length","index_js_exposed_default","a","createElement","Stats","handleShowFailing","currentTarget","blur","onShowFailing","Stats_extends","renderPending","pendingCount","isSystemAdmin","onCancelAllPending","renderFailures","failingCount","PureComponent","StatsContainer","es","rootReducer","canAdmin","components_Stats","components_StatusFilter","_onChange","constants","components_TypesFilter","types","t","allOptions","concat","CurrentsFilter","handleChange","newValue","CurrentsFilter_extends","checked","Checkbox","onCheck","DateFilter","handleDateRangeChange","DateFilter_extends","dateRange","Search","handleDateChange","onFilterUpdate","handleQueryChange","Search_extends","handleStatusChange","handleTypeChange","handleCurrentsChange","handleReload","e","onReload","handleReset","renderSearchBox","SearchBox","bind","components_CurrentsFilter","components_DateFilter","propTypes","prop_types_default","bool","isRequired","any","string","func","TaskStatus_TaskStatus","inner","PendingIcon","TaskType_TaskType","type","TaskComponent_TaskComponent","branchType","ShortLivingBranchIcon","LongLivingBranchIcon","pullRequest","PullRequestIcon","componentQualifier","QualifierIcon","qualifier","componentName","react_router_es","branch","urls","TaskComponent_getTaskComponentUrl","title","style","marginLeft","marginRight","pullRequestTitle","TaskId_TaskId","TaskDay_TaskDay","submittedAt","prevSubmittedAt","shouldDisplay","dates","DateFormatter","TaskDate_TaskDate","baseDate","parsedDate","parsedBaseDate","diff","utils_ONE_SECOND","utils_ONE_MINUTE","utils_format","int","suffix","TaskExecutionTime_TaskExecutionTime","ms","Math","round","ScannerContext","handleCloseClick","ScannerContext_extends","loadScannerContext","scannerContext","large","Stacktrace","Stacktrace_extends","loadStacktrace","stacktrace","errorStacktrace","errorMessage","TaskActions","scannerContextOpen","stacktraceOpen","handleFilterClick","onFilterTask","handleCancelClick","onCancelTask","handleShowScannerContextClick","closeScannerContext","handleShowStacktraceClick","closeStacktrace","TaskActions_extends","canFilter","canCancel","canShowStacktrace","hasScannerContext","ActionsDropdown","destructive","components_ScannerContext","components_Stacktrace","Task_Task","previousTask","startedAt","executedAt","executionTimeMs","components_TaskActions","Tasks","Tasks_extends","classnames_default","new-loading","index","key","BackgroundTasksApp_BackgroundTasksApp","BackgroundTasksApp","BackgroundTasksApp_extends","componentWillMount","loadTasksDebounced","loadTasks","componentDidUpdate","prevProps","location","parameters","filters","join","onlyCurrents","componentQuery","lastPage","p","utils_mapFiltersToParameters","Promise","all","responses","activity","status_1","pending","failing","organizations","filter","o","fetchOrganizations","handleFilterUpdate","nextState","nextQuery","BackgroundTasksApp_assign","keys","forEach","context","router","push","pathname","handleCancelTask","nextTask","newTask","utils_updateTask","handleFilterTask","handleCancelAllPending","helpers_query","Helmet_default","components_Search","components_Tasks","contextTypes","object","BackgroundTasksApp_mapDispatchToProps","rootActions","popupClass","popupStyle","top","right","handleKey","keyCode","handleOutsideClick","popupContainer","contains","getPosition","componentWillReceiveProps","nextProps","window","addEventListener","removeEventListener","handleClick","container","containerPos","getBoundingClientRect","offset","vertical","horizontal","height","left","role","tabIndex"],"mappings":"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","file":"js/262.45c17ba0.chunk.js","sourcesContent":["/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n/* @flow */\nexport const STATUSES = {\n  ALL: '__ALL__',\n  ALL_EXCEPT_PENDING: '__ALL_EXCEPT_PENDING__',\n  PENDING: 'PENDING',\n  IN_PROGRESS: 'IN_PROGRESS',\n  SUCCESS: 'SUCCESS',\n  FAILED: 'FAILED',\n  CANCELED: 'CANCELED'\n};\n\nexport const ALL_TYPES = 'ALL_TYPES';\n\nexport const CURRENTS = {\n  ALL: '__ALL__',\n  ONLY_CURRENTS: 'CURRENTS'\n};\n\nexport const DATE = {\n  ANY: 'ANY',\n  TODAY: 'TODAY',\n  CUSTOM: 'CUSTOM'\n};\n\nexport const DEFAULT_FILTERS = {\n  status: STATUSES.ALL_EXCEPT_PENDING,\n  taskType: ALL_TYPES,\n  currents: CURRENTS.ALL,\n  minSubmittedAt: undefined,\n  maxExecutedAt: undefined,\n  query: ''\n};\n\nexport const DATE_FORMAT = 'YYYY-MM-DD';\n\nexport const DEBOUNCE_DELAY = 250;\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { getJSON, post, RequestData } from '../helpers/request';\nimport throwGlobalError from '../app/utils/throwGlobalError';\n\nexport interface PendingTask {\n  componentKey: string;\n  componentName: string;\n  componentQualifier: string;\n  id: string;\n  logs: boolean;\n  organization: string;\n  status: string;\n  submittedAt: Date;\n  submitterLogin?: string;\n  type: string;\n}\n\nexport interface Task extends PendingTask {\n  analysisId?: string;\n  errorMessage?: string;\n  errorType?: string;\n  executionTimeMs: number;\n  executedAt: Date;\n  hasErrorStacktrace: boolean;\n  hasScannerContext: boolean;\n  startedAt: Date;\n}\n\nexport function getActivity(data: RequestData): Promise<any> {\n  return getJSON('/api/ce/activity', data);\n}\n\nexport function getStatus(componentId?: string): Promise<any> {\n  const data = {};\n  if (componentId) {\n    Object.assign(data, { componentId });\n  }\n  return getJSON('/api/ce/activity_status', data);\n}\n\nexport function getTask(id: string, additionalFields?: string[]): Promise<any> {\n  return getJSON('/api/ce/task', { id, additionalFields }).then(r => r.task);\n}\n\nexport function cancelTask(id: string): Promise<any> {\n  return post('/api/ce/cancel', { id }).then(() => getTask(id), () => getTask(id));\n}\n\nexport function cancelAllTasks(): Promise<any> {\n  return post('/api/ce/cancel_all');\n}\n\nexport function getTasksForComponent(\n  componentKey: string\n): Promise<{ queue: PendingTask[]; current: Task }> {\n  return getJSON('/api/ce/component', { componentKey }).catch(throwGlobalError);\n}\n\nexport function getTypes(): Promise<any> {\n  return getJSON('/api/ce/task_types').then(r => r.taskTypes);\n}\n\nexport function getWorkers(): Promise<{ canSetWorkerCount: boolean; value: number }> {\n  return getJSON('/api/ce/worker_count').catch(throwGlobalError);\n}\n\nexport function setWorkerCount(count: number): Promise<void | Response> {\n  return post('/api/ce/set_worker_count', { count }).catch(throwGlobalError);\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { DateSource, FormattedTime } from 'react-intl';\nimport { parseDate } from '../../helpers/dates';\n\ninterface Props {\n  children?: (formattedDate: string) => React.ReactNode;\n  date: DateSource;\n  long?: boolean;\n}\n\nexport const formatterOption = { hour: 'numeric', minute: 'numeric' };\n\nexport const longFormatterOption = { hour: 'numeric', minute: 'numeric', second: 'numeric' };\n\nexport default function TimeFormatter({ children, date, long }: Props) {\n  return (\n    <FormattedTime value={parseDate(date)} {...(long ? longFormatterOption : formatterOption)}>\n      {children}\n    </FormattedTime>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\nimport DateInput from './DateInput';\nimport { translate } from '../../helpers/l10n';\n\ntype DateRange = { from?: Date; to?: Date };\n\ninterface Props {\n  className?: string;\n  maxDate?: Date;\n  minDate?: Date;\n  onChange: (date: DateRange) => void;\n  value?: DateRange;\n}\n\nexport default class DateRangeInput extends React.PureComponent<Props> {\n  toDateInput?: DateInput | null;\n\n  get from() {\n    return this.props.value && this.props.value.from;\n  }\n\n  get to() {\n    return this.props.value && this.props.value.to;\n  }\n\n  handleFromChange = (from: Date | undefined) => {\n    this.props.onChange({ from, to: this.to });\n\n    // use `setTimeout` to work around the immediate closing of the `toDateInput`\n    setTimeout(() => {\n      if (from && !this.to && this.toDateInput) {\n        this.toDateInput.focus();\n      }\n    }, 0);\n  };\n\n  handleToChange = (to: Date | undefined) => {\n    this.setState({ to });\n    this.props.onChange({ from: this.from, to });\n  };\n\n  render() {\n    return (\n      <div className={classNames('display-inline-flex-center', this.props.className)}>\n        <DateInput\n          currentMonth={this.to}\n          data-test=\"from\"\n          highlightTo={this.to}\n          maxDate={this.to}\n          onChange={this.handleFromChange}\n          placeholder={translate('start_date')}\n          value={this.from}\n        />\n        <span className=\"note little-spacer-left little-spacer-right\">{translate('to_')}</span>\n        <DateInput\n          currentMonth={this.from}\n          data-test=\"to\"\n          highlightFrom={this.from}\n          minDate={this.from}\n          onChange={this.handleToChange}\n          placeholder={translate('end_date')}\n          ref={element => (this.toDateInput = element)}\n          value={this.to}\n        />\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { connect } from 'react-redux';\nimport { getOrganizationByKey, areThereCustomOrganizations } from '../../store/rootReducer';\nimport OrganizationLink from '../ui/OrganizationLink';\n\ninterface OwnProps {\n  organizationKey: string;\n}\n\ninterface Props {\n  link?: boolean;\n  linkClassName?: string;\n  organization: { key: string; name: string } | null;\n  shouldBeDisplayed: boolean;\n}\n\nfunction Organization(props: Props) {\n  const { link = true, organization, shouldBeDisplayed } = props;\n\n  if (!shouldBeDisplayed || !organization) {\n    return null;\n  }\n\n  return (\n    <span>\n      {link ? (\n        <OrganizationLink className={props.linkClassName} organization={organization}>\n          {organization.name}\n        </OrganizationLink>\n      ) : (\n        organization.name\n      )}\n      <span className=\"slash-separator\" />\n    </span>\n  );\n}\n\nconst mapStateToProps = (state: any, ownProps: OwnProps) => ({\n  organization: getOrganizationByKey(state, ownProps.organizationKey),\n  shouldBeDisplayed: areThereCustomOrganizations(state)\n});\n\nexport default connect<any, any, any>(mapStateToProps)(Organization);\n\nexport const UnconnectedOrganization = Organization;\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { times } from 'lodash';\nimport { setWorkerCount } from '../../../api/ce';\nimport Modal from '../../../components/controls/Modal';\nimport Select from '../../../components/controls/Select';\nimport { SubmitButton, ResetButtonLink } from '../../../components/ui/buttons';\nimport { translate } from '../../../helpers/l10n';\n\nconst MAX_WORKERS = 10;\n\ninterface Props {\n  onClose: (newWorkerCount?: number) => void;\n  workerCount: number;\n}\n\ninterface State {\n  newWorkerCount: number;\n  submitting: boolean;\n}\n\nexport default class WorkersForm extends React.PureComponent<Props, State> {\n  mounted = false;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      newWorkerCount: props.workerCount,\n      submitting: false\n    };\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  handleClose = () => {\n    this.props.onClose();\n  };\n\n  handleWorkerCountChange = (option: { value: number }) =>\n    this.setState({ newWorkerCount: option.value });\n\n  handleSubmit = (event: React.SyntheticEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    this.setState({ submitting: true });\n    const { newWorkerCount } = this.state;\n    setWorkerCount(newWorkerCount).then(\n      () => {\n        if (this.mounted) {\n          this.props.onClose(newWorkerCount);\n        }\n      },\n      () => {\n        if (this.mounted) {\n          this.setState({ submitting: false });\n        }\n      }\n    );\n  };\n\n  render() {\n    const options = times(MAX_WORKERS).map((_, i) => ({ label: String(i + 1), value: i + 1 }));\n\n    return (\n      <Modal\n        contentLabel={translate('background_tasks.change_number_of_workers')}\n        onRequestClose={this.handleClose}>\n        <header className=\"modal-head\">\n          <h2>{translate('background_tasks.change_number_of_workers')}</h2>\n        </header>\n        <form onSubmit={this.handleSubmit}>\n          <div className=\"modal-body\">\n            <Select\n              className=\"input-tiny spacer-top\"\n              clearable={false}\n              onChange={this.handleWorkerCountChange}\n              options={options}\n              searchable={false}\n              value={this.state.newWorkerCount}\n            />\n            <div className=\"big-spacer-top alert alert-success markdown\">\n              {translate('background_tasks.change_number_of_workers.hint')}\n            </div>\n          </div>\n          <footer className=\"modal-foot\">\n            <div>\n              {this.state.submitting && <i className=\"spinner spacer-right\" />}\n              <SubmitButton disabled={this.state.submitting}>{translate('save')}</SubmitButton>\n              <ResetButtonLink onClick={this.handleClose}>{translate('cancel')}</ResetButtonLink>\n            </div>\n          </footer>\n        </form>\n      </Modal>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport BubblePopup from '../../../components/common/BubblePopup';\nimport { translate } from '../../../helpers/l10n';\n\ninterface Props {\n  popupPosition?: any;\n}\n\nexport default function NoWorkersSupportPopup(props: Props) {\n  return (\n    <BubblePopup position={props.popupPosition} customClass=\"bubble-popup-bottom-right\">\n      <div className=\"abs-width-400\">\n        <h6 className=\"spacer-bottom\">{translate('background_tasks.add_more_workers')}</h6>\n        <p className=\"big-spacer-bottom markdown\">\n          {translate('background_tasks.add_more_workers.text')}\n        </p>\n        <p>\n          <a href=\"https://redirect.sonarsource.com/editions/enterprise.html\" target=\"_blank\">\n            {translate('learn_more')}\n          </a>\n        </p>\n      </div>\n    </BubblePopup>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport WorkersForm from './WorkersForm';\nimport NoWorkersSupportPopup from './NoWorkersSupportPopup';\nimport AlertWarnIcon from '../../../components/icons-components/AlertWarnIcon';\nimport BubblePopupHelper from '../../../components/common/BubblePopupHelper';\nimport HelpIcon from '../../../components/icons-components/HelpIcon';\nimport Tooltip from '../../../components/controls/Tooltip';\nimport * as theme from '../../../app/theme';\nimport { getWorkers } from '../../../api/ce';\nimport { translate } from '../../../helpers/l10n';\nimport { EditButton } from '../../../components/ui/buttons';\n\ninterface State {\n  canSetWorkerCount: boolean;\n  formOpen: boolean;\n  loading: boolean;\n  noSupportPopup: boolean;\n  workerCount: number;\n}\n\nexport default class Workers extends React.PureComponent<{}, State> {\n  mounted = false;\n  state: State = {\n    canSetWorkerCount: false,\n    formOpen: false,\n    loading: true,\n    noSupportPopup: false,\n    workerCount: 1\n  };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.loadWorkers();\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  loadWorkers = () => {\n    this.setState({ loading: true });\n    getWorkers().then(\n      ({ canSetWorkerCount, value }) => {\n        if (this.mounted) {\n          this.setState({\n            canSetWorkerCount,\n            loading: false,\n            workerCount: value\n          });\n        }\n      },\n      () => {\n        if (this.mounted) {\n          this.setState({ loading: false });\n        }\n      }\n    );\n  };\n\n  closeForm = (newWorkerCount?: number) =>\n    newWorkerCount\n      ? this.setState({ formOpen: false, workerCount: newWorkerCount })\n      : this.setState({ formOpen: false });\n\n  handleChangeClick = () => {\n    this.setState({ formOpen: true });\n  };\n\n  handleHelpClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.stopPropagation();\n    this.toggleNoSupportPopup();\n  };\n\n  toggleNoSupportPopup = (show?: boolean) => {\n    if (show !== undefined) {\n      this.setState({ noSupportPopup: show });\n    } else {\n      this.setState(state => ({ noSupportPopup: !state.noSupportPopup }));\n    }\n  };\n\n  render() {\n    const { canSetWorkerCount, formOpen, loading, workerCount } = this.state;\n\n    return (\n      <div>\n        {!loading &&\n          workerCount > 1 && (\n            <Tooltip overlay={translate('background_tasks.number_of_workers.warning')}>\n              <span>\n                <AlertWarnIcon\n                  className=\"little-spacer-right bt-workers-warning-icon\"\n                  fill=\"#d3d3d3\"\n                />\n              </span>\n            </Tooltip>\n          )}\n\n        <span className=\"text-middle\">\n          {translate('background_tasks.number_of_workers')}\n\n          {loading ? (\n            <i className=\"spinner little-spacer-left\" />\n          ) : (\n            <strong className=\"little-spacer-left\">{workerCount}</strong>\n          )}\n        </span>\n\n        {!loading &&\n          canSetWorkerCount && (\n            <Tooltip overlay={translate('background_tasks.change_number_of_workers')}>\n              <EditButton\n                className=\"js-edit button-small spacer-left\"\n                onClick={this.handleChangeClick}\n              />\n            </Tooltip>\n          )}\n\n        {!loading &&\n          !canSetWorkerCount && (\n            <span className=\"spacer-left\">\n              <a className=\"link-no-underline\" href=\"#\" onClick={this.handleHelpClick}>\n                <HelpIcon className=\"text-text-bottom\" fill={theme.gray80} />\n              </a>\n              <BubblePopupHelper\n                isOpen={this.state.noSupportPopup}\n                popup={<NoWorkersSupportPopup />}\n                position=\"bottomright\"\n                togglePopup={this.toggleNoSupportPopup}\n              />\n            </span>\n          )}\n\n        {formOpen && <WorkersForm onClose={this.closeForm} workerCount={this.state.workerCount} />}\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Workers from './Workers';\nimport { translate } from '../../../helpers/l10n';\n\ninterface Props {\n  component?: any;\n}\n\nexport default function Header(props: Props) {\n  return (\n    <header className=\"page-header\">\n      <h1 className=\"page-title\">{translate('background_tasks.page')}</h1>\n      {!props.component && (\n        <div className=\"page-actions\">\n          <Workers />\n        </div>\n      )}\n      <p className=\"page-description\">{translate('background_tasks.page.description')}</p>\n    </header>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n/* @flow */\nimport React from 'react';\n/*:: import type { Task } from '../types'; */\nimport { translateWithParameters } from '../../../helpers/l10n';\n\nconst LIMIT = 1000;\n\nconst Footer = ({ tasks } /*: { tasks: Task[] } */) => {\n  if (tasks.length < LIMIT) {\n    return null;\n  }\n\n  return (\n    <footer className=\"spacer-top note text-center\">\n      {translateWithParameters('max_results_reached', LIMIT)}\n    </footer>\n  );\n};\n\nexport default Footer;\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n/* @flow */\nimport React from 'react';\nimport Tooltip from '../../../components/controls/Tooltip';\nimport { DeleteButton } from '../../../components/ui/buttons';\nimport { translate } from '../../../helpers/l10n';\n\n/*::\ntype Props = {\n  failingCount: number,\n  isSystemAdmin?: boolean,\n  pendingCount: number,\n  onShowFailing: () => void,\n  onCancelAllPending: () => void\n};\n*/\n\n/*::\ntype State = Object;\n*/\n\nexport default class Stats extends React.PureComponent {\n  /*:: props: Props; */\n  /*:: state: State; */\n\n  handleShowFailing = (event /*: Object */) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    this.props.onShowFailing();\n  };\n\n  renderPending() {\n    if (this.props.pendingCount == null) {\n      return null;\n    }\n    if (this.props.pendingCount > 0) {\n      return (\n        <span>\n          <span className=\"js-pending-count emphasised-measure\">{this.props.pendingCount}</span>\n          &nbsp;\n          {translate('background_tasks.pending')}\n          {this.props.isSystemAdmin && (\n            <Tooltip overlay={translate('background_tasks.cancel_all_tasks')}>\n              <DeleteButton\n                className=\"js-cancel-pending spacer-left\"\n                onClick={this.props.onCancelAllPending}\n              />\n            </Tooltip>\n          )}\n        </span>\n      );\n    } else {\n      return (\n        <span>\n          <span className=\"js-pending-count emphasised-measure\">{this.props.pendingCount}</span>\n          &nbsp;\n          {translate('background_tasks.pending')}\n        </span>\n      );\n    }\n  }\n\n  renderFailures() {\n    if (this.props.failingCount == null) {\n      return null;\n    }\n\n    if (this.props.component) {\n      return null;\n    }\n\n    if (this.props.failingCount > 0) {\n      return (\n        <span>\n          <Tooltip overlay={translate('background_tasks.failing_count')}>\n            <a\n              className=\"js-failures-count emphasised-measure\"\n              href=\"#\"\n              onClick={this.handleShowFailing}>\n              {this.props.failingCount}\n            </a>\n          </Tooltip>\n          &nbsp;\n          {translate('background_tasks.failures')}\n        </span>\n      );\n    } else {\n      return (\n        <span>\n          <Tooltip overlay={translate('background_tasks.failing_count')}>\n            <span className=\"js-failures-count emphasised-measure\">{this.props.failingCount}</span>\n          </Tooltip>\n          &nbsp;\n          {translate('background_tasks.failures')}\n        </span>\n      );\n    }\n  }\n\n  render() {\n    return (\n      <section className=\"big-spacer-top big-spacer-bottom\">\n        <span>{this.renderPending()}</span>\n        <span className=\"huge-spacer-left\">{this.renderFailures()}</span>\n      </section>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { connect } from 'react-redux';\nimport Stats from './Stats';\nimport { getAppState } from '../../../store/rootReducer';\n\nconst mapStateToProps = (state: any) => ({\n  isSystemAdmin: !!getAppState(state).canAdmin\n});\n\nexport default connect(mapStateToProps)(Stats as any);\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n/* @flow */\nimport React from 'react';\nimport { STATUSES } from '../constants';\nimport Select from '../../../components/controls/Select';\nimport { translate } from '../../../helpers/l10n';\n\nconst StatusFilter = ({ value, onChange } /*: { value: ?string, onChange: Function } */) => {\n  const options = [\n    { value: STATUSES.ALL, label: translate('background_task.status.ALL') },\n    {\n      value: STATUSES.ALL_EXCEPT_PENDING,\n      label: translate('background_task.status.ALL_EXCEPT_PENDING')\n    },\n    { value: STATUSES.PENDING, label: translate('background_task.status.PENDING') },\n    { value: STATUSES.IN_PROGRESS, label: translate('background_task.status.IN_PROGRESS') },\n    { value: STATUSES.SUCCESS, label: translate('background_task.status.SUCCESS') },\n    { value: STATUSES.FAILED, label: translate('background_task.status.FAILED') },\n    { value: STATUSES.CANCELED, label: translate('background_task.status.CANCELED') }\n  ];\n\n  return (\n    <Select\n      value={value}\n      onChange={option => onChange(option.value)}\n      className=\"input-medium\"\n      options={options}\n      clearable={false}\n      searchable={false}\n    />\n  );\n};\n\nexport default StatusFilter;\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n/* @flow */\nimport React from 'react';\nimport { ALL_TYPES } from '../constants';\nimport Select from '../../../components/controls/Select';\nimport { translate } from '../../../helpers/l10n';\n\nconst TypesFilter = (\n  { value, onChange, types } /*: {\n  value: string,\n  onChange: Function,\n  types: string[]\n} */\n) => {\n  const options = types.map(t => {\n    return {\n      value: t,\n      label: translate('background_task.type', t)\n    };\n  });\n\n  const allOptions = [\n    { value: ALL_TYPES, label: translate('background_task.type.ALL') },\n    ...options\n  ];\n\n  return (\n    <Select\n      value={value}\n      onChange={option => onChange(option.value)}\n      className=\"input-medium\"\n      options={allOptions}\n      clearable={false}\n      searchable={false}\n    />\n  );\n};\n\nexport default TypesFilter;\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Checkbox from '../../../components/controls/Checkbox';\nimport { CURRENTS } from '../constants';\nimport { translate } from '../../../helpers/l10n';\n\ninterface Props {\n  value?: string;\n  onChange: (value: string) => void;\n}\n\nexport default class CurrentsFilter extends React.PureComponent<Props> {\n  handleChange = (value: boolean) => {\n    const newValue = value ? CURRENTS.ONLY_CURRENTS : CURRENTS.ALL;\n    this.props.onChange(newValue);\n  };\n\n  render() {\n    const checked = this.props.value === CURRENTS.ONLY_CURRENTS;\n    return (\n      <div className=\"bt-search-form-field\">\n        <Checkbox checked={checked} onCheck={this.handleChange}>\n          <span className=\"little-spacer-left\">{translate('yes')}</span>\n        </Checkbox>\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport DageRangeInput from '../../../components/controls/DateRangeInput';\n\ninterface Props {\n  maxExecutedAt: Date | undefined;\n  minSubmittedAt: Date | undefined;\n  onChange: (x: { maxExecutedAt?: Date; minSubmittedAt?: Date }) => void;\n}\n\nexport default class DateFilter extends React.PureComponent<Props> {\n  handleDateRangeChange = ({ from, to }: { from?: Date; to?: Date }) => {\n    this.props.onChange({ minSubmittedAt: from, maxExecutedAt: to });\n  };\n\n  render() {\n    const dateRange = { from: this.props.minSubmittedAt, to: this.props.maxExecutedAt };\n    return (\n      <div className=\"nowrap\">\n        <DageRangeInput onChange={this.handleDateRangeChange} value={dateRange} />\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n/* @flow */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport StatusFilter from './StatusFilter';\nimport TypesFilter from './TypesFilter';\nimport CurrentsFilter from './CurrentsFilter';\nimport DateFilter from './DateFilter';\nimport { DEFAULT_FILTERS } from './../constants';\nimport SearchBox from '../../../components/controls/SearchBox';\nimport { translate } from '../../../helpers/l10n';\n\nexport default class Search extends React.PureComponent {\n  static propTypes = {\n    loading: PropTypes.bool.isRequired,\n    status: PropTypes.any.isRequired,\n    taskType: PropTypes.any.isRequired,\n    currents: PropTypes.any.isRequired,\n    query: PropTypes.string.isRequired,\n    onFilterUpdate: PropTypes.func.isRequired,\n    onReload: PropTypes.func.isRequired\n  };\n\n  handleStatusChange(status /*: string */) {\n    this.props.onFilterUpdate({ status });\n  }\n\n  handleTypeChange(taskType /*: string */) {\n    this.props.onFilterUpdate({ taskType });\n  }\n\n  handleCurrentsChange(currents /*: string */) {\n    this.props.onFilterUpdate({ currents });\n  }\n\n  handleDateChange = (date /*: { maxExecutedAt?: Date; minSubmittedAt?: Date } */) => {\n    this.props.onFilterUpdate(date);\n  };\n\n  handleQueryChange = (query /*: string */) => {\n    this.props.onFilterUpdate({ query });\n  };\n\n  handleReload(e /*: Object */) {\n    e.target.blur();\n    this.props.onReload();\n  }\n\n  handleReset(e /*: Object */) {\n    e.preventDefault();\n    e.target.blur();\n    this.props.onFilterUpdate(DEFAULT_FILTERS);\n  }\n\n  renderSearchBox() {\n    const { component, query } = this.props;\n\n    if (component) {\n      // do not render search form on the project-level page\n      return null;\n    }\n\n    return (\n      <li className=\"bt-search-form-large\">\n        <SearchBox\n          onChange={this.handleQueryChange}\n          placeholder={translate('background_tasks.search_by_task_or_component')}\n          value={query}\n        />\n      </li>\n    );\n  }\n\n  render() {\n    const {\n      loading,\n      component,\n      types,\n      status,\n      taskType,\n      currents,\n      minSubmittedAt,\n      maxExecutedAt\n    } = this.props;\n\n    return (\n      <section className=\"big-spacer-top big-spacer-bottom\">\n        <ul className=\"bt-search-form\">\n          <li>\n            <h6 className=\"bt-search-form-label\">{translate('status')}</h6>\n            <StatusFilter value={status} onChange={this.handleStatusChange.bind(this)} />\n          </li>\n          {types.length > 1 && (\n            <li>\n              <h6 className=\"bt-search-form-label\">{translate('type')}</h6>\n              <TypesFilter\n                value={taskType}\n                types={types}\n                onChange={this.handleTypeChange.bind(this)}\n              />\n            </li>\n          )}\n          {!component && (\n            <li>\n              <h6 className=\"bt-search-form-label\">\n                {translate('background_tasks.currents_filter.ONLY_CURRENTS')}\n              </h6>\n              <CurrentsFilter value={currents} onChange={this.handleCurrentsChange.bind(this)} />\n            </li>\n          )}\n          <li>\n            <h6 className=\"bt-search-form-label\">{translate('date')}</h6>\n            <DateFilter\n              maxExecutedAt={maxExecutedAt}\n              minSubmittedAt={minSubmittedAt}\n              onChange={this.handleDateChange}\n            />\n          </li>\n\n          {this.renderSearchBox()}\n\n          <li className=\"nowrap\">\n            <button className=\"js-reload\" onClick={this.handleReload.bind(this)} disabled={loading}>\n              {translate('reload')}\n            </button>{' '}\n            <button ref=\"resetButton\" onClick={this.handleReset.bind(this)} disabled={loading}>\n              {translate('reset_verb')}\n            </button>\n          </li>\n        </ul>\n      </section>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { STATUSES } from './../constants';\nimport PendingIcon from '../../../components/icons-components/PendingIcon';\nimport { translate } from '../../../helpers/l10n';\n\ninterface Props {\n  status: string;\n}\n\nexport default function TaskStatus({ status }: Props) {\n  let inner;\n\n  switch (status) {\n    case STATUSES.PENDING:\n      inner = <PendingIcon />;\n      break;\n    case STATUSES.IN_PROGRESS:\n      inner = <i className=\"spinner\" />;\n      break;\n    case STATUSES.SUCCESS:\n      inner = (\n        <span className=\"badge badge-success\">{translate('background_task.status.SUCCESS')}</span>\n      );\n      break;\n    case STATUSES.FAILED:\n      inner = (\n        <span className=\"badge badge-danger\">{translate('background_task.status.FAILED')}</span>\n      );\n      break;\n    case STATUSES.CANCELED:\n      inner = (\n        <span className=\"badge badge-muted\">{translate('background_task.status.CANCELED')}</span>\n      );\n      break;\n    default:\n      inner = '';\n  }\n\n  return <td className=\"thin spacer-right\">{inner}</td>;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { translate } from '../../../helpers/l10n';\n\ninterface Props {\n  type: string;\n}\n\nexport default function TaskType({ type }: Props) {\n  return (\n    <span className=\"display-inline-block note\">\n      {'['}\n      {translate('background_task.type', type)}\n      {']'}\n    </span>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport TaskType from './TaskType';\nimport { Task } from '../types';\nimport QualifierIcon from '../../../components/shared/QualifierIcon';\nimport Organization from '../../../components/shared/Organization';\nimport {\n  getProjectUrl,\n  getShortLivingBranchUrl,\n  getLongLivingBranchUrl,\n  getPullRequestUrl\n} from '../../../helpers/urls';\nimport ShortLivingBranchIcon from '../../../components/icons-components/ShortLivingBranchIcon';\nimport LongLivingBranchIcon from '../../../components/icons-components/LongLivingBranchIcon';\nimport PullRequestIcon from '../../../components/icons-components/PullRequestIcon';\nimport Tooltip from '../../../components/controls/Tooltip';\n\ninterface Props {\n  task: Task;\n}\n\nexport default function TaskComponent({ task }: Props) {\n  if (!task.componentKey) {\n    return (\n      <td>\n        <span className=\"note\">{task.id}</span>\n        <TaskType type={task.type} />\n      </td>\n    );\n  }\n\n  return (\n    <td>\n      {task.branchType === 'SHORT' && <ShortLivingBranchIcon className=\"little-spacer-right\" />}\n      {task.branchType === 'LONG' && <LongLivingBranchIcon className=\"little-spacer-right\" />}\n      {task.pullRequest !== undefined && <PullRequestIcon className=\"little-spacer-right\" />}\n\n      {!task.branchType &&\n        !task.pullRequest &&\n        task.componentQualifier && (\n          <span className=\"little-spacer-right\">\n            <QualifierIcon qualifier={task.componentQualifier} />\n          </span>\n        )}\n\n      {task.organization && <Organization organizationKey={task.organization} />}\n\n      {task.componentName && (\n        <Link className=\"spacer-right\" to={getTaskComponentUrl(task.componentKey, task)}>\n          {task.componentName}\n\n          {task.branch && (\n            <span className=\"text-limited text-text-top\" title={task.branch}>\n              <span style={{ marginLeft: 5, marginRight: 5 }}>/</span>\n              {task.branch}\n            </span>\n          )}\n\n          {task.pullRequest && (\n            <Tooltip overlay={task.pullRequestTitle}>\n              <span className=\"text-limited text-text-top\">\n                <span style={{ marginLeft: 5, marginRight: 5 }}>/</span>\n                {task.pullRequest}\n              </span>\n            </Tooltip>\n          )}\n        </Link>\n      )}\n\n      <TaskType type={task.type} />\n    </td>\n  );\n}\n\nfunction getTaskComponentUrl(componentKey: string, task: Task) {\n  if (task.branch && task.branchType === 'SHORT') {\n    return getShortLivingBranchUrl(componentKey, task.branchType);\n  } else if (task.branchType && task.branchType === 'LONG') {\n    return getLongLivingBranchUrl(componentKey, task.branchType);\n  } else if (task.pullRequest) {\n    return getPullRequestUrl(componentKey, task.pullRequest);\n  } else {\n    return getProjectUrl(componentKey);\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\n\ninterface Props {\n  id: string;\n}\n\nexport default function TaskId({ id }: Props) {\n  return (\n    <td className=\"thin nowrap\">\n      <div className=\"note\">{id}</div>\n    </td>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport DateFormatter from '../../../components/intl/DateFormatter';\nimport { isSameDay, parseDate } from '../../../helpers/dates';\n\ninterface Props {\n  submittedAt: string;\n  prevSubmittedAt?: string;\n}\n\nexport default function TaskDay({ submittedAt, prevSubmittedAt }: Props) {\n  const shouldDisplay =\n    !prevSubmittedAt || !isSameDay(parseDate(submittedAt), parseDate(prevSubmittedAt));\n\n  return (\n    <td className=\"thin nowrap text-right\">\n      {shouldDisplay ? <DateFormatter date={submittedAt} long={true} /> : ''}\n    </td>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport TimeFormatter from '../../../components/intl/TimeFormatter';\nimport { differenceInDays, isValidDate, parseDate } from '../../../helpers/dates';\n\ninterface Props {\n  date?: string;\n  baseDate?: string;\n}\n\nexport default function TaskDate({ date, baseDate }: Props) {\n  const parsedDate = date && parseDate(date);\n  const parsedBaseDate = baseDate && parseDate(baseDate);\n  const diff =\n    parsedDate && parsedBaseDate && isValidDate(parsedDate) && isValidDate(parsedBaseDate)\n      ? differenceInDays(parsedDate, parsedBaseDate)\n      : 0;\n\n  return (\n    <td className=\"thin nowrap text-right\">\n      {diff > 0 && <span className=\"text-warning little-spacer-right\">{`(+${diff}d)`}</span>}\n\n      {parsedDate && isValidDate(parsedDate) ? <TimeFormatter date={parsedDate} long={true} /> : ''}\n    </td>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n/* @flow */\nimport { STATUSES, ALL_TYPES, CURRENTS } from './constants';\nimport { toShortNotSoISOString } from '../../helpers/dates';\n/*:: import type { Task } from './types'; */\n\nexport function updateTask(tasks /*: Task[] */, newTask /*: Task */) {\n  return tasks.map(task => (task.id === newTask.id ? newTask : task));\n}\n\nexport function mapFiltersToParameters(filters /*: Object */ = {}) {\n  const parameters = {};\n\n  if (filters.status === STATUSES.ALL) {\n    parameters.status = [\n      STATUSES.PENDING,\n      STATUSES.IN_PROGRESS,\n      STATUSES.SUCCESS,\n      STATUSES.FAILED,\n      STATUSES.CANCELED\n    ].join();\n  } else if (filters.status === STATUSES.ALL_EXCEPT_PENDING) {\n    parameters.status = [\n      STATUSES.IN_PROGRESS,\n      STATUSES.SUCCESS,\n      STATUSES.FAILED,\n      STATUSES.CANCELED\n    ].join();\n  } else {\n    parameters.status = filters.status;\n  }\n\n  if (filters.taskType !== ALL_TYPES) {\n    parameters.type = filters.taskType;\n  }\n\n  if (filters.currents !== CURRENTS.ALL) {\n    parameters.onlyCurrents = true;\n  }\n\n  if (filters.minSubmittedAt) {\n    parameters.minSubmittedAt = toShortNotSoISOString(filters.minSubmittedAt);\n  }\n\n  if (filters.maxExecutedAt) {\n    parameters.maxExecutedAt = toShortNotSoISOString(filters.maxExecutedAt);\n  }\n\n  if (filters.query) {\n    parameters.componentQuery = filters.query;\n  }\n\n  if (filters.lastPage !== 1) {\n    parameters.p = filters.lastPage;\n  }\n\n  return parameters;\n}\n\nconst ONE_SECOND = 1000;\nconst ONE_MINUTE = 60 * ONE_SECOND;\n\nfunction format(int, suffix) {\n  return `${int}${suffix}`;\n}\n\nexport function formatDuration(value /*: ?number */) {\n  if (!value) {\n    return '';\n  }\n  if (value >= ONE_MINUTE) {\n    const minutes = Math.round(value / ONE_MINUTE);\n    return format(minutes, 'min');\n  } else if (value >= ONE_SECOND) {\n    const seconds = Math.round(value / ONE_SECOND);\n    return format(seconds, 's');\n  } else {\n    return format(value, 'ms');\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { formatDuration } from '../utils';\n\ninterface Props {\n  ms?: number;\n}\n\nexport default function TaskExecutionTime({ ms }: Props) {\n  return <td className=\"thin nowrap text-right\">{ms && formatDuration(ms)}</td>;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { getTask } from '../../../api/ce';\nimport { translate } from '../../../helpers/l10n';\nimport { Task } from '../types';\nimport Modal from '../../../components/controls/Modal';\n\ninterface Props {\n  onClose: () => void;\n  task: Task;\n}\n\ninterface State {\n  scannerContext?: string;\n}\n\nexport default class ScannerContext extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = {};\n\n  componentDidMount() {\n    this.mounted = true;\n    this.loadScannerContext();\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  loadScannerContext() {\n    getTask(this.props.task.id, ['scannerContext']).then(task => {\n      if (this.mounted) {\n        this.setState({ scannerContext: task.scannerContext });\n      }\n    });\n  }\n\n  handleCloseClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    this.props.onClose();\n  };\n\n  render() {\n    const { task } = this.props;\n    const { scannerContext } = this.state;\n\n    return (\n      <Modal contentLabel=\"scanner context\" large={true} onRequestClose={this.props.onClose}>\n        <div className=\"modal-head\">\n          <h2>\n            {translate('background_tasks.scanner_context')}\n            {': '}\n            {task.componentName}\n            {' ['}\n            {translate('background_task.type', task.type)}\n            {']'}\n          </h2>\n        </div>\n\n        <div className=\"modal-body modal-container\">\n          {scannerContext != null ? (\n            <pre className=\"js-task-scanner-context\">{scannerContext}</pre>\n          ) : (\n            <i className=\"spinner\" />\n          )}\n        </div>\n\n        <div className=\"modal-foot\">\n          <a href=\"#\" className=\"js-modal-close\" onClick={this.handleCloseClick}>\n            {translate('close')}\n          </a>\n        </div>\n      </Modal>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { getTask } from '../../../api/ce';\nimport { translate } from '../../../helpers/l10n';\nimport Modal from '../../../components/controls/Modal';\nimport { Task } from '../types';\n\ninterface Props {\n  onClose: () => void;\n  task: Task;\n}\n\ninterface State {\n  loading: boolean;\n  stacktrace?: string;\n}\n\nexport default class Stacktrace extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { loading: true };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.loadStacktrace();\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  loadStacktrace() {\n    getTask(this.props.task.id, ['stacktrace']).then(\n      task => {\n        if (this.mounted) {\n          this.setState({ loading: false, stacktrace: task.errorStacktrace });\n        }\n      },\n      () => {\n        if (this.mounted) {\n          this.setState({ loading: false });\n        }\n      }\n    );\n  }\n\n  handleCloseClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    this.props.onClose();\n  };\n\n  render() {\n    const { task } = this.props;\n    const { loading, stacktrace } = this.state;\n\n    return (\n      <Modal contentLabel=\"stacktrace\" large={true} onRequestClose={this.props.onClose}>\n        <div className=\"modal-head\">\n          <h2>\n            {translate('background_tasks.error_stacktrace')}\n            {': '}\n            {task.componentName}\n            {' ['}\n            {translate('background_task.type', task.type)}\n            {']'}\n          </h2>\n        </div>\n\n        <div className=\"modal-body modal-container\">\n          {loading ? (\n            <i className=\"spinner\" />\n          ) : stacktrace ? (\n            <div>\n              <h4 className=\"spacer-bottom\">{translate('background_tasks.error_stacktrace')}</h4>\n              <pre className=\"js-task-stacktrace\">{stacktrace}</pre>\n            </div>\n          ) : (\n            <div>\n              <h4 className=\"spacer-bottom\">{translate('background_tasks.error_message')}</h4>\n              <pre className=\"js-task-error-message\">{task.errorMessage}</pre>\n            </div>\n          )}\n        </div>\n\n        <div className=\"modal-foot\">\n          <a href=\"#\" className=\"js-modal-close\" onClick={this.handleCloseClick}>\n            {translate('close')}\n          </a>\n        </div>\n      </Modal>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport ScannerContext from './ScannerContext';\nimport Stacktrace from './Stacktrace';\nimport { STATUSES } from './../constants';\nimport { translate, translateWithParameters } from '../../../helpers/l10n';\nimport { Task } from '../types';\nimport ActionsDropdown, { ActionsDropdownItem } from '../../../components/controls/ActionsDropdown';\n\ninterface Props {\n  component?: {};\n  onCancelTask: (task: Task) => void;\n  onFilterTask: (task: Task) => void;\n  task: Task;\n}\n\ninterface State {\n  scannerContextOpen: boolean;\n  stacktraceOpen: boolean;\n}\n\nexport default class TaskActions extends React.PureComponent<Props, State> {\n  state: State = {\n    scannerContextOpen: false,\n    stacktraceOpen: false\n  };\n\n  handleFilterClick = () => {\n    this.props.onFilterTask(this.props.task);\n  };\n\n  handleCancelClick = () => {\n    this.props.onCancelTask(this.props.task);\n  };\n\n  handleShowScannerContextClick = () => {\n    this.setState({ scannerContextOpen: true });\n  };\n\n  closeScannerContext = () => this.setState({ scannerContextOpen: false });\n\n  handleShowStacktraceClick = () => {\n    this.setState({ stacktraceOpen: true });\n  };\n\n  closeStacktrace = () => this.setState({ stacktraceOpen: false });\n\n  render() {\n    const { component, task } = this.props;\n\n    const canFilter = component === undefined;\n    const canCancel = task.status === STATUSES.PENDING;\n    const canShowStacktrace = task.errorMessage !== undefined;\n    const hasActions = canFilter || canCancel || task.hasScannerContext || canShowStacktrace;\n\n    if (!hasActions) {\n      return <td>&nbsp;</td>;\n    }\n\n    return (\n      <td className=\"thin nowrap\">\n        <ActionsDropdown className=\"js-task-action\">\n          {canFilter &&\n            task.componentName && (\n              <ActionsDropdownItem className=\"js-task-filter\" onClick={this.handleFilterClick}>\n                {translateWithParameters(\n                  'background_tasks.filter_by_component_x',\n                  task.componentName\n                )}\n              </ActionsDropdownItem>\n            )}\n          {canCancel && (\n            <ActionsDropdownItem\n              className=\"js-task-cancel\"\n              destructive={true}\n              onClick={this.handleCancelClick}>\n              {translate('background_tasks.cancel_task')}\n            </ActionsDropdownItem>\n          )}\n          {task.hasScannerContext && (\n            <ActionsDropdownItem\n              className=\"js-task-show-scanner-context\"\n              onClick={this.handleShowScannerContextClick}>\n              {translate('background_tasks.show_scanner_context')}\n            </ActionsDropdownItem>\n          )}\n          {canShowStacktrace && (\n            <ActionsDropdownItem\n              className=\"js-task-show-stacktrace\"\n              onClick={this.handleShowStacktraceClick}>\n              {translate('background_tasks.show_stacktrace')}\n            </ActionsDropdownItem>\n          )}\n        </ActionsDropdown>\n\n        {this.state.scannerContextOpen && (\n          <ScannerContext onClose={this.closeScannerContext} task={task} />\n        )}\n\n        {this.state.stacktraceOpen && <Stacktrace onClose={this.closeStacktrace} task={task} />}\n      </td>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport TaskStatus from './TaskStatus';\nimport TaskComponent from './TaskComponent';\nimport TaskId from './TaskId';\nimport TaskDay from './TaskDay';\nimport TaskDate from './TaskDate';\nimport TaskExecutionTime from './TaskExecutionTime';\nimport TaskActions from './TaskActions';\nimport { Task as ITask } from '../types';\n\ninterface Props {\n  component?: {};\n  onCancelTask: (task: ITask) => void;\n  onFilterTask: (task: ITask) => void;\n  task: ITask;\n  previousTask?: ITask;\n}\n\nexport default function Task(props: Props) {\n  const { task, component, onCancelTask, onFilterTask, previousTask } = props;\n\n  return (\n    <tr>\n      <TaskStatus status={task.status} />\n      <TaskComponent task={task} />\n      <TaskId id={task.id} />\n      <TaskDay\n        submittedAt={task.submittedAt}\n        prevSubmittedAt={previousTask && previousTask.submittedAt}\n      />\n      <TaskDate date={task.submittedAt} />\n      <TaskDate date={task.startedAt} baseDate={task.submittedAt} />\n      <TaskDate date={task.executedAt} baseDate={task.submittedAt} />\n      <TaskExecutionTime ms={task.executionTimeMs} />\n      <TaskActions\n        component={component}\n        task={task}\n        onFilterTask={onFilterTask}\n        onCancelTask={onCancelTask}\n      />\n    </tr>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n/* @flow */\nimport React from 'react';\nimport classNames from 'classnames';\nimport Task from './Task';\nimport { translate } from '../../../helpers/l10n';\n\n/*::\ntype Props = {\n  tasks: Array<*>,\n  component: Object,\n  loading: boolean,\n  onCancelTask: Function,\n  onFilterTask: Function\n};\n*/\n\n/*::\ntype State = Object;\n*/\n\nexport default class Tasks extends React.PureComponent {\n  /*:: props: Props; */\n  /*:: state: State; */\n\n  render() {\n    const { tasks, component, loading, onCancelTask, onFilterTask } = this.props;\n\n    const className = classNames('data zebra zebra-hover background-tasks', {\n      'new-loading': loading\n    });\n\n    return (\n      <div className=\"boxed-group boxed-group-inner\">\n        <table className={className}>\n          <thead>\n            <tr>\n              <th>{translate('background_tasks.table.status')}</th>\n              <th>{translate('background_tasks.table.task')}</th>\n              <th>{translate('background_tasks.table.id')}</th>\n              <th>&nbsp;</th>\n              <th className=\"text-right\">{translate('background_tasks.table.submitted')}</th>\n              <th className=\"text-right\">{translate('background_tasks.table.started')}</th>\n              <th className=\"text-right\">{translate('background_tasks.table.finished')}</th>\n              <th className=\"text-right\">{translate('background_tasks.table.duration')}</th>\n              <th>&nbsp;</th>\n            </tr>\n          </thead>\n          <tbody>\n            {tasks.map((task, index, tasks) => (\n              <Task\n                key={task.id}\n                task={task}\n                tasks={tasks}\n                component={component}\n                onCancelTask={onCancelTask}\n                onFilterTask={onFilterTask}\n                previousTask={index > 0 ? tasks[index - 1] : undefined}\n              />\n            ))}\n          </tbody>\n        </table>\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Helmet from 'react-helmet';\nimport { debounce, uniq } from 'lodash';\nimport { connect } from 'react-redux';\nimport { DEFAULT_FILTERS, DEBOUNCE_DELAY, STATUSES, CURRENTS } from './../constants';\nimport Header from './Header';\nimport Footer from './Footer';\nimport StatsContainer from '../components/StatsContainer';\nimport Search from '../components/Search';\nimport Tasks from '../components/Tasks';\nimport {\n  getTypes,\n  getActivity,\n  getStatus,\n  cancelAllTasks,\n  cancelTask as cancelTaskAPI\n} from '../../../api/ce';\nimport { updateTask, mapFiltersToParameters } from '../utils';\n/*:: import type { Task } from '../types'; */\nimport '../background-tasks.css';\nimport { fetchOrganizations } from '../../../store/rootActions';\nimport { translate } from '../../../helpers/l10n';\nimport { parseAsDate } from '../../../helpers/query';\nimport { toShortNotSoISOString } from '../../../helpers/dates';\n\n/*::\ntype Props = {\n  component: Object,\n  location: Object,\n  fetchOrganizations: (Array<string>) => string\n};\n*/\n\n/*::\ntype State = {\n  loading: boolean,\n  tasks: Array<*>,\n  types?: Array<*>,\n  query: string,\n  pendingCount: number,\n  failingCount: number\n};\n*/\n\nclass BackgroundTasksApp extends React.PureComponent {\n  /*:: loadTasksDebounced: Function; */\n  /*:: mounted: boolean; */\n  /*:: props: Props; */\n\n  static contextTypes = {\n    router: PropTypes.object.isRequired\n  };\n\n  state /*: State */ = {\n    loading: true,\n    tasks: [],\n\n    // filters\n    query: '',\n\n    // stats\n    pendingCount: 0,\n    failingCount: 0\n  };\n\n  componentWillMount() {\n    this.loadTasksDebounced = debounce(this.loadTasks.bind(this), DEBOUNCE_DELAY);\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n\n    getTypes().then(types => {\n      this.setState({ types });\n      this.loadTasks();\n    });\n  }\n\n  componentDidUpdate(prevProps /*: Props */) {\n    if (\n      prevProps.component !== this.props.component ||\n      prevProps.location !== this.props.location\n    ) {\n      this.loadTasksDebounced();\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  loadTasks() {\n    this.setState({ loading: true });\n\n    const status = this.props.location.query.status || DEFAULT_FILTERS.status;\n    const taskType = this.props.location.query.taskType || DEFAULT_FILTERS.taskType;\n    const currents = this.props.location.query.currents || DEFAULT_FILTERS.currents;\n    const minSubmittedAt =\n      this.props.location.query.minSubmittedAt || DEFAULT_FILTERS.minSubmittedAt;\n    const maxExecutedAt = this.props.location.query.maxExecutedAt || DEFAULT_FILTERS.maxExecutedAt;\n    const query = this.props.location.query.query || DEFAULT_FILTERS.query;\n\n    const filters = { status, taskType, currents, minSubmittedAt, maxExecutedAt, query };\n    const parameters /*: Object */ = mapFiltersToParameters(filters);\n\n    if (this.props.component) {\n      parameters.componentId = this.props.component.id;\n    }\n\n    Promise.all([getActivity(parameters), getStatus(parameters.componentId)]).then(responses => {\n      if (this.mounted) {\n        const [activity, status] = responses;\n        const tasks = activity.tasks;\n\n        const pendingCount = status.pending;\n        const failingCount = status.failing;\n\n        const organizations = uniq(tasks.map(task => task.organization).filter(o => o));\n        this.props.fetchOrganizations(organizations);\n\n        this.setState({\n          tasks,\n          pendingCount,\n          failingCount,\n          loading: false\n        });\n      }\n    });\n  }\n\n  handleFilterUpdate(nextState /*: Object */) {\n    const nextQuery = { ...this.props.location.query, ...nextState };\n\n    // remove defaults\n    Object.keys(DEFAULT_FILTERS).forEach(key => {\n      if (nextQuery[key] === DEFAULT_FILTERS[key]) {\n        delete nextQuery[key];\n      }\n    });\n\n    if (nextQuery.minSubmittedAt) {\n      nextQuery.minSubmittedAt = toShortNotSoISOString(nextQuery.minSubmittedAt);\n    }\n\n    if (nextQuery.maxExecutedAt) {\n      nextQuery.maxExecutedAt = toShortNotSoISOString(nextQuery.maxExecutedAt);\n    }\n\n    this.context.router.push({\n      pathname: this.props.location.pathname,\n      query: nextQuery\n    });\n  }\n\n  handleCancelTask(task /*: Task */) {\n    this.setState({ loading: true });\n\n    cancelTaskAPI(task.id).then(nextTask => {\n      if (this.mounted) {\n        const tasks = updateTask(this.state.tasks, nextTask);\n        this.setState({ tasks, loading: false });\n      }\n    });\n  }\n\n  handleFilterTask(task /*: Task */) {\n    this.handleFilterUpdate({ query: task.componentKey });\n  }\n\n  handleShowFailing() {\n    this.handleFilterUpdate({\n      ...DEFAULT_FILTERS,\n      status: STATUSES.FAILED,\n      currents: CURRENTS.ONLY_CURRENTS\n    });\n  }\n\n  handleCancelAllPending() {\n    this.setState({ loading: true });\n\n    cancelAllTasks().then(() => {\n      if (this.mounted) {\n        this.loadTasks();\n      }\n    });\n  }\n\n  render() {\n    const { component } = this.props;\n    const { loading, types, tasks, pendingCount, failingCount } = this.state;\n\n    if (!types) {\n      return (\n        <div className=\"page page-limited\">\n          <i className=\"spinner\" />\n        </div>\n      );\n    }\n\n    const status = this.props.location.query.status || DEFAULT_FILTERS.status;\n    const taskType = this.props.location.query.taskType || DEFAULT_FILTERS.taskType;\n    const currents = this.props.location.query.currents || DEFAULT_FILTERS.currents;\n    const minSubmittedAt = parseAsDate(this.props.location.query.minSubmittedAt);\n    const maxExecutedAt = parseAsDate(this.props.location.query.maxExecutedAt);\n    const query = this.props.location.query.query || '';\n\n    return (\n      <div className=\"page page-limited\">\n        <Helmet title={translate('background_tasks.page')} />\n        <Header component={component} />\n\n        <StatsContainer\n          component={component}\n          pendingCount={pendingCount}\n          failingCount={failingCount}\n          onShowFailing={this.handleShowFailing.bind(this)}\n          onCancelAllPending={this.handleCancelAllPending.bind(this)}\n        />\n\n        <Search\n          loading={loading}\n          component={component}\n          status={status}\n          currents={currents}\n          minSubmittedAt={minSubmittedAt}\n          maxExecutedAt={maxExecutedAt}\n          query={query}\n          taskType={taskType}\n          types={types}\n          onFilterUpdate={this.handleFilterUpdate.bind(this)}\n          onReload={this.loadTasksDebounced}\n        />\n\n        <Tasks\n          loading={loading}\n          component={component}\n          tasks={tasks}\n          onCancelTask={this.handleCancelTask.bind(this)}\n          onFilterTask={this.handleFilterTask.bind(this)}\n        />\n\n        <Footer tasks={tasks} />\n      </div>\n    );\n  }\n}\n\nconst mapDispatchToProps = { fetchOrganizations };\n\nexport default connect(null, mapDispatchToProps)(BackgroundTasksApp);\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\n\nexport interface BubblePopupPosition {\n  top?: number;\n  left?: number;\n  right?: number;\n}\n\ninterface Props {\n  customClass?: string;\n  children: React.ReactNode;\n  position: BubblePopupPosition;\n}\n\nexport default function BubblePopup(props: Props) {\n  const popupClass = classNames('bubble-popup', props.customClass);\n  const popupStyle = { ...props.position };\n\n  return (\n    <div className={popupClass} style={popupStyle}>\n      {props.children}\n      <div className=\"bubble-popup-arrow\" />\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\n\ninterface Props {\n  className?: string;\n  children?: React.ReactNode;\n  isOpen: boolean;\n  offset?: { vertical: number; horizontal: number };\n  popup: JSX.Element;\n  position: 'bottomleft' | 'bottomright';\n  togglePopup: (show: boolean) => void;\n}\n\ninterface State {\n  position: { top: number; left?: number; right?: number };\n}\n\nexport default class BubblePopupHelper extends React.PureComponent<Props, State> {\n  container?: HTMLElement | null;\n  popupContainer?: HTMLElement | null;\n  state: State = {\n    position: { top: 0, right: 0 }\n  };\n\n  componentDidMount() {\n    this.setState({ position: this.getPosition(this.props) });\n  }\n\n  componentWillReceiveProps(nextProps: Props) {\n    if (!this.props.isOpen && nextProps.isOpen) {\n      window.addEventListener('keydown', this.handleKey, false);\n      window.addEventListener('click', this.handleOutsideClick, false);\n    } else if (this.props.isOpen && !nextProps.isOpen) {\n      window.removeEventListener('keydown', this.handleKey);\n      window.removeEventListener('click', this.handleOutsideClick);\n    }\n  }\n\n  handleKey = (event: KeyboardEvent) => {\n    // Escape key\n    if (event.keyCode === 27) {\n      this.props.togglePopup(false);\n    }\n  };\n\n  handleOutsideClick = (event: MouseEvent) => {\n    if (!this.popupContainer || !this.popupContainer.contains(event.target as Node)) {\n      this.props.togglePopup(false);\n    }\n  };\n\n  handleClick(event: React.SyntheticEvent<HTMLElement>) {\n    event.stopPropagation();\n  }\n\n  getPosition(props: Props) {\n    if (this.container) {\n      const containerPos = this.container.getBoundingClientRect();\n      const { position } = props;\n      const offset = props.offset || { vertical: 0, horizontal: 0 };\n      if (position === 'bottomleft') {\n        return { top: containerPos.height + offset.vertical, left: offset.horizontal };\n      } else {\n        // if (position === 'bottomright')\n        return { top: containerPos.height + offset.vertical, right: offset.horizontal };\n      }\n    } else {\n      return { top: 0, right: 0 };\n    }\n  }\n\n  render() {\n    return (\n      <div\n        className={classNames(this.props.className, 'bubble-popup-helper')}\n        onClick={this.handleClick}\n        ref={container => (this.container = container)}\n        role=\"tooltip\"\n        tabIndex={0}>\n        {this.props.children}\n        {this.props.isOpen && (\n          <div ref={popupContainer => (this.popupContainer = popupContainer)}>\n            {React.cloneElement(this.props.popup, {\n              popupPosition: this.state.position\n            })}\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n"],"sourceRoot":""}
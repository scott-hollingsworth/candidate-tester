(window.webpackJsonp=window.webpackJsonp||[]).push([[257],{1027:function(t,e,n){"use strict";var o=n(0),a=n(10),r=n(7),c=n(247);function i(t){var e=t.link,n=void 0===e||e,a=t.organization;return t.shouldBeDisplayed&&a?o.createElement("span",null,n?o.createElement(c.a,{className:t.linkClassName,organization:a},a.name):a.name,o.createElement("span",{className:"slash-separator"})):null}e.a=Object(a.connect)(function(t,e){return{organization:Object(r.getOrganizationByKey)(t,e.organizationKey),shouldBeDisplayed:Object(r.areThereCustomOrganizations)(t)}})(i)},1162:function(t,e,n){"use strict";n.r(e);var o,a=n(0),r=n.n(a),c=n(22),i=n.n(c),l=n(10),s=n(46),p=n(1),u=(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.isEnabled=function(t,e){return!!this.props.notifications.find(function(n){return n.type===t&&n.channel===e})},e.prototype.handleCheck=function(t,e,n){n?this.props.onAdd({type:t,channel:e}):this.props.onRemove({type:t,channel:e})},e.prototype.getDispatcherLabel=function(t){var e=["notification.dispatcher",t],n=e.concat(["project"]);return this.props.project&&p.i.apply(void 0,n)?p.l.apply(void 0,n):p.l.apply(void 0,e)},e.prototype.render=function(){var t=this,e=this.props,n=e.channels,o=e.checkboxId,a=e.types;return r.a.createElement("tbody",null,a.map(function(e){return r.a.createElement("tr",{key:e},r.a.createElement("td",null,t.getDispatcherLabel(e)),n.map(function(n){return r.a.createElement("td",{key:n,className:"text-center"},r.a.createElement(s.a,{checked:t.isEnabled(e,n),id:o(e,n),onCheck:function(o){return t.handleCheck(e,n,o)}}))}))}))},e}(r.a.PureComponent),h=n(3);var m=n(43),d=n(87),y=function(t){return function(e){return(n=t.channel,o=t.type,a=t.project,r={channel:n,type:o},a&&Object.assign(r,{project:a}),Object(h.post)("/api/notifications/add",r)).then(function(){return e(Object(d.a)(t))},Object(m.g)(e));var n,o,a,r}},j=function(t){return function(e){return(n=t.channel,o=t.type,a=t.project,r={channel:n,type:o},a&&Object.assign(r,{project:a}),Object(h.post)("/api/notifications/remove",r)).then(function(){return e(Object(d.j)(t))},Object(m.g)(e));var n,o,a,r}},b=n(7);function O(t){return r.a.createElement("section",{className:"boxed-group"},r.a.createElement("h2",null,Object(p.l)("my_profile.overall_notifications.title")),r.a.createElement("div",{className:"boxed-group-inner"},r.a.createElement("table",{className:"form"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null),t.channels.map(function(t){return r.a.createElement("th",{key:t,className:"text-center"},r.a.createElement("h4",null,Object(p.l)("notification.channel",t)))}))),r.a.createElement(f,{notifications:t.notifications,channels:t.channels,types:t.types,checkboxId:function(t,e){return"global-notification-"+t+"-"+e},onAdd:t.addNotification,onRemove:t.removeNotification}))))}var v={addNotification:y,removeNotification:j},g=Object(l.connect)(function(t){return{notifications:Object(b.getGlobalNotifications)(t),channels:Object(b.getNotificationChannels)(t),types:Object(b.getNotificationGlobalTypes)(t)}},v)(O),E=n(4),_=n(2),N=n(1027),k=n(38),P=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.handleAddNotification=function(t){var e=t.channel,n=t.type;this.props.addNotification({channel:e,type:n,project:this.props.project.key,projectName:this.props.project.name,organization:this.props.project.organization})},e.prototype.handleRemoveNotification=function(t){var e=t.channel,n=t.type;this.props.removeNotification({channel:e,type:n,project:this.props.project.key})},e.prototype.render=function(){var t=this,e=this.props,n=e.project,o=e.channels;return r.a.createElement("table",{key:n.key,className:"form big-spacer-bottom"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,r.a.createElement("span",{className:"text-normal"},r.a.createElement(N.a,{organizationKey:n.organization})),r.a.createElement("h4",{className:"display-inline-block"},r.a.createElement(_.Link,{to:Object(k.r)(n.key)},n.name))),o.map(function(t){return r.a.createElement("th",{key:t,className:"text-center"},r.a.createElement("h4",null,Object(p.l)("notification.channel",t)))}))),r.a.createElement(f,{notifications:this.props.notifications,channels:this.props.channels,types:this.props.types,checkboxId:function(t,e){return"project-notification-"+n.key+"-"+t+"-"+e},onAdd:function(e){return t.handleAddNotification(e)},onRemove:function(e){return t.handleRemoveNotification(e)},project:!0}))},e}(r.a.PureComponent),w={addNotification:y,removeNotification:j},x=Object(l.connect)(function(t,e){return{notifications:Object(b.getProjectNotifications)(t,e.project.key),channels:Object(b.getNotificationChannels)(t),types:Object(b.getNotificationPerProjectTypes)(t)}},w)(z),C=n(51),A=n(33),R=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={addedProjects:[]},e.loadOptions=function(t,e){t.length<2?e(null,{options:[]}):Object(A.s)(t).then(function(t){var e=t.results.find(function(t){return"TRK"===t.q});return e?e.items:[]}).then(function(t){return t.map(function(t){return{value:t.key,label:t.name,organization:t.organization}})}).then(function(t){e(null,{options:t})})},e.handleAddProject=function(t){var n={key:t.value,name:t.label,organization:t.organization};e.setState({addedProjects:e.state.addedProjects.concat([n])})},e.renderOption=function(t){return r.a.createElement("span",null,r.a.createElement(N.a,{organizationKey:t.organization,link:!1}),r.a.createElement("strong",null,t.label))},e}return R(e,t),e.prototype.componentWillReceiveProps=function(t){var e=Object(E.differenceBy)(this.state.addedProjects,t.projects,function(t){return t.key});e.length!==this.state.addedProjects&&this.setState({addedProjects:e})},e.prototype.render=function(){var t=this.props.projects.concat(this.state.addedProjects);return r.a.createElement("section",{className:"boxed-group"},r.a.createElement("h2",null,Object(p.l)("my_profile.per_project_notifications.title")),r.a.createElement("div",{className:"boxed-group-inner"},0===t.length&&r.a.createElement("div",{className:"note"},Object(p.l)("my_account.no_project_notifications")),t.map(function(t){return r.a.createElement(x,{key:t.key,project:t})}),r.a.createElement("div",{className:"spacer-top panel bg-muted"},r.a.createElement("span",{className:"text-middle spacer-right"},Object(p.l)("my_account.set_notifications_for"),":"),r.a.createElement(C.a,{autoload:!1,cache:!1,name:"new_project",style:{width:"300px"},loadOptions:this.loadOptions,minimumInput:2,optionRenderer:this.renderOption,onChange:this.handleAddProject,placeholder:Object(p.l)("my_account.search_project")}))))},e}(r.a.PureComponent),D=Object(l.connect)(function(t){return{projects:Object(b.getProjectsWithNotifications)(t)}})(T);n.d(e,"UnconnectedNotifications",function(){return J});var K=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),B=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return K(e,t),e.prototype.componentDidMount=function(){this.props.fetchNotifications()},e.prototype.render=function(){return r.a.createElement("div",{className:"account-body account-container"},r.a.createElement(i.a,{title:Object(p.l)("my_account.notifications")}),r.a.createElement("p",{className:"alert alert-info"},Object(p.l)("notification.dispatcher.information")),r.a.createElement(g,null),r.a.createElement(D,null))},e}(r.a.PureComponent),I={fetchNotifications:function(){return function(t){return Object(h.getJSON)("/api/notifications/list").then(function(e){var n=e.notifications.filter(function(t){return t.organization}).map(function(t){return t.organization});t(Object(m.f)(n)).then(function(){t(Object(d.i)(e.notifications,e.channels,e.globalTypes,e.perProjectTypes))})},Object(m.g)(t))}}},J=(e.default=Object(l.connect)(null,I)(B),B)}}]);
//# sourceMappingURL=257.a879aec5.chunk.js.map